(this["webpackJsonptext2command-react"]=this["webpackJsonptext2command-react"]||[]).push([[0],{225:function(e){e.exports=JSON.parse('{"a":"1.3.1"}')},356:function(e,t,a){e.exports=a(415)},361:function(e,t,a){},404:function(e){e.exports=JSON.parse('{"Are you sure?":"Are you sure?","Cancel":"Cancel","Cannot check license: %s":"Cannot check license: %s","Check license online":"Check license online","Close":"Close","Error":"Error","Invalid license":"Invalid license","License":"License","Load configuration from file":"Load configuration from file","Ok":"Ok","Options":"Options","Place your ioBroker OPC-UA license here":"Place your ioBroker OPC-UA license here","Save":"Save","Save and close":"Speichern und schlie\xdfen","Save configuration to file":"Konfiguration in Datei speichern","Success":"Success","Wrong license name %s":"Wrong license name %s","license_hint":"Ask us for the license:","license_not_ok":"License is not OK","license_ok":"License is OK","not connected":"not connected","timeout":"Timeout","Wrong license UUID %s, expected %s":"Wrong license UUID %s, expected %s","Create new rule":"Create new rule","Name":"name","Edit rule":"Edit rule","New rule":"New rule","Rule":"Rule","Select rule":"Select rule","Keywords":"Keywords","Argument":"Argument","Break":"Break","Confirmation text":"Confirmation text","Name already exist":"Name already exist","Test phrase":"Test phrase","Interrupt processing":"Interrupt processing","Save and go":"Save and go","Dont save and go":"Dont save and go","Please confirm or cancel changes before leaving":"Please confirm or cancel changes before leaving","You have changed rule":"You have changed rule","Settings":"Settings","Timeout for processor":"Timeout for processor","Processor\'s id":"Processor\'s id","Language":"Language","System":"System","Are you sure":"Are you sure","You want to delete":"You want to delete","Create rule":"Create rule"}')},405:function(e){e.exports=JSON.parse('{"Are you sure?":"Bist du sicher?","Cancel":"Abbrechen","Cannot check license: %s":"Lizenz kann nicht \xfcberpr\xfcft werden: %s","Check license online":"Lizenz online pr\xfcfen","Close":"Schlie\xdfen","Error":"Fehler","Invalid license":"Ung\xfcltige Lizenz","License":"Lizenz","Load configuration from file":"Konfiguration aus Datei laden","Ok":"Ok","Options":"Optionen","Place your ioBroker Consumption license here":"Platzieren Sie hier Ihre ioBroker Consumption-Lizenz","Save":"Speichern","Save and close":"Speichern und schlie\xdfen","Save configuration to file":"Konfiguration in Datei speichern","Success":"Erfolgreich","Wrong license name %s":"Falscher Lizenzname %s","license_hint":"Fragen Sie uns nach der Lizenz:","license_not_ok":"Lizenz ist nicht OK","license_ok":"Lizenz ist OK","not connected":"nicht verbunden","timeout":"Timeout","Wrong license UUID %s, expected %s":"Falsche Lizenz-UUID %s, erwartete %s"}')},406:function(e){e.exports=JSON.parse('{"Are you sure?":"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?","Cancel":"\u041e\u0442\u043c\u0435\u043d\u0430","Cannot check license: %s":"\u041d\u0435 \u043c\u043e\u0433\u0443 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044e: %s","Check license online":"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044e \u043e\u043d\u043b\u0430\u0439\u043d","Close":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","Error":"\u041e\u0448\u0438\u0431\u043a\u0430","Invalid license":"\u041d\u0435\u0432\u0435\u0440\u043d\u0430\u044f \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044f","License":"\u041b\u0438\u0446\u0435\u043d\u0437\u0438\u044f","Load configuration from file":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0438\u0437 \u0444\u0430\u0439\u043b\u0430","Ok":"Ok","Options":"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b","Place your ioBroker Consumption license here":"\u0420\u0430\u0437\u043c\u0435\u0441\u0442\u0438\u0442\u0435 \u0432\u0430\u0448\u0443 \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044e ioBroker Consumption \u0437\u0434\u0435\u0441\u044c","Save":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c","Save and close":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044c","Save configuration to file":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0432 \u0444\u0430\u0439\u043b","Success":"\u0423\u0441\u043f\u0435\u0448\u043d\u043e","Wrong license name %s":"\u041d\u0435\u0432\u0435\u0440\u043d\u043e\u0435 \u0438\u043c\u044f \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u0438 %s","license_hint":"\u0417\u0434\u0435\u0441\u044c \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044e:","license_not_ok":"\u041b\u0438\u0446\u0435\u043d\u0437\u0438\u044f \u043d\u0435 \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435","license_ok":"\u041b\u0438\u0446\u0435\u043d\u0437\u0438\u044f \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435","not connected":"\u041d\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d","timeout":"\u0422\u0430\u0439\u043c-\u0430\u0443\u0442","Wrong license UUID %s, expected %s":"\u041d\u0435\u0432\u0435\u0440\u043d\u0430\u044f \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u044f UUID %s, \u043e\u0436\u0438\u0434\u0430\u0435\u0442\u0441\u044f %s","Create new rule":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Name":"\u0418\u043c\u044f","Edit rule":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u043e","New rule":"\u041d\u043e\u0432\u043e\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Rule":"\u041f\u0440\u0430\u0432\u0438\u043b\u043e","Select rule":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Keywords":"\u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0441\u043b\u043e\u0432\u0430","Argument":"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440","Break":"\u041f\u0440\u0435\u0440\u0432\u0430\u0442\u044c","Confirmation text":"\u0422\u0435\u043a\u0441\u0442 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f","Name already exist":"\u0414\u0430\u043d\u043d\u043e\u0435 \u0438\u043c\u044f \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442","Test phrase":"\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0444\u0440\u0430\u0437\u0430","Interrupt processing":"\u041f\u0440\u0435\u0440\u0432\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443","Save and go":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u043f\u0435\u0440\u0435\u0439\u0442\u0438","Don\'t save and go":"\u041d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u0438 \u043f\u0435\u0440\u0435\u0439\u0442\u0438","Please confirm or cancel changes before leaving":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0438\u043b\u0438 \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u0434 \u0442\u0435\u043c \u043a\u0430\u043a \u0443\u0439\u0442\u0438","You have changed rule":"\u0412\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Settings":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438","Timeout for processor":"\u0422\u0430\u0439\u043c\u0430\u0443\u0442 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430","Processor\'s id":"ID \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430","Answer in id":"\u041e\u0442\u0432\u0435\u0442 \u0432 ID","Language":"\u042f\u0437\u044b\u043a","System":"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0439","Are you sure":"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b","You want to delete":"\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c","Create rule":"C\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e"}')},407:function(e){e.exports=JSON.parse("{}")},408:function(e){e.exports=JSON.parse("{}")},409:function(e){e.exports=JSON.parse("{}")},410:function(e){e.exports=JSON.parse("{}")},411:function(e){e.exports=JSON.parse("{}")},412:function(e){e.exports=JSON.parse("{}")},413:function(e){e.exports=JSON.parse("{}")},415:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(18),l=a.n(r),s=(a(449),a(448),a(443));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(361);var o=a(56),c=a(57),u=a(62),d=a(61),m=a(5),p=a(214),h=a.n(p),g=a(16),f=a.n(g),v=a(324),b=a.n(v),S=a(142),O=a(24),R=a.n(O),C=a(44),k=a(9),w=a(53),y=a(182),j=a(186),x=a(325),E=a.n(x),D=a(450),I=a(3),L=a(155),N=(a(370),a(333)),U=a.n(N),T=a(334),A=a.n(T),B=a(335),z=a.n(B),W=a(215),M=a(338),_=a.n(M),F=a(336),P=a.n(F),H=a(337),J=a.n(H),K=a(174),Y=a.n(K),q=a(295),G=a(299),X=a(339),$=a.n(X),Q=a(217),V=a(446),Z=a(222),ee=a(305),te=a(294),ae=a(298),ne=a(114),ie=a(296),re=a(210),le=a(293),se=a(447),oe=a(343),ce=a(292),ue=a(216),de=a(311),me=a(309),pe=a(331),he=a.n(pe),ge=a(330),fe=a.n(ge),ve=a(329),be=a.n(ve),Se=a(179),Oe=i.a.forwardRef((function(e,t){var a,r=e.name,l=e.handleEdit,s=e.rule,o=e.isDragging,c=e.connectDragSource,u=e.connectDropTarget,d=e.id,m=e.selectRule,p=e.selectedRule,h=e._break,g=e.matchingRules,f=e.unsavedRules,v=e.index,b=e.theme,S=e.removeMatched,O=e.words,R=Object(ce.a)({listItem:{cursor:"pointer",transition:"background-color 0.3s linear",position:"relative"},listItemText:{"& span":{color:b.palette.text.primary},"& p":{color:b.palette.text.secondary,textOverflow:"ellipsis",overflow:"hidden"}},dot:{position:"absolute",backgroundColor:"red",top:5,right:15,width:10,height:10,borderRadius:"50%"},maximize:{color:null===(a=b.palette.error)||void 0===a?void 0:a.dark,marginBottom:-b.spacing(2)}})(),C=Object(n.useRef)(null);c(C),u(C);var k=o?0:1;Object(n.useImperativeHandle)(t,(function(){return{getNode:function(){return C.current}}}));var w=Object(n.useCallback)((function(){return m(d)}),[d,m]),j=Object(n.useCallback)((function(){return l(d)}),[d,l]),x=[{icon:h?i.a.createElement(be.a,{className:R.maximize}):i.a.createElement(fe.a,{color:"primary"})},{icon:i.a.createElement(he.a,null),handleClick:j}],E=Object(n.useState)(""),D=Object(y.a)(E,2),I=D[0],L=D[1];Object(n.useEffect)((function(){if(g.length){var e=g.find((function(e){return e.indexOf===v}));e&&(setTimeout((function(){var e;return L(null===b||void 0===b||null===(e=b.palette)||void 0===e?void 0:e.secondary.dark)}),e.timer),setTimeout((function(){var e,t;L(p.id===d?null===b||void 0===b||null===(e=b.palette)||void 0===e||null===(t=e.background)||void 0===t?void 0:t.default:""),h&&S()}),500*(e.index+1)))}}),[g]);var N=s!==r?s:"";return N+="".concat(N?" ":"","[").concat(O,"]"),i.a.createElement("div",{ref:C,style:{opacity:k,backgroundColor:I}},i.a.createElement(ue.a,{onClick:w,selected:(null===p||void 0===p?void 0:p.id)===d,className:R.listItem},i.a.createElement(de.a,{primary:r,secondary:N,className:R.listItemText}),i.a.createElement(me.a,null,n.Children.toArray(x.map((function(e,t){var a=e.icon,n=e.handleClick;return i.a.createElement(W.a,{disabled:!t,onClick:n},a)})))),f[d]&&i.a.createElement(re.a,{className:R.dot})))})),Re="rule",Ce=Object(Se.DropTarget)(Re,{hover(e,t,a){if(!a)return null;var n=a.getNode();if(!n)return null;var i=t.getItem().index,r=e.index;if(i!==r){var l=n.getBoundingClientRect(),s=(l.bottom-l.top)/2,o=t.getClientOffset().y-l.top;i<r&&o<s||i>r&&o>s||(e.moveRule(i,r),t.getItem().index=r)}}},(function(e){return{connectDropTarget:e.dropTarget()}}))(Object(Se.DragSource)(Re,{beginDrag:function(e){return{id:e.id,index:e.index}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))(Oe)),ke=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var r=arguments.length,l=new Array(r),s=0;s<r;s++)l[s]=arguments[s];return(e=t.call.apply(t,[this].concat(l))).state={textCommand:"",matchingRules:[],isSettingsDialogOpen:!1,isConfirmRemoveDialogOpen:!1,isSearchActive:!1,filteredRules:[],localeSettings:{language:"",processorId:"",processorTimeout:1e3,sayitInstance:""}},e.handleTextCommand=function(t){e.setState({textCommand:t.target.value})},e.handleSubmit=function(t,a){if("Enter"===t.key||a){var n=e.findMatchingRules();e.setState({matchingRules:n.map((function(e,t){return{indexOf:e,timer:500*t,index:t}})),textCommand:""})}},e.removeMatched=function(){e.setState({matchingRules:[]})},e.handleOpenSettingsModal=function(){e.setState({isSettingsDialogOpen:!0})},e.handleDialogSelectIdSubmit=function(t,a){e.setState({localeSettings:Object(k.a)(Object(k.a)({},e.state.localeSettings),{},{[a]:t})})},e.handleDelete=function(){e.props.removeRule(e.props.selectedRule.id),e.handleCloseConfirmRemoveDialog()},e.handleCloseConfirmRemoveDialog=function(){e.setState({isConfirmRemoveDialogOpen:!1})},e.handleSearch=function(t){var a=e.props.rules.filter((function(e){return e.name.toLowerCase().includes(t.target.value.toLowerCase())}));e.setState({filteredRules:a||[]})},e.toggleSearch=function(){e.setState({isSearchActive:!e.state.isSearchActive})},e.createSettingsModal=function(){var t=f.a.t,a=[t("System"),"en","de","ru"],r=e.props.classes,l=function(){e.setState({isSettingsDialogOpen:!1})},s=function(t,a){e.setState({localeSettings:Object(k.a)(Object(k.a)({},e.state.localeSettings),{},{[a]:t.target.value})})},o=function(t){var a=t.value,n=t.handler,r=t.type,l=t.selectedSettingsName;return n||(n=function(){}),i.a.createElement(V.a,{variant:"outlined",className:e.props.classes.textInput,onClick:function(){"id"===r&&e.setState({showDialogSelectId:!0,selectedSettingsName:l})},value:a,onChange:n,size:"small"})},c=[{item:i.a.createElement(Z.a,{onChange:function(e){return s(e,"language")},value:e.state.localeSettings.language,className:r.select,variant:"outlined",autoWidth:!0},n.Children.toArray(a.map((function(e){return i.a.createElement(ee.a,{value:e},e)})))),title:t("Language"),id:1},{item:o({value:e.state.localeSettings.sayitInstance,type:"id",selectedSettingsName:"sayitInstance"}),title:t("Answer in id"),id:2},{item:o({value:e.state.localeSettings.processorId,type:"id",selectedSettingsName:"processorId"}),title:t("Processor's id"),id:3},{item:o({value:e.state.localeSettings.processorTimeout,type:"text",handler:function(e){return s(e,"processorTimeout")}}),title:t("Timeout for processor")+"(ms)",id:4}];return i.a.createElement(te.a,{open:e.state.isSettingsDialogOpen,onClose:l,fullWidth:!0},i.a.createElement(ae.a,null,i.a.createElement(ne.a,{variant:"h4",component:"span",align:"center"},t("Settings"))),i.a.createElement(ie.a,null,c.map((function(e){var t=e.item,a=e.title,n=e.id;return i.a.createElement(re.a,{display:"flex",justifyContent:"space-between",mb:"10px",key:n,className:r.settingsContent},i.a.createElement(ne.a,{variant:"h5",component:"h5",align:"left",className:r.settingsTitle},a),t)})),i.a.createElement(q.a,null,i.a.createElement(le.a,{onClick:function(){e.props.saveSettings(e.state.localeSettings,l)}},"Ok"),i.a.createElement(le.a,{onClick:l},f.a.t("Cancel")))))},e.mainIcons=[{icon:i.a.createElement(U.a,null),handler:function(){return e.props.handleOpen()}},{icon:i.a.createElement(A.a,null),handler:function(){return e.handleOpenSettingsModal()}},{icon:i.a.createElement(z.a,null),handler:function(){return console.log("refresh")}}],e.createIcons=function(e){return e.map((function(e,t){var a=e.icon,n=e.handler;return i.a.createElement(W.a,{onClick:n,key:t},a)}))},e}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e,t){this.props.settings!==e.settings&&this.props.settings&&this.setState({localeSettings:Object(k.a)(Object(k.a)({},this.props.settings),{},{language:this.props.settings.language||f.a.t("System")})})}},{key:"findMatchingRules",value:function(){var e=this.state.textCommand;return e?window.findMatched(e,JSON.parse(JSON.stringify(this.props.rules))):[]}},{key:"renderSelectIdDialog",value:function(){var e=this;return this.state.showDialogSelectId?i.a.createElement(Y.a,{socket:this.props.socket,title:"Select ID",onClose:function(){return e.setState({showDialogSelectId:!1})},onOk:function(t){return e.handleDialogSelectIdSubmit(t,e.state.selectedSettingsName)}}):null}},{key:"renderConfirmDialog",value:function(){return this.state.isConfirmRemoveDialogOpen?i.a.createElement(te.a,{open:this.state.isConfirmRemoveDialogOpen,onClose:this.handleCloseConfirmRemoveDialog,fullWidth:!0},i.a.createElement(ae.a,null,f.a.t("Are you sure?")),i.a.createElement(ie.a,null,i.a.createElement(ne.a,{variant:"h5",component:"h5"},f.a.t("You want to delete")+": ",i.a.createElement("strong",null,this.props.selectedRule.name)),i.a.createElement(q.a,null,i.a.createElement(le.a,{onClick:this.handleDelete},f.a.t("Ok")),i.a.createElement(le.a,{onClick:this.handleCloseConfirmRemoveDialog,color:"primary"},f.a.t("Cancel"))))):null}},{key:"render",value:function(){var e=this,t=this.props,a=t.selectedRule,n=t.moveRule,r=t.handleEdit,l=t.rules,s=t.selectRule,o=t.classes,c=this.state,u=c.filteredRules,d=c.isSearchActive,m=this.createSettingsModal(),p=[{icon:!d&&i.a.createElement(P.a,null),handler:function(){return e.setState({isConfirmRemoveDialogOpen:!0})}},{icon:d?i.a.createElement(J.a,null):i.a.createElement(_.a,null),handler:function(){return e.toggleSearch()}}],h=u.length?u:l;return i.a.createElement(re.a,{className:o.main},i.a.createElement(G.a,{position:"static",classes:{root:o.toolbar}},d?i.a.createElement(V.a,{className:o.search,onChange:this.handleSearch}):i.a.createElement("div",null,this.createIcons(this.mainIcons)),i.a.createElement("div",null,this.createIcons(p))),i.a.createElement(se.a,{backend:oe.a},i.a.createElement(Q.a,{className:o.list},h.map((function(t,l){return i.a.createElement(Ce,Object.assign({theme:e.props.theme,handleEdit:r},t,{index:l,moveRule:n,key:t.id,selectRule:s,selectedRule:a,matchingRules:e.state.matchingRules,unsavedRules:e.props.unsavedRules,removeMatched:e.removeMatched}))})))),i.a.createElement(G.a,{className:o.test,variant:"dense"},i.a.createElement(V.a,{onChange:this.handleTextCommand,label:f.a.t("Test phrase"),variant:"outlined",size:"small",color:"primary",className:Object(I.a)("outlined-basic",o.root),onKeyDown:this.handleSubmit,value:this.state.textCommand}),i.a.createElement(W.a,{variant:"outlined",onClick:function(t){return e.handleSubmit(t,!0)}},i.a.createElement($.a,{className:o.play}))),m,this.renderConfirmDialog(),this.renderSelectIdDialog())}}]),a}(n.Component),we=Object(m.a)((function(e){return{test:{},main:{minWidth:330,overflow:"hidden",height:"100%"},toolbar:{background:e.palette.secondary.main},list:{height:"calc(100% - 64px - 64px)",overflowX:"hidden",overflowY:"auto"},root:{width:"92%","& .outlined-basic":{padding:"12px 10px",border:"2px solid ".concat(e.palette.grey[700])}},header:{minHeight:44,height:"auto",padding:e.spacing(1.3),border:"1px solid ".concat(e.palette.divider)},textInput:{width:"60%",[e.breakpoints.down("sm")]:{width:"100%"}},select:{width:"60%","& .MuiOutlinedInput-input-68":{padding:10.5},[e.breakpoints.down("sm")]:{width:"100%"}},settingsTitle:{fontSize:"20px",maxWidth:145,[e.breakpoints.down("sm")]:{marginBottom:e.spacing(1)}},settingsContent:{[e.breakpoints.down("sm")]:{flexDirection:"column",display:"flex"}},search:{flexBasis:"80%",[e.breakpoints.down("sm")]:{flexBasis:"70%"}}}}))(ke),ye=a(83),je=a(445),xe=a(218),Ee=a(227),De=a(341),Ie=a.n(De),Le=a(340),Ne=a.n(Le),Ue=a(111),Te=a.n(Ue),Ae=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).defaultState={words:f.a.t("Create Rule"),name:f.a.t("Create Rule"),_break:!1,editable:!1,args:[{default:f.a.t("Argument")+" 1"},{default:f.a.t("Argument")+" 2"}],ack:{name:"",default:"".concat(f.a.t("Confirmation text"))},id:0},e.state={localRule:e.defaultState,showDialog:!1},e.createConfirmModalActions=function(){var t=f.a.t,a=e.props,n=a.updateConfig,r=a.classes,l=a.selectRule,s=a.pendingSelectedRuleId,o=a.clearStateOnConfirmModalUnmount,c=a.revertChangesFromConfig,u=e.state.localRule,d=function(){var t=Object(C.a)(R.a.mark((function t(){return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o();case 2:e.closeConfirmDialog();case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=function(){var t=Object(C.a)(R.a.mark((function t(){return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c(u);case 2:return t.next=4,l(s);case 4:return t.next=6,o(u.id);case 6:e.closeConfirmDialog();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=function(){var t=Object(C.a)(R.a.mark((function t(){return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(u);case 2:return t.next=4,l(s);case 4:return t.next=6,o();case 6:e.closeConfirmDialog();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return i.a.createElement(xe.a,{className:r.submitForm},i.a.createElement(le.a,{variant:"contained",onClick:p,color:"primary",className:r.saveAndGoBtn},t("Save and go")),i.a.createElement(le.a,{onClick:m,variant:"contained",color:"secondary"},t("Don't save and go")),i.a.createElement(le.a,{variant:"contained",className:r.btnDanger,onClick:d},t("Cancel")))},e.createSaveSettingsForm=function(){var t=f.a.t,a=e.props,n=a.updateConfig,r=a.classes,l=a.revertChangesFromConfig,s=a.selectedRule,o=e.state.localRule,c=function(){var t=Object(C.a)(R.a.mark((function t(){return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(o);case 2:e.setState({isLocalStateWasUpdated:!1});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),u=function(){var t=Object(C.a)(R.a.mark((function t(){return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(o);case 2:return t.next=4,e.setState({localRule:s,isLocalStateWasUpdated:!1});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return e.state.isLocalStateWasUpdated?i.a.createElement(xe.a,{className:r.submitForm},i.a.createElement(le.a,{onClick:c,variant:"contained",color:"primary"},t("Save")),i.a.createElement(le.a,{variant:"contained",className:r.btnDanger,onClick:u},t("Cancel"))):i.a.createElement("div",{className:e.props.classes.emptyButtons})},e.closeConfirmDialog=function(){e.setState({isLocalStateWasUpdated:!1,confirmChanges:!1})},e.createInput=function(t){var a=t.value,n=t.label,r=t.onChange,l=t.type,s=t.onClick,o=t.note,c=t.disabled,u=void 0===c?e.state.localRule===e.defaultState:c,d=t.keywords,m=t.key,p=t.onSwitchChange;if(void 0!==a&&null!==a||n||d){var h=e.props.classes;return"checkbox"!==l?i.a.createElement(V.a,{variant:"outlined",size:"small",disabled:u,value:a,helperText:o||"",onClick:s,onChange:r,key:m,className:Object(I.a)("outlined-basic",h.textField)}):i.a.createElement(xe.a,{classes:{root:h.switchControl}},i.a.createElement(je.a,{key:m,onClick:p,color:"primary",disabled:u,checked:!!a}))}},e.createOptionsData=function(){var t,a,n,i,r,l,s,o,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.state,u=c.localRule,d=u.args,m=u.ack,p=u.editable,h=u._break,g=f.a.t,v=e.createInput,b=e.handlers,S=function(){return void 0!==p&&!1===p};return[{title:g("Keywords"),item:v({value:(null===(t=e.state.localRule)||void 0===t?void 0:t.words)||"",onChange:b.keywordsText,keywords:!0,disabled:S(),key:"keywords"}),id:1},{title:g("Interrupt processing"),item:v({type:"checkbox",value:h,onSwitchChange:b.breakOnSwitch,key:"break"}),id:2},{title:d&&(null===(a=d[0])||void 0===a?void 0:a.name),item:v({value:d&&(null===(n=e.state.localRule.args[0])||void 0===n?void 0:n.default),label:d&&(null===(i=d[0])||void 0===i?void 0:i.name),type:d&&(null===(r=d[0])||void 0===r?void 0:r.type),onClick:e.handleSetDialogClick.bind(Object(ye.a)(e),d&&d[0]),onSwitchChange:b.param1OnSwitch,key:"Param1"}),id:3},{title:d&&(null===(l=d[1])||void 0===l?void 0:l.name),item:v({value:d&&(null===(s=e.state.localRule.args[1])||void 0===s?void 0:s.default),label:d&&(null===(o=d[1])||void 0===o?void 0:o.name),onChange:b.param2Text,key:"Param2"}),id:4},{title:g("Confirmation text"),item:v({value:m&&m.default,label:m&&m.name,note:g("You can use %s, that will be replaced with current value of state. %u will be replaced by unit"),type:m&&m.type,key:"confirmationText",onChange:b.confirmText,onSwitchChange:b.confirmOnSwitch}),id:5}]},e.createInputHandlers=function(){var t=Object(ye.a)(e);return{keywordsText(e){t.setState({localRule:Object(k.a)(Object(k.a)({},t.state.localRule),{},{words:e.target.value}),isLocalStateWasUpdated:!0})},param2Text(e){t.setState({localRule:Object(k.a)(Object(k.a)({},t.state.localRule),{},{args:t.state.localRule.args.map((function(t,a){return a>0?Object(k.a)(Object(k.a)({},t),{},{default:e.target.value}):t}))}),isLocalStateWasUpdated:!0})},confirmText(e){t.setState({localRule:Object(k.a)(Object(k.a)({},t.state.localRule),{},{ack:Object(k.a)(Object(k.a)({},t.state.localRule.ack),{},{default:e.target.value})}),isLocalStateWasUpdated:!0})},param1OnSwitch(){t.setState({localRule:Object(k.a)(Object(k.a)({},t.state.localRule),{},{args:t.state.localRule.args.map((function(e,t){return t?e:Object(k.a)(Object(k.a)({},e),{},{default:!e.default||!e.default})}))}),isLocalStateWasUpdated:!0})},confirmOnSwitch(){t.setState({localRule:Object(k.a)(Object(k.a)({},t.state.localRule),{},{ack:Object(k.a)(Object(k.a)({},t.state.localRule.ack),{},{default:!t.state.localRule.ack.default})}),isLocalStateWasUpdated:!0})},breakOnSwitch:()=>Object(C.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setState({localRule:Object(k.a)(Object(k.a)({},t.state.localRule),{},{_break:!t.state.localRule._break}),isLocalStateWasUpdated:!0});case 2:case"end":return e.stop()}}),e)})))()}},e.handlers=e.createInputHandlers(),e.handleSetDialogClick=function(t){"id"===t.type&&e.setState({showDialog:!0})},e.handleDialogSelectIdSubmit=function(t){e.setState({localRule:Object(k.a)(Object(k.a)({},e.state.localRule),{},{args:e.state.localRule.args.map((function(e,a){return a?e:Object(k.a)(Object(k.a)({},e),{},{default:t})}))}),isLocalStateWasUpdated:!0})},e}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e,t){var a,n,i,r;if((null===(a=e.selectedRule)||void 0===a?void 0:a.name)!==(null===(n=this.props.selectedRule)||void 0===n?void 0:n.name)||(null===(i=t.localRule)||void 0===i?void 0:i.name)!==(null===(r=this.state.localRule)||void 0===r?void 0:r.name))this.props.selectedRule.name?this.setState({localRule:Object(k.a)({},this.props.selectedRule)}):this.setState({localRule:this.defaultState});else if(this.state.isLocalStateWasUpdated){var l=this.props.unsavedRules[this.state.localRule.id];Te()(this.props.selectedRule,this.state.localRule)&&!(null===l||void 0===l?void 0:l.wasChangedGlobally)?(this.setState({isLocalStateWasUpdated:!1}),(null===l||void 0===l?void 0:l.wasChangedGlobally)||this.props.removeUnsavedRule(this.state.localRule.id)):l||this.props.pendingSelectedRuleId||this.props.setUnsavedRule(this.state.localRule.id)}else!this.state.isLocalStateWasUpdated&&this.props.unsavedRules[this.state.localRule.id]&&this.setState({isLocalStateWasUpdated:!0});if(this.props.pendingSelectedRuleId&&this.state.isLocalStateWasUpdated){if(this.props.pendingSelectedRuleId===this.state.localRule.id)return;this.setState({confirmChanges:!0})}this.props.lang!==e.lang&&this.forceUpdate()}},{key:"componentDidMount",value:function(){this.state.localRule===this.defaultState&&this.props.selectedRule&&this.setState({localRule:this.props.selectedRule})}},{key:"renderConfirmDialog",value:function(){return this.state.confirmChanges?i.a.createElement(te.a,{fullWidth:!0,open:this.state.confirmChanges,maxWidth:"md"},i.a.createElement(ae.a,null,f.a.t("Please confirm or cancel changes before leaving")),i.a.createElement(ie.a,null,i.a.createElement(ne.a,null,f.a.t("You have changed rule")+": "," ",i.a.createElement("strong",null,this.state.localRule.name)),i.a.createElement(q.a,null,this.createConfirmModalActions()))):null}},{key:"renderSelectIdDialog",value:function(){var e=this;return this.state.showDialog?i.a.createElement(Y.a,{socket:this.props.socket,title:"Select ID",onClose:function(t){console.log(t),e.setState({showDialog:!1})},onOk:this.handleDialogSelectIdSubmit}):null}},{key:"render",value:function(){var e=this.state,t=e.localRule.name,a=e.isLocalStateWasUpdated,n=this.props,r=n.classes,l=n.isLeftBarHidden,s=n.toggleLeftBar;return i.a.createElement(re.a,{mt:"30px",className:r.box},i.a.createElement(Ee.a,{className:r.container,mx:"auto"},i.a.createElement(ne.a,{variant:"h4",align:"center",className:a?"":r.mainTitle},t),this.createSaveSettingsForm(),this.createOptionsData().map((function(e){var t=e.title,a=e.item,n=e.id;return a?i.a.createElement(re.a,{display:"flex",justifyContent:"space-between",mb:"10px",key:n,className:r.row},i.a.createElement(ne.a,{variant:"h6",component:"h6",align:"left",className:r.title},t?t+":":""),a):null}))),i.a.createElement(re.a,{className:r.toggleIcon,onClick:s},l?i.a.createElement(Ne.a,null):i.a.createElement(Ie.a,null)),this.renderSelectIdDialog(),this.renderConfirmDialog())}}]),a}(n.PureComponent),Be=Object(m.a)((function(e){return{box:{display:"inline-flex",justifyContent:"space-around",padding:e.spacing(2),width:"calc(100% - "+e.spacing(4)+"px)",position:"relative","& .outlined-basic":{padding:"12px 10px"}},container:{width:"70%",padding:e.spacing(2),[e.breakpoints.down("md")]:{width:"90%"},[e.breakpoints.down("lg")]:{width:"80%"}},textField:{flexBasis:"60%",[e.breakpoints.down("sm")]:{width:"100%",marginTop:e.spacing(1)}},submitForm:{flexDirection:"row",margin:"10px auto 20px",display:"flex",justifyContent:"center",width:"100%",[e.breakpoints.down("xs")]:{flexDirection:"column"}},mainTitle:{marginBottom:"30px"},title:{marginTop:16,[e.breakpoints.down("md")]:{maxWidth:200},[e.breakpoints.down("sm")]:{width:"100%"}},row:{[e.breakpoints.down("md")]:{alignItems:"center"},[e.breakpoints.down("sm")]:{flexDirection:"column",alignItems:"flex-start",textAlign:"center"}},btnDanger:{marginLeft:20,[e.breakpoints.down("xs")]:{marginLeft:0,marginTop:e.spacing(.5)}},saveAndGoBtn:{marginRight:20,[e.breakpoints.down("xs")]:{marginRight:0,marginBottom:e.spacing(.5)}},toggleIcon:{position:"absolute",top:-15,left:0,backgroundColor:e.palette.primary.main,width:20,height:25,cursor:"pointer",padding:e.spacing(1),borderRadius:"0 5px 5px 0"},switchControl:{paddingTop:e.spacing(1),flexBasis:"60%"},emptyButtons:{height:36}}}))(Ae),ze=a(431),We=a(444),Me=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).defaultRule={rule:f.a.t("Select rule"),name:f.a.t("New rule"),id:""},e.state={localRule:e.defaultRule},e.setRuleOnMount=function(){var t=e.props,a=t.isEdit,n=t.selectedRule;a&&e.setState({localRule:n})},e.cleanState=function(){e.props.isEdit&&e.props.finishEdit(e.state.localRule),e.setState({localRule:e.defaultRule})},e.getAvaliableOptions=function(){var t=e.props,a=t.commands,n=t.currentRules,i=t.selectedRule,r=t.isEdit,l=null===a||void 0===a?void 0:a.filter((function(e){return!(e.unique&&n.find((function(t){return(null===t||void 0===t?void 0:t.rule)===e.rule})))}));return(null===i||void 0===i?void 0:i.unique)&&r?l.concat(i):l},e.getUniqueName=function(t){var a,n=(null===(a=e.props.currentRules)||void 0===a?void 0:a.map((function(e){return null===e||void 0===e?void 0:e.name}))).filter((function(e){return e.slice(0,e.length-2)===t})),i=e.props.commands.find((function(e){var a=e.rule,n=e.unique;return a===t&&n}));if(n.length){var r=n[n.length-1],l=r.slice(r.length-1);return r.slice(0,r.length-1)+ ++l}return i?t:"".concat(t," 1")},e.createForm=function(){var t=e.state.localRule,a=e.props.classes,n=e.getAvaliableOptions();return i.a.createElement(We.a,null,i.a.createElement(xe.a,null,i.a.createElement(ze.a,{shrink:!0,id:"rule"},f.a.t("Rule")),i.a.createElement(Z.a,{onChange:function(a){return e.setState({localRule:Object(k.a)(Object(k.a)({},t),{},{rule:a.target.value,name:e.getUniqueName(a.target.value),isError:""})})},value:t.rule,labelId:"rule",className:a.select},null===n||void 0===n?void 0:n.map((function(e){return i.a.createElement(ee.a,{key:e.rule,value:e.rule},e.rule)})))),i.a.createElement(V.a,{id:"standard-basic",label:e.state.localRule.isError||f.a.t("Name"),value:t.name,onChange:function(a){var n,i=null===(n=e.props.currentRules)||void 0===n?void 0:n.map((function(e){return null===e||void 0===e?void 0:e.name}));e.setState({localRule:Object(k.a)(Object(k.a)({},t),{},{name:a.target.value,isError:i.includes(a.target.value)?"".concat(f.a.t("Name already exist")):""})})},error:!!e.state.localRule.isError,className:a.TextField}))},e.setDialogContent=function(){var t=e.props,a=t.handleClose,n=t.handleSubmitOnCreate,r=t.handleSubmitOnEdit,l=t.isEdit?r:n;return i.a.createElement(ie.a,null,e.createForm(),i.a.createElement(q.a,null,i.a.createElement(le.a,{onClick:l.bind(Object(ye.a)(e),e.state.localRule,e.state.localRule.isError)},"Ok"),i.a.createElement(le.a,{onClick:a},f.a.t("Cancel"))))},e}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e){e.currentRules,this.props.currentRules}},{key:"componentWillUnmount",value:function(){this.cleanState()}},{key:"render",value:function(){return i.a.createElement(te.a,{open:this.props.isOpen,onClose:this.props.handleClose,onExited:this.cleanState,onEnter:this.setRuleOnMount,fullWidth:!0},i.a.createElement(ae.a,null,f.a.t(this.props.isEdit?"Edit rule":"Create new rule")),this.setDialogContent())}}]),a}(n.Component),_e=Object(m.a)((function(e){return{select:{width:"50%",marginBottom:e.spacing(2.5)},TextField:{marginBottom:e.spacing(1)}}}))(Me),Fe=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).getSelectedLanguageCommands=function(){var e,t,a=(null===(e=n.state)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.language)||f.a.getLanguage();return[{rule:f.a.t("Select rule"),unique:!1}].concat(Object(j.a)(Object.entries(window.commands).map((function(e){var t,n,i,r=Object(y.a)(e,2),l=r[0],s=r[1],o=(s.name,Object(w.a)(s,["name"]));return Object(k.a)(Object(k.a)({},o),{},{rule:null===s||void 0===s?void 0:s.name[a],template:l,unique:s.unique,words:s.words&&s.words[a],args:null===(t=s.args)||void 0===t?void 0:t.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{name:e.name[a]||"",default:e.default||"checkbox"!==e.type&&""})})),ack:s.ack&&Object(k.a)(Object(k.a)({},s.ack),{},{name:s.ack.name[a],default:(null===(n=s.ack)||void 0===n?void 0:n.default)?s.ack.default[a]:"checkbox"!==(null===(i=s.ack)||void 0===i?void 0:i.type)&&""})})}))))},n.commands=n.getSelectedLanguageCommands(),n.moveRule=function(e,t){var a=n.state.currentRules,i=a.find((function(e,a){return a===t})),r=a.filter((function(e,a){return a!==t}));r.splice(e,0,i),n.setState({currentRules:r})},n.handleOpen=function(){n.setState({isOpen:!0})},n.handleClose=function(){n.setState({isOpen:!1})},n.handleSubmitOnCreate=function(e,t){if(!t){var a=Object(D.a)(),i=Object(k.a)(Object(k.a)({},e),{},{id:a,_break:!0}),r=Object(k.a)(Object(k.a)({},n.commands.find((function(e){return e.rule===i.rule}))),i),l=Object.values(n.state.unsavedRules).length;n.setState({currentRules:[].concat(Object(j.a)(n.state.currentRules),[r]),unsavedRules:Object(k.a)(Object(k.a)({},n.state.unsavedRules),{},{[a]:{id:a,wasChangedGlobally:!0}}),selectedRule:l?n.state.selectedRule:r},(function(){l&&n.selectRule(r.id)})),n.handleClose()}},n.handleSubmitOnEdit=function(e,t){t||(n.setState({unsavedRules:Object(k.a)(Object(k.a)({},n.state.unsavedRules),{},{[e.id]:{id:e.id,wasChangedGlobally:!0}}),currentRules:n.updateCurrentRules(e)}),n.handleClose())},n.selectRule=function(e){var t=n.state,a=t.selectedRule,i=t.currentRules;if(a.id===e);else if(n.state.unsavedRules[a.id])n.setState({pendingSelectedRuleId:e});else{var r=i.find((function(t){return t.id===e}));n.setState({selectedRule:r})}},n.updateCurrentRules=function(e){return n.state.currentRules.map((function(t){return t.id===e.id?e:t}))},n.handleEdit=function(){n.setState({isEdit:!0}),n.handleOpen()},n.finishEdit=function(e){var t,a=e.rule,i=e.id,r=e.name,l=e._break,s=e.template;if(n.state.selectedRule.rule!==a){var o=n.commands.find((function(e){return e.rule===a}));t=Object(k.a)(Object(k.a)({},o),{},{name:r,rule:a,id:i,_break:l,template:s})}else t=e;n.setState({isEdit:!1,selectedRule:t})},n.removeRule=function(e){var t=function(){var t=Object(C.a)(R.a.mark((function t(){var a,i,r,l;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.props.readConfig();case 2:a=t.sent,i=a.rules,r=Object(w.a)(a,["rules"]),l=Object(k.a)({rules:i.filter((function(t){return t.id!==e}))},r),n.props.saveConfig(l);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=n.state.currentRules.filter((function(t){return t.id!==e}));n.setState({currentRules:a,selectedRule:a.length?a[a.length-1]:{}},t)},n.updateConfig=function(){var e=Object(C.a)(R.a.mark((function e(t){var a,i,r,l,s,o,c,u,d,m,p;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.currentRules,i=n.state.unsavedRules,r=t.id,i[r],l=Object(w.a)(i,[r].map(S.a)),e.next=4,n.props.readConfig();case 4:return s=e.sent,o=s.rules,c=Object(w.a)(s,["rules"]),u=o.find((function(e){return e.id===t.id})),d=u?n.updateCurrentRules(t):a,m=u?o.map((function(e){return e.id===t.id?n.getRuleShortData(t):e})):[].concat(Object(j.a)(o),[n.getRuleShortData(t)]),p=Object(k.a)({rules:m},c),e.next=12,n.props.saveConfig(p);case 12:n.setState({selectedRule:t||n.state.selectedRule||{},currentRules:d,unsavedRules:l});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getDataFromConfig=Object(C.a)(R.a.mark((function e(){var t,a,i,r,l;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.readConfig();case 2:return t=e.sent,a=t.rules,i=Object(w.a)(t,["rules"]),r=f.a.getLanguage(),l=a.map((function(e){var t,a,n,i=window.commands[e.template];return Object(k.a)(Object(k.a)({},i),{},{rule:null===i||void 0===i?void 0:i.name[r],ack:Object(k.a)(Object(k.a)({},i.ack),{},{default:e.ack||"checkbox"!==(null===(t=i.ack)||void 0===t?void 0:t.type)&&"",name:null===(a=i.ack)||void 0===a?void 0:a.name[r]}),args:null===(n=i.args)||void 0===n?void 0:n.map((function(t,a){return Object(k.a)(Object(k.a)({},t),{},{default:e.args[a]||"checkbox"!==(null===t||void 0===t?void 0:t.type)&&"",name:(null===t||void 0===t?void 0:t.name[r])||""})})),name:e.name||(null===i||void 0===i?void 0:i.name[r]),words:e.words,_break:e._break,id:e.id||Object(D.a)(),template:e.template})})),e.next=8,n.setState({currentRules:l,selectedRule:l.find((function(e){return e.id===localStorage.getItem("selectedRule")}))||l[l.length-1]||{},settings:i});case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)}))),n.revertChangesFromConfig=function(){var e=Object(C.a)(R.a.mark((function e(t){var a,i,r,l,s,o,c,u,d,m,p;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.state.currentRules,r=n.state.unsavedRules,l=t.id,r[l],s=Object(w.a)(r,[l].map(S.a)),e.next=4,n.props.readConfig();case 4:return o=e.sent,c=o.rules,u=Object(w.a)(o,["rules"]),d=c.find((function(e){return e.id===t.id})),m=null===(a=n.state.unsavedRules[t.id])||void 0===a?void 0:a.wasChangedGlobally,d&&m?p=i.map((function(e){var t;return e.id===d.id?Object(k.a)(Object(k.a)({},e),{},{ack:Object(k.a)(Object(k.a)({},e.ack),{},{default:d.ack||""}),args:null===(t=e.args)||void 0===t?void 0:t.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{default:d.arg||""})})),rule:window.commands[d.template].name[f.a.getLanguage()],words:d.words||"",name:d.name||"",_break:d._break||!0}):e})):d||(p=i.filter((function(e){return e.id!==t.id}))),e.next=11,n.setState({currentRules:p||i,selectedRule:(m?p.find((function(e){return e.id===t.id})):n.state.selectedRule)||{},settings:u,unsavedRules:s});case 11:n.state.currentRules.length!==i.length&&n.setState({selectedRule:n.state.currentRules[n.state.currentRules.length-1]||{}});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.saveSettings=function(){var e=Object(C.a)(R.a.mark((function e(t,a){var i,r,l;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.readConfig();case 2:return i=e.sent,r=i.rules,n.setState({settings:t}),l=Object(k.a)({rules:r},t),e.next=8,n.props.saveConfig(l);case 8:a();case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.setUnsavedRule=function(e){n.setState({unsavedRules:Object(k.a)(Object(k.a)({},n.state.unsavedRules),{},{[e]:{id:e,wasChangedGlobally:!1}})})},n.removeUnsavedRule=function(e){var t=n.state.unsavedRules,a=(t[e],Object(w.a)(t,[e].map(S.a)));n.setState({unsavedRules:a})},n.getRuleShortData=function(e){var t=e._break,a=e.template,n=e.words,i=e.ack,r=e.args,l=e.name,s=e.id;return{words:n||"",ack:(null===i||void 0===i?void 0:i.default)||"",args:(null===r||void 0===r?void 0:r.map((function(e){return e.default})))||[],_break:t,template:a,name:l,id:s}},n.clearStateOnConfirmModalUnmount=function(e){var t=n.state.unsavedRules,a=(t[e],Object(w.a)(t,[e].map(S.a)));n.setState({pendingSelectedRuleId:!1,unsavedRules:a})},n.isLargeScreen=Object(L.c)("lg",n.props.width),n.isMdScreen=Object(L.c)("md",n.props.width),n.isSmScreen=Object(L.c)("sm",n.props.width),n.isMobileScreen=Object(L.c)("xs",n.props.width),n.toggleLeftBar=function(){window.localStorage.setItem("App.menuHidden",!n.state.isLeftBarHidden),n.setState({isLeftBarHidden:!n.state.isLeftBarHidden})},n.menuSize=parseFloat(window.localStorage.getItem("App.menuSize"))||350,n.state={currentRules:[],isOpen:!1,isEdit:!1,selectedRule:{},unsavedRules:{},isLeftBarHidden:"true"===window.localStorage.getItem("App.menuHidden")},n.commands=n.getSelectedLanguageCommands(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.getDataFromConfig().then((function(t){var a=t.rules,n=Object(w.a)(t,["rules"]),i=a.map((function(e){var t;return e.id&&e.name?e:Object(k.a)(Object(k.a)({},e),{},{id:e.id?e.id:Object(D.a)(),name:e.name?e.name:null===(t=window.commands[e.template])||void 0===t?void 0:t.name[f.a.getLanguage()]})}));Te()(a,i)||e.props.saveConfig(Object(k.a)({rules:i},n))})),this.isMdScreen||this.setState({isLeftBarHidden:!0})}},{key:"componentDidUpdate",value:function(e,t){var a,n,i,r,l;if((null===(a=this.state.settings)||void 0===a?void 0:a.language)!==this.state.lang&&(null===(n=this.state.settings)||void 0===n?void 0:n.language)){var s,o=null===(s=this.state.settings)||void 0===s?void 0:s.language;f.a.setLanguage(o),this.commands=this.getSelectedLanguageCommands()}(null===(i=t.selectedRule)||void 0===i?void 0:i.id)!==(null===(r=this.state.selectedRule)||void 0===r?void 0:r.id)&&(null===(l=t.selectedRule)||void 0===l?void 0:l.id)&&localStorage.setItem("selectedRule",this.state.selectedRule.id)}},{key:"renderModalDialog",value:function(){return this.state.isOpen?i.a.createElement(_e,{key:"modal",commands:this.commands,isEdit:this.state.isEdit,handleSubmitOnCreate:this.handleSubmitOnCreate,handleSubmitOnEdit:this.handleSubmitOnEdit,handleClose:this.handleClose,isOpen:this.state.isOpen,currentRules:this.state.currentRules,selectedRule:this.state.selectedRule,finishEdit:this.finishEdit}):null}},{key:"render",value:function(){var e=this;console.log(this.state);var t=this.props.classes,a=this.state,n=a.currentRules,r=a.selectedRule,l=a.isLeftBarHidden;return[i.a.createElement(E.a,{key:"splitterLayout",customClassName:Object(I.a)(l?t.hidden:t.opened,t.layout),primaryMinSize:350,primaryIndex:1,secondaryMinSize:350,onSecondaryPaneSizeChange:function(t){return e.menuSize=parseFloat(t)},onDragEnd:function(){window.localStorage.setItem("App.menuSize",e.menuSize.toString())},secondaryInitialSize:this.menuSize},i.a.createElement(we,{handleOpen:this.handleOpen,rules:n,moveRule:this.moveRule,handleEdit:this.handleEdit,selectRule:this.selectRule,selectedRule:r,removeRule:this.removeRule,settings:this.state.settings,socket:this.props.socket,saveSettings:this.saveSettings,theme:this.props.theme,unsavedRules:this.state.unsavedRules}),this.state.settings&&i.a.createElement(Be,{selectedRule:r,socket:this.props.socket,updateCurrentRules:this.updateCurrentRules,updateConfig:this.updateConfig,revertChangesFromConfig:this.revertChangesFromConfig,pendingSelectedRuleId:this.state.pendingSelectedRuleId,unsavedRules:this.state.unsavedRules,selectRule:this.selectRule,clearStateOnConfirmModalUnmount:this.clearStateOnConfirmModalUnmount,lang:this.state.settings.language,setUnsavedRule:this.setUnsavedRule,removeUnsavedRule:this.removeUnsavedRule,toggleLeftBar:this.toggleLeftBar,isLeftBarHidden:this.state.isLeftBarHidden})),this.renderModalDialog()]}}]),a}(n.PureComponent),Pe=Object(m.a)((function(e){return{layout:{"& .layout-pane:first":{overflow:"hidden"}},hidden:{"& .layout-pane:first-child":{width:"0 !important"},background:e.palette.background.default},opened:{"& .layout-pane-primary":{width:""},overflow:"hidden",background:e.palette.background.default}}}))(Object(L.a)()(Fe)),He=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,e)).translations={en:a(404),de:a(405),ru:a(406),pt:a(407),nl:a(408),fr:a(409),it:a(410),es:a(411),pl:a(412),"zh-cn":a(413)},f.a.setTranslations(i.translations),f.a.setLanguage((navigator.language||navigator.userLanguage||"en").substring(0,2).toLowerCase()),i}return Object(c.a)(n,[{key:"onConnectionReady",value:function(){var e=this,t={};this.socket.getSystemConfig().then((function(a){return t.systemConfig=a,e.readConfig()})).then((function(t){console.log(t),e.setState({config:t,ready:!0}),t.language!==f.a.getLanguage()&&t.language&&f.a.setLanguage(t.language)})).catch((function(t){return e.showError(t)}))}},{key:"readConfig",value:function(){return this.socket.getObject("system.adapter."+this.adapterName+"."+this.instance).then((function(e){var t=e.native||{};return t.rules=t.rules||[],t.sayitInstance=t.sayitInstance||"",t.language=t.language||"",t.processorId=t.processorId||"",t.processorTimeout=t.processorTimeout||1e3,t}))}},{key:"saveConfig",value:function(e){var t=this;return this.socket.getObject("system.adapter."+this.adapterName+"."+this.instance).then((function(a){if(!Te()(a.native,e))return a.native=e,t.socket.setObject("system.adapter."+t.adapterName+"."+t.instance,a)}))}},{key:"render",value:function(){return this.state.config?i.a.createElement(s.a,{theme:this.state.theme},i.a.createElement("div",{className:"App"},i.a.createElement(Pe,{theme:this.state.theme,socket:this.socket,readConfig:this.readConfig.bind(this),saveConfig:this.saveConfig.bind(this)}),this.renderError())):i.a.createElement(s.a,{theme:this.state.theme},i.a.createElement(h.a,{theme:this.state.themeType}))}}]),n}(b.a),Je=Object(m.a)((function(e){return{root:{},logo:{width:32,height:32,padding:e.spacing(1),display:"inline-block"}}}))(He),Ke=a(225),Ye=a(172),qe=a.n(Ye),Ge=a(97),Xe=a.n(Ge);window.adapterName="text2command";var $e=Xe.a.getThemeName();console.log("iobroker."+window.adapterName+"@"+Ke.a+' using theme "'+$e+'"'),console.log(qe()($e)),window.location.host,function e(){return l.a.render(i.a.createElement(s.a,{theme:qe()($e)},i.a.createElement(Je,{onThemeChange:function(t){$e=t,e()}})),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[356,1,2]]]);
//# sourceMappingURL=main.5fb01038.chunk.js.map