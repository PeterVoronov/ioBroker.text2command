(this["webpackJsonptext2command-react"]=this["webpackJsonptext2command-react"]||[]).push([[0],{217:function(e){e.exports=JSON.parse('{"a":"2.0.0"}')},347:function(e,t,a){e.exports=a(406)},352:function(e,t,a){},395:function(e){e.exports=JSON.parse('{"Select rule":"Select rule","System":"System ","Language":"Language","Answer in id":"Answer in ID","Processor\'s id":"Processor\'s ID","Timeout for processor":"Timeout for processor","Settings":"Settings","Cancel":"Cancel","Test phrase":"Test phrase","Argument":"Argument","Confirmation text":"Confirmation text","Keywords":"Keywords","Interrupt processing":"Interrupt processing","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"You can use %s, that will be replaced with current value of state. %u will be replaced by unit","Ok":"Ok","Create Rule":"Create Rule","Are you sure?":"Are you sure?","You want to delete: %s":"You want to delete: %s","Refresh":"Refresh","Remove rule":"Remove rule","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","lang_en":"english","lang_de":"German","lang_ru":"russian","ms":"ms","Create rule":"Create rule","refresh":"Refresh","Save":"Save"}')},396:function(e){e.exports=JSON.parse('{"Select rule":"Regel ausw\xe4hlen","System":"System","Language":"Sprache","Answer in id":"Antwort in ID","Processor\'s id":"Prozessor-ID","Timeout for processor":"Timeout f\xfcr den Prozessor","Settings":"Einstellungen","Cancel":"Abbrechen","Test phrase":"Testphrase","Argument":"Argument","Confirmation text":"Best\xe4tigungstext","Keywords":"Schl\xfcsselw\xf6rter","Interrupt processing":"Verarbeitung unterbrechen","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"Sie k\xf6nnen %s verwenden, das durch den aktuellen Statuswert ersetzt wird. %u wird durch Einheit ersetzt","Ok":"OK","Create Rule":"Regel erstellen","Are you sure?":"Sind Sie sicher?","You want to delete: %s":"Sie m\xf6chten l\xf6schen: %s","refresh":"Aktualisieren","lang_en":"Englisch","lang_de":"Deutsch","lang_ru":"Russisch","ms":"ms","Remove rule":"Regel entfernen","Refresh":"Aktualisierung","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"Regel erstellen","Save":"Speichern"}')},397:function(e){e.exports=JSON.parse('{"Select rule":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","System":"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438","Language":"\u044f\u0437\u044b\u043a","Answer in id":"\u041e\u0442\u0432\u0435\u0442 \u0432 ID","Processor\'s id":"ID \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430","Timeout for processor":"\u0422\u0430\u0439\u043c-\u0430\u0443\u0442 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430","Settings":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438","Cancel":"\u041e\u0442\u043c\u0435\u043d\u0430","Test phrase":"\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0444\u0440\u0430\u0437\u0430","Argument":"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440","Confirmation text":"\u0422\u0435\u043a\u0441\u0442 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f","Keywords":"\u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0441\u043b\u043e\u0432\u0430","Interrupt processing":"\u041f\u0440\u0435\u0440\u0432\u0430\u0442\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c %s, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043c\u0435\u043d\u0435\u043d \u0442\u0435\u043a\u0443\u0449\u0438\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f. %u \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043c\u0435\u043d\u0435\u043d\u043e \u043d\u0430 \u0435\u0434\u0438\u043d\u0438\u0446\u044b \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f","Ok":"Ok","Create Rule":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Are you sure?":"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?","You want to delete: %s":"\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c: %s","Refresh":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c","Remove rule":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","lang_en":"\u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439","lang_de":"\u041d\u0435\u043c\u0435\u0446\u043a\u0438\u0439","lang_ru":"\u0440\u0443\u0441\u0441\u043a\u0438\u0439","ms":"\u043c\u0441","Save":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}')},398:function(e){e.exports=JSON.parse('{"Select rule":"Selecionar regra","System":"Sistema","Language":"L\xedngua","Answer in id":"Resposta em ID","Processor\'s id":"ID do processador","Timeout for processor":"Tempo limite do processador","Settings":"Configura\xe7\xf5es","Cancel":"Cancelar","Test phrase":"Frase de teste","Argument":"Argumento","Confirmation text":"Texto de confirma\xe7\xe3o","Keywords":"Palavras-chave","Interrupt processing":"Interromper o processamento","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"Voc\xea pode usar %s, que ser\xe1 substitu\xeddo pelo valor atual do estado. %u ser\xe1 substitu\xeddo por unidade","Ok":"Ok","Create Rule":"Criar regra","Are you sure?":"Voc\xea tem certeza?","You want to delete: %s":"Voc\xea deseja excluir: %s","refresh":"Atualizar","lang_en":"Ingl\xeas","lang_de":"alem\xe3o","lang_ru":"russo","ms":"ms","Remove rule":"Remover regra","Refresh":"Atualizar","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"Criar regra","Save":"Salve \ue051"}')},399:function(e){e.exports=JSON.parse('{"Select rule":"Selecteer regel","System":"Systeem","Language":"Taal","Answer in id":"Antwoord in ID","Processor\'s id":"Verwerker ID","Timeout for processor":"Time-out voor processor","Settings":"Instellingen","Cancel":"Annuleer","Test phrase":"Testzin","Argument":"Argument","Confirmation text":"Bevestigingstekst","Keywords":"Sleutelwoorden","Interrupt processing":"Verwerking onderbreken","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"U kunt %s gebruiken, dat zal worden vervangen door de huidige waarde van de staat. %u wordt vervangen door eenheid","Ok":"OK","Create Rule":"Cre\xeber regel","Are you sure?":"Weet je het zeker?","You want to delete: %s":"Je wilt verwijderen: %s","refresh":"Vernieuwen","lang_en":"Engels","lang_de":"Duitse","lang_ru":"Russisch","ms":"ms","Remove rule":"Regel verwijderen","Refresh":"Vernieuwen","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"Cre\xeber regel","Save":"Sparen"}')},400:function(e){e.exports=JSON.parse('{"Select rule":"S\xe9lectionnez la r\xe8gle","System":"Syst\xe8me","Language":"Langue","Answer in id":"R\xe9ponse dans l\'ID","Processor\'s id":"ID du processeur","Timeout for processor":"D\xe9lai d\'expiration pour le processeur","Settings":"Param\xe8tres","Cancel":"Annuler","Test phrase":"Expression de test","Argument":"Argument","Confirmation text":"Texte de confirmation","Keywords":"Mots cl\xe9s","Interrupt processing":"Interrompre le traitement","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"Vous pouvez utiliser %s, qui sera remplac\xe9 par la valeur actuelle de l\'\xe9tat. %u sera remplac\xe9 par l\'unit\xe9","Ok":"Ok","Create Rule":"Cr\xe9er une r\xe8gle","Are you sure?":"\xcates-vous s\xfbr?","You want to delete: %s":"Vous souhaitez supprimer: %s","refresh":"Rafra\xeechir","lang_en":"Anglais","lang_de":"allemand","lang_ru":"russe","ms":"ms","Remove rule":"Supprimer la r\xe8gle","Refresh":"Rafra\xeechir","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"Cr\xe9er une r\xe8gle","Save":"sauver"}')},401:function(e){e.exports=JSON.parse('{"Select rule":"Seleziona la regola","System":"Sistema","Language":"linguaggio","Answer in id":"Risposta in ID","Processor\'s id":"ID del processore","Timeout for processor":"Timeout per processore","Settings":"impostazioni","Cancel":"Annulla","Test phrase":"Frase di prova","Argument":"Discussione","Confirmation text":"Testo di conferma","Keywords":"parole","Interrupt processing":"Interrompere l\'elaborazione","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"Puoi usare %s, che verr\xe0 sostituito con il valore corrente di stato. %u verr\xe0 sostituito dall\'unit\xe0","Ok":"Ok","Create Rule":"Crea regola","Are you sure?":"Sei sicuro?","You want to delete: %s":"Vuoi eliminare: %s","refresh":"ricaricare","lang_en":"Inglese","lang_de":"Tedesco","lang_ru":"russo","ms":"ms","Remove rule":"Rimuovi regola","Refresh":"ricaricare","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"Crea regola","Save":"Salva"}')},402:function(e){e.exports=JSON.parse('{"Select rule":"Seleccionar regla","System":"Sistema","Language":"Idioma","Answer in id":"Respuesta en ID","Processor\'s id":"ID del procesador","Timeout for processor":"Tiempo de espera para el procesador","Settings":"Configuraciones","Cancel":"Cancelar","Test phrase":"Frase de prueba","Argument":"Argumento","Confirmation text":"Texto de confirmaci\xf3n","Keywords":"Palabras clave","Interrupt processing":"Procesamiento de interrupci\xf3n","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"Puede usar %s, que se reemplazar\xe1 con el valor actual del estado. %u ser\xe1 reemplazado por unidad","Ok":"Okay","Create Rule":"Crear regla","Are you sure?":"\xbfEst\xe1s seguro?","You want to delete: %s":"Desea eliminar: %s","refresh":"Actualizar","lang_en":"Ingl\xe9s","lang_de":"alem\xe1n","lang_ru":"ruso","ms":"ms","Remove rule":"Eliminar regla","Refresh":"Actualizar","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"Crear regla","Save":"Salvar"}')},403:function(e){e.exports=JSON.parse('{"Select rule":"Wybierz regu\u0142\u0119","System":"System","Language":"J\u0119zyk","Answer in id":"Odpowiedz w ID","Processor\'s id":"ID procesora","Timeout for processor":"Limit czasu dla procesora","Settings":"Ustawienia","Cancel":"Anuluj","Test phrase":"Testowa fraza","Argument":"Argument","Confirmation text":"Tekst potwierdzaj\u0105cy","Keywords":"S\u0142owa kluczowe","Interrupt processing":"Przerwa\u0107 przetwarzanie","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"Mo\u017cesz u\u017cy\u0107 %s, kt\xf3ry zostanie zast\u0105piony bie\u017c\u0105c\u0105 warto\u015bci\u0105 stanu. %u zostanie zast\u0105pione przez jednostk\u0119","Ok":"Ok","Create Rule":"Stw\xf3rz zasad\u0119","Are you sure?":"Jeste\u015b pewny?","You want to delete: %s":"Chcesz usun\u0105\u0107: %s","refresh":"Od\u015bwie\u017ca\u0107","lang_en":"j\u0119zyk angielski","lang_de":"Niemiecki","lang_ru":"Rosyjski","ms":"ms","Remove rule":"Usu\u0144 regu\u0142\u0119","Refresh":"Od\u015bwie\u017ca\u0107","Search rule":"\u041d\u0430\u0439\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"Stw\xf3rz zasad\u0119","Save":"Zapisa\u0107"}')},404:function(e){e.exports=JSON.parse('{"Select rule":"\u9009\u62e9\u89c4\u5219","System":"\u7cfb\u7edf","Language":"\u8bed\u8a00","Answer in id":"\u8f93\u5165\u7b54\u6848","Processor\'s id":"\u5904\u7406\u5668ID","Timeout for processor":"\u5904\u7406\u5668\u8d85\u65f6","Settings":"\u8bbe\u5b9a\u503c","Cancel":"\u53d6\u6d88","Test phrase":"\u6d4b\u8bd5\u8bcd","Argument":"\u8bba\u636e","Confirmation text":"\u786e\u8ba4\u6587\u5b57","Keywords":"\u5173\u952e\u8bcd","Interrupt processing":"\u4e2d\u65ad\u5904\u7406","You can use %s, that will be replaced with current value of state. %u will be replaced by unit":"\u60a8\u53ef\u4ee5\u4f7f\u7528\uff05s\uff0c\u5b83\u5c06\u66ff\u6362\u4e3astate\u7684\u5f53\u524d\u503c\u3002 \uff05u\u5c06\u88ab\u5355\u4f4d\u66ff\u6362","Ok":"\u597d","Create Rule":"\u5efa\u7acb\u89c4\u5219","Are you sure?":"\u4f60\u786e\u5b9a\u5417\uff1f","You want to delete: %s":"\u60a8\u8981\u5220\u9664\uff1a\uff05s","refresh":"\u5237\u65b0","lang_en":"\u82f1\u8bed","lang_de":"\u5fb7\u8bed","lang_ru":"\u4fc4\u8bed","ms":"ms","Remove rule":"\u5220\u9664\u89c4\u5219","Refresh":"\u5237\u65b0","Search rule":"\u041d\u0430\u0439\u0442\u0438\u043f\u0440\u0430\u0432\u0438\u043b\u043e","Create rule":"\u5efa\u7acb\u89c4\u5219","Save":"\u4fdd\u5b58"}')},406:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),r=a(18),l=a.n(r),i=a(445),o=a(444),c=a(436);const u=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function d(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}a(352);var h=a(5),m=a(207),p=a.n(m),g=a(16),v=a.n(g),f=a(315),S=a.n(f),b=a(137),R=a(24),w=a.n(R),C=a(38),O=a(10),k=a(54),y=a(174),x=a(316),E=a.n(x),j=a(446),D=a(3),I=a(156),A=(a(361),a(50)),T=a(443),L=a(334),N=a(289),z=a(293),U=a(330),B=a.n(U),M=a(302),_=a(418),W=a(288),P=a(292),F=a(107),Y=a(290),J=a(214),V=a(299),K=a(442),q=a(287),G=a(203),H=a(424),X=a(210),Z=a(324),$=a.n(Z),Q=a(325),ee=a.n(Q),te=a(326),ae=a.n(te),se=a(208),ne=a(134),re=a.n(ne),le=a(329),ie=a.n(le),oe=a(327),ce=a.n(oe),ue=a(328),de=a.n(ue),he=a(166),me=a.n(he),pe=a(286),ge=a(413),ve=a(440),fe=a(439),Se=a(322),be=a.n(Se),Re=a(321),we=a.n(Re),Ce=a(320),Oe=a.n(Ce),ke=a(171);const ye=n.a.forwardRef((e,t)=>{var a;const r=e.name,l=e.handleEdit,i=e.rule,o=e.isDragging,c=e.connectDragSource,u=e.connectDropTarget,d=e.id,h=e.selectRule,m=e.selectedRule,p=e._break,g=e.matchingRules,v=e.unsavedRules,f=e.index,S=e.theme,b=e.removeMatched,R=e.words,w=Object(pe.a)({listItem:{cursor:"pointer",transition:"background-color 0.3s linear",position:"relative"},listItemText:{"& span":{color:S.palette.text.primary},"& p":{color:S.palette.text.secondary,textOverflow:"ellipsis",overflow:"hidden"}},dot:{position:"absolute",backgroundColor:"red",top:5,right:15,width:10,height:10,borderRadius:"50%"},maximize:{color:null===(a=S.palette.error)||void 0===a?void 0:a.dark,marginBottom:-S.spacing(2)}})(),C=Object(s.useRef)(null);c(C),u(C);const O=o?0:1;Object(s.useImperativeHandle)(t,()=>({getNode:()=>C.current}));const k=Object(s.useCallback)(()=>h(d),[d,h]),x=Object(s.useCallback)(()=>l(d),[d,l]),E=[{icon:p?n.a.createElement(Oe.a,{className:w.maximize}):n.a.createElement(we.a,{color:"primary"})},{icon:n.a.createElement(be.a,null),handleClick:x}],j=Object(s.useState)(""),D=Object(y.a)(j,2),I=D[0],A=D[1];Object(s.useEffect)(()=>{if(g.length){const e=g.find(e=>e.indexOf===f);e&&(setTimeout(()=>{var e;return A(null===S||void 0===S||null===(e=S.palette)||void 0===e?void 0:e.secondary.dark)},e.timer),setTimeout(()=>{var e,t;A(m.id===d?null===S||void 0===S||null===(e=S.palette)||void 0===e||null===(t=e.background)||void 0===t?void 0:t.default:""),(p||f===g[g.length-1].indexOf)&&b()},1500*(e.index+1)))}},[g]);let T=i!==r?i:"";return T+="".concat(T?" ":"","[").concat(R,"]"),n.a.createElement("div",{ref:C,style:{opacity:O,backgroundColor:I}},n.a.createElement(ge.a,{onClick:k,selected:(null===m||void 0===m?void 0:m.id)===d,className:w.listItem},n.a.createElement(ve.a,{primary:r,secondary:T,className:w.listItemText}),n.a.createElement(fe.a,null,s.Children.toArray(E.map(({icon:e,handleClick:t},a)=>n.a.createElement(se.a,{disabled:!a,onClick:t},e)))),v[d]&&n.a.createElement(G.a,{className:w.dot})))}),xe="rule";var Ee=Object(ke.DropTarget)(xe,{hover(e,t,a){if(!a)return null;const s=a.getNode();if(!s)return null;const n=t.getItem().index,r=e.index;if(n===r)return;const l=s.getBoundingClientRect(),i=(l.bottom-l.top)/2,o=t.getClientOffset().y-l.top;n<r&&o<i||n>r&&o>i||(e.moveRule(n,r),t.getItem().index=r)}},e=>({connectDropTarget:e.dropTarget()}))(Object(ke.DragSource)(xe,{beginDrag:e=>({id:e.id,index:e.index})},(e,t)=>({connectDragSource:e.dragSource(),isDragging:t.isDragging()}))(ye));const je=Object(h.a)(e=>({tooltip:{fontSize:14}}))(M.a);class De extends s.Component{constructor(...e){var t;super(...e),t=this,this.state={textCommand:"",matchingRules:[],isSettingsDialogOpen:!1,isConfirmRemoveDialogOpen:!1,isSearchActive:!1,filteredRules:[],searchedValue:"",localSettings:{language:"",processorId:"",processorTimeout:1e3,sayitInstance:""}},this.getDefaultSettings=()=>{this.setState({localSettings:Object(O.a)({},this.props.settings)})},this.handleTextCommand=e=>{this.setState({textCommand:e.target.value})},this.handleSubmit=(e,t)=>{if("Enter"===e.key||t){const e=this.findMatchingRules();this.setState({matchingRules:e.map((e,t)=>({indexOf:e,timer:1500*t,index:t}))})}},this.removeMatched=()=>{this.setState({matchingRules:[]})},this.handleOpenSettingsModal=()=>{this.setState({isSettingsDialogOpen:!0})},this.handleDialogSelectIdSubmit=(e,t)=>{this.setState({localSettings:Object(O.a)(Object(O.a)({},this.state.localSettings),{},{[t]:e})})},this.handleDelete=()=>{this.props.removeRule(this.props.selectedRule.id),this.handleCloseConfirmRemoveDialog()},this.handleCloseConfirmRemoveDialog=()=>{this.setState({isConfirmRemoveDialogOpen:!1})},this.handleSearch=e=>{const t=this.props.rules.filter(t=>t.name.toLowerCase().includes(e.target.value.toLowerCase()));this.setState({filteredRules:t||[],searchedValue:e.target.value})},this.toggleSearch=Object(C.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setState({isSearchActive:!t.state.isSearchActive});case 2:case"end":return e.stop()}}),e)}))),this.createSettingsModal=()=>{const e=v.a.t,t=this.props.classes,a=()=>{this.setState({isSettingsDialogOpen:!1,isSettingsWasNotSaved:!0})},r=(e,t)=>{let a=e.target.value;"language"===t&&"system"===a&&(a=""),this.setState({localSettings:Object(O.a)(Object(O.a)({},this.state.localSettings),{},{[t]:a})})};return n.a.createElement(W.a,{open:this.state.isSettingsDialogOpen,onClose:a,fullWidth:!0,onExited:this.getDefaultSettings},n.a.createElement(P.a,null,n.a.createElement(F.a,{variant:"h4",component:"span",align:"center"},e("Settings"))),n.a.createElement(Y.a,null,n.a.createElement("form",{noValidate:!0,autoComplete:"off"},n.a.createElement(X.a,{fullWidth:!0,classes:{root:t.settingsItem}},n.a.createElement(H.a,{id:"demo-simple-select-label"},e("Language")),n.a.createElement(J.a,{classes:{root:t.width100},onChange:e=>r(e,"language"),value:this.state.localSettings.language?this.state.localSettings.language:"system"},n.a.createElement(V.a,{value:"system"},e("System")),s.Children.toArray(["en","de","ru"].map(t=>n.a.createElement(V.a,{value:t},e("lang_"+t)))))),n.a.createElement(X.a,{fullWidth:!0,classes:{root:t.settingsItem}},n.a.createElement(K.a,{label:e("Answer in id"),value:this.state.localSettings.sayitInstance,onClick:()=>this.setState({showDialogSelectId:!0,selectedSettingsName:"sayitInstance"})})),n.a.createElement(X.a,{fullWidth:!0,classes:{root:t.settingsItem}},n.a.createElement(K.a,{label:e("Processor's id"),value:this.state.localSettings.processorId,onClick:()=>this.setState({showDialogSelectId:!0,selectedSettingsName:"processorId"})})),n.a.createElement(X.a,{fullWidth:!0,classes:{root:t.settingsItem}},n.a.createElement(K.a,{label:e("Timeout for processor"),helperText:e("ms"),value:this.state.localSettings.processorTimeout,onChange:e=>r(e,"processorTimeout")})))),n.a.createElement(N.a,null,n.a.createElement(q.a,{onClick:()=>{this.props.saveSettings(this.state.localSettings,a)}},"Ok"),n.a.createElement(q.a,{onClick:a},v.a.t("Cancel"))))},this.mainIcons=[{icon:n.a.createElement($.a,null),handler:()=>this.props.handleOpen(),tooltip:v.a.t("Create rule")},{icon:n.a.createElement(ee.a,null),handler:()=>this.handleOpenSettingsModal(),tooltip:v.a.t("Settings")},{icon:n.a.createElement(ae.a,null),handler:()=>console.log("refresh"),tooltip:v.a.t("Refresh")}],this.createIcons=e=>e.map(({icon:e,handler:t,tooltip:a},s)=>n.a.createElement(je,{title:a,key:s},n.a.createElement(se.a,{onClick:t},e)))}componentDidUpdate(e,t){this.props.settings!==e.settings&&this.props.settings&&this.getDefaultSettings()}findMatchingRules(){const e=this.state.textCommand;return e?window.findMatched(e,JSON.parse(JSON.stringify(this.props.rules))):[]}renderSelectIdDialog(){return this.state.showDialogSelectId?n.a.createElement(me.a,{socket:this.props.socket,title:"Select ID",onClose:()=>this.setState({showDialogSelectId:!1}),onOk:e=>this.handleDialogSelectIdSubmit(e,this.state.selectedSettingsName)}):null}renderConfirmDialog(){return this.state.isConfirmRemoveDialogOpen?n.a.createElement(W.a,{open:this.state.isConfirmRemoveDialogOpen,onClose:this.handleCloseConfirmRemoveDialog,fullWidth:!0},n.a.createElement(P.a,null,v.a.t("Are you sure?")),n.a.createElement(Y.a,null,n.a.createElement(F.a,{variant:"h5",component:"h5"},v.a.t("You want to delete")+": ",n.a.createElement("strong",null,this.props.selectedRule.name)),n.a.createElement(N.a,null,n.a.createElement(q.a,{onClick:this.handleDelete},v.a.t("Ok")),n.a.createElement(q.a,{onClick:this.handleCloseConfirmRemoveDialog,color:"primary"},v.a.t("Cancel"))))):null}render(){const e=this.props,t=e.selectedRule,a=e.moveRule,s=e.handleEdit,r=e.rules,l=e.selectRule,i=e.classes,o=e.isMdScreen,c=e.closeDrawer,u=this.state,d=u.filteredRules,h=u.isSearchActive,m=u.searchedValue,p=this.createSettingsModal(),g=h&&m.length?d:r,f=[];return t&&t.id&&f.push({icon:!h&&n.a.createElement(ce.a,null),handler:()=>this.setState({isConfirmRemoveDialogOpen:!0}),tooltip:v.a.t("Remove rule"),key:"delete"}),r.length&&f.push({icon:h?n.a.createElement(de.a,null):n.a.createElement(ie.a,null),handler:()=>this.toggleSearch(),tooltip:v.a.t("Search rule"),key:"search"}),n.a.createElement(G.a,{className:i.main},n.a.createElement(z.a,{position:"static",classes:{root:i.toolbar}},h?n.a.createElement(K.a,{className:i.search,onChange:this.handleSearch,value:this.state.searchedValue,InputProps:{endAdornment:this.state.searchedValue?n.a.createElement(se.a,{onClick:()=>this.setState({searchedValue:""})},n.a.createElement(re.a,null)):void 0},autoFocus:!0}):n.a.createElement("div",null,this.createIcons(this.mainIcons)),n.a.createElement("div",null,this.createIcons(f)),!o&&n.a.createElement(se.a,{className:i.closeBtn,onClick:c},n.a.createElement(re.a,null))),n.a.createElement(T.a,{backend:L.a},n.a.createElement(_.a,{className:i.list},g.map((e,r)=>n.a.createElement(Ee,Object.assign({theme:this.props.theme,handleEdit:s},e,{index:r,moveRule:a,key:e.id,selectRule:l,selectedRule:t,matchingRules:this.state.matchingRules,unsavedRules:this.props.unsavedRules,removeMatched:this.removeMatched}))))),n.a.createElement(z.a,{className:i.test,variant:"dense"},n.a.createElement(K.a,{onChange:this.handleTextCommand,label:v.a.t("Test phrase"),variant:"outlined",size:"small",color:"primary",className:Object(D.a)("outlined-basic",i.root),onKeyDown:this.handleSubmit,value:this.state.textCommand,inputProps:{style:{padding:"10px 10px"}},InputProps:{endAdornment:this.state.textCommand?n.a.createElement(se.a,{onClick:()=>this.setState({textCommand:""})},n.a.createElement(re.a,null)):void 0}}),n.a.createElement(se.a,{variant:"outlined",onClick:e=>this.handleSubmit(e,!0)},n.a.createElement(B.a,{className:i.play}))),p,this.renderConfirmDialog(),this.renderSelectIdDialog())}}var Ie=Object(h.a)(e=>({test:{width:"100%",boxSizing:"border-box",height:64},main:{minWidth:330,overflow:"hidden",height:"100%"},toolbar:{background:e.palette.primary.main,position:"relative"},list:{height:"calc(100% - 64px - 64px - 18px)",overflowX:"hidden",overflowY:"auto"},root:{width:"calc(100% - 48px)"},header:{minHeight:44,height:"auto",padding:e.spacing(1.3),border:"1px solid ".concat(e.palette.divider)},textInput:{width:"60%",[e.breakpoints.down("sm")]:{width:"100%"}},settingsTitle:{fontSize:"20px",maxWidth:145,[e.breakpoints.down("sm")]:{marginBottom:e.spacing(1)}},settingsContent:{[e.breakpoints.down("sm")]:{flexDirection:"column",display:"flex"}},closeBtn:{position:"absolute",top:0,right:0,color:e.palette.common.white},search:{flexBasis:"80%",[e.breakpoints.down("sm")]:{flexBasis:"70%"}},settingsItem:{marginBottom:e.spacing(3)},width100:{width:"100%"}}))(De),Ae=a(441),Te=a(177),Le=a(332),Ne=a.n(Le),ze=a(331),Ue=a.n(ze),Be=a(104),Me=a.n(Be);class _e extends s.PureComponent{constructor(...e){var t;super(...e),t=this,this.defaultState={words:v.a.t("Create Rule"),name:v.a.t("Create Rule"),_break:!1,editable:!1,args:[{default:v.a.t("Argument")+" 1"},{default:v.a.t("Argument")+" 2"}],ack:{name:"",default:"".concat(v.a.t("Confirmation text"))},id:0},this.state={localRule:null,showDialog:!1},this.createConfirmModalActions=()=>{const e=v.a.t,a=this.props,s=a.updateConfig,r=a.classes,l=a.selectRule,i=a.pendingSelectedRuleId,o=a.clearStateOnConfirmModalUnmount,c=a.revertChangesFromConfig,u=this.state.localRule,d=function(){var e=Object(C.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:t.closeConfirmDialog();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(C.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(u);case 2:return e.next=4,l(i);case 4:return e.next=6,o(u.id);case 6:t.closeConfirmDialog();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(C.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(u);case 2:return e.next=4,l(i);case 4:return e.next=6,o();case 6:t.closeConfirmDialog();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n.a.createElement(X.a,{className:r.submitForm},n.a.createElement(q.a,{variant:"contained",onClick:m,color:"primary",className:r.saveAndGoBtn},e("Save and go")),n.a.createElement(q.a,{onClick:h,variant:"contained",color:"secondary"},e("Don't save and go")),n.a.createElement(q.a,{variant:"contained",className:r.btnDanger,onClick:d},e("Cancel")))},this.createSaveSettingsForm=()=>{const e=v.a.t,a=this.props,s=a.updateConfig,r=a.classes,l=a.revertChangesFromConfig,i=a.selectedRule,o=this.state.localRule,c=function(){var e=Object(C.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(o);case 2:t.setState({isLocalStateWasUpdated:!1});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(C.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(o);case 2:return e.next=4,t.setState({localRule:i,isLocalStateWasUpdated:!1});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return this.state.isLocalStateWasUpdated?n.a.createElement(X.a,{className:r.submitForm},n.a.createElement(q.a,{onClick:c,variant:"contained",color:"primary"},e("Save")),n.a.createElement(q.a,{variant:"contained",className:r.btnDanger,onClick:u},e("Cancel"))):n.a.createElement("div",{className:this.props.classes.emptyButtons})},this.closeConfirmDialog=()=>{this.setState({isLocalStateWasUpdated:!1,confirmChanges:!1})},this.createInput=({value:e,label:t,onChange:a,type:s,onClick:r,note:l,disabled:i=!this.state.localRule,keywords:o,key:c,onSwitchChange:u})=>{if((void 0===e||null===e)&&!t&&!o)return;const d=this.props.classes;return"checkbox"!==s?n.a.createElement(K.a,{variant:"outlined",size:"small",disabled:i,value:e,helperText:l||"",onClick:r,onChange:a,key:c,className:Object(D.a)("outlined-basic",d.textField)}):n.a.createElement(X.a,{classes:{root:d.switchControl}},n.a.createElement(Ae.a,{key:c,onClick:u,color:"primary",disabled:i,checked:!!e}))},this.createOptionsData=(e=this.state)=>{var t,a,s,n,r,l,i,o;const c=e.localRule,u=c.args,d=c.ack,h=c.editable,m=c._break,p=v.a.t,g=this.createInput,f=this.handlers;return[{title:p("Keywords"),item:g({value:(null===(t=this.state.localRule)||void 0===t?void 0:t.words)||"",onChange:f.keywordsText,keywords:!0,disabled:void 0!==h&&!1===h,key:"keywords"}),id:1},{title:p("Interrupt processing"),item:g({type:"checkbox",value:m,onSwitchChange:f.breakOnSwitch,key:"break"}),id:2},{title:u&&(null===(a=u[0])||void 0===a?void 0:a.name),item:g({value:u&&(null===(s=this.state.localRule.args[0])||void 0===s?void 0:s.default),label:u&&(null===(n=u[0])||void 0===n?void 0:n.name),type:u&&(null===(r=u[0])||void 0===r?void 0:r.type),onClick:this.handleSetDialogClick.bind(this,u&&u[0]),onSwitchChange:f.param1OnSwitch,key:"Param1"}),id:3},{title:u&&(null===(l=u[1])||void 0===l?void 0:l.name),item:g({value:u&&(null===(i=this.state.localRule.args[1])||void 0===i?void 0:i.default),label:u&&(null===(o=u[1])||void 0===o?void 0:o.name),onChange:f.param2Text,key:"Param2"}),id:4},{title:p("Confirmation text"),item:g({value:d&&d.default,label:d&&d.name,note:p("You can use %s, that will be replaced with current value of state. %u will be replaced by unit"),type:d&&d.type,key:"confirmationText",onChange:f.confirmText,onSwitchChange:f.confirmOnSwitch}),id:5}]},this.createInputHandlers=()=>{const e=this;return{keywordsText(t){e.setState({localRule:Object(O.a)(Object(O.a)({},e.state.localRule),{},{words:t.target.value}),isLocalStateWasUpdated:!0})},param2Text(t){e.setState({localRule:Object(O.a)(Object(O.a)({},e.state.localRule),{},{args:e.state.localRule.args.map((e,a)=>a>0?Object(O.a)(Object(O.a)({},e),{},{default:t.target.value}):e)}),isLocalStateWasUpdated:!0})},confirmText(t){e.setState({localRule:Object(O.a)(Object(O.a)({},e.state.localRule),{},{ack:Object(O.a)(Object(O.a)({},e.state.localRule.ack),{},{default:t.target.value})}),isLocalStateWasUpdated:!0})},param1OnSwitch(){e.setState({localRule:Object(O.a)(Object(O.a)({},e.state.localRule),{},{args:e.state.localRule.args.map((e,t)=>t?e:Object(O.a)(Object(O.a)({},e),{},{default:!e.default||!e.default}))}),isLocalStateWasUpdated:!0})},confirmOnSwitch(){e.setState({localRule:Object(O.a)(Object(O.a)({},e.state.localRule),{},{ack:Object(O.a)(Object(O.a)({},e.state.localRule.ack),{},{default:!e.state.localRule.ack.default})}),isLocalStateWasUpdated:!0})},breakOnSwitch:()=>Object(C.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({localRule:Object(O.a)(Object(O.a)({},e.state.localRule),{},{_break:!e.state.localRule._break}),isLocalStateWasUpdated:!0});case 2:case"end":return t.stop()}}),t)})))()}},this.handlers=this.createInputHandlers(),this.handleSetDialogClick=e=>{"id"===e.type&&this.setState({showDialog:!0})},this.handleDialogSelectIdSubmit=e=>{this.setState({localRule:Object(O.a)(Object(O.a)({},this.state.localRule),{},{args:this.state.localRule.args.map((t,a)=>a?t:Object(O.a)(Object(O.a)({},t),{},{default:e}))}),isLocalStateWasUpdated:!0})}}componentDidUpdate(e,t){var a,s,n,r;if((null===(a=e.selectedRule)||void 0===a?void 0:a.name)!==(null===(s=this.props.selectedRule)||void 0===s?void 0:s.name)||(null===(n=t.localRule)||void 0===n?void 0:n.name)!==(null===(r=this.state.localRule)||void 0===r?void 0:r.name))this.props.selectedRule&&this.props.selectedRule.name?this.setState({localRule:Object(O.a)({},this.props.selectedRule)}):this.setState({localRule:null});else if(this.state.isLocalStateWasUpdated){const e=this.props.unsavedRules[this.state.localRule.id];Me()(this.props.selectedRule,this.state.localRule)&&!(null===e||void 0===e?void 0:e.wasChangedGlobally)?(this.setState({isLocalStateWasUpdated:!1}),(null===e||void 0===e?void 0:e.wasChangedGlobally)||this.props.removeUnsavedRule(this.state.localRule.id)):e||this.props.pendingSelectedRuleId||this.props.setUnsavedRule(this.state.localRule.id)}else!this.state.isLocalStateWasUpdated&&this.props.unsavedRules[this.state.localRule.id]&&this.setState({isLocalStateWasUpdated:!0});if(this.props.pendingSelectedRuleId&&this.state.isLocalStateWasUpdated){if(this.props.pendingSelectedRuleId===this.state.localRule.id)return;this.setState({confirmChanges:!0})}this.props.lang!==e.lang&&this.forceUpdate()}componentDidMount(){!this.state.localRule&&this.props.selectedRule&&this.setState({localRule:this.props.selectedRule})}renderConfirmDialog(){return this.state.confirmChanges?n.a.createElement(W.a,{fullWidth:!0,open:this.state.confirmChanges,maxWidth:"md"},n.a.createElement(P.a,null,v.a.t("Please confirm or cancel changes before leaving")),n.a.createElement(Y.a,null,n.a.createElement(F.a,null,v.a.t("You have changed rule")+": "," ",n.a.createElement("strong",null,this.state.localRule.name)),n.a.createElement(N.a,null,this.createConfirmModalActions()))):null}renderSelectIdDialog(){return this.state.showDialog?n.a.createElement(me.a,{socket:this.props.socket,title:"Select ID",onClose:e=>{console.log(e),this.setState({showDialog:!1})},onOk:this.handleDialogSelectIdSubmit}):null}render(){const e=this.state,t=e.localRule,a=e.isLocalStateWasUpdated,s=this.props,r=s.classes,l=s.isLeftBarHidden,i=s.toggleLeftBar,o=t?t.name:"";return n.a.createElement(G.a,{mt:"30px",className:r.box},t?n.a.createElement(Te.a,{className:r.container,mx:"auto"},n.a.createElement(F.a,{variant:"h4",align:"center",className:a?"":r.mainTitle},o),this.createSaveSettingsForm(),this.createOptionsData().map(({title:e,item:t,id:a})=>t?n.a.createElement(G.a,{display:"flex",justifyContent:"space-between",mb:"10px",key:a,className:r.row},n.a.createElement(F.a,{variant:"h6",component:"h6",align:"left",className:r.title},e?e+":":""),t):null)):n.a.createElement("div",{className:r.noRulesText},v.a.t('Create a new rule with a "+" on the left')),n.a.createElement(G.a,{className:r.toggleIcon,onClick:i},l||!this.props.isMdScreen?n.a.createElement(Ue.a,null):n.a.createElement(Ne.a,null)),this.renderSelectIdDialog(),this.renderConfirmDialog())}}var We=Object(h.a)(e=>({box:{display:"inline-flex",justifyContent:"space-around",padding:e.spacing(2),width:"calc(100% - "+e.spacing(4)+"px)",position:"relative","& .outlined-basic":{padding:"12px 10px"},[e.breakpoints.down("md")]:{"& .outlined-basic":{padding:0}}},container:{width:"70%",padding:e.spacing(2),[e.breakpoints.down("md")]:{width:"90%"},[e.breakpoints.down("lg")]:{width:"80%"}},textField:{flexBasis:"60%",[e.breakpoints.down("sm")]:{width:"100%",marginTop:e.spacing(1)}},submitForm:{flexDirection:"row",margin:"10px auto 20px",display:"flex",justifyContent:"center",width:"100%",[e.breakpoints.down("xs")]:{flexDirection:"column"}},mainTitle:{marginBottom:"30px"},title:{marginTop:16,[e.breakpoints.down("md")]:{maxWidth:200},[e.breakpoints.down("sm")]:{width:"100%",maxWidth:"none"}},row:{[e.breakpoints.down("md")]:{alignItems:"center"},[e.breakpoints.down("sm")]:{flexDirection:"column",alignItems:"flex-start",textAlign:"center"}},btnDanger:{marginLeft:20,[e.breakpoints.down("xs")]:{marginLeft:0,marginTop:e.spacing(.5)}},saveAndGoBtn:{marginRight:20,[e.breakpoints.down("xs")]:{marginRight:0,marginBottom:e.spacing(.5)}},toggleIcon:{position:"absolute",top:-15,left:0,backgroundColor:e.palette.primary.main,width:20,height:25,cursor:"pointer",padding:e.spacing(1),borderRadius:"0 5px 5px 0"},switchControl:{paddingTop:e.spacing(1),flexBasis:"60%"},emptyButtons:{height:36,[e.breakpoints.down("sm")]:{height:0}},noRulesText:{fontSize:24,color:e.palette.primary.light}}))(_e),Pe=a(438);class Fe extends s.Component{constructor(...e){super(...e),this.defaultRule={rule:v.a.t("Select rule"),name:v.a.t("New rule"),id:""},this.state={localRule:this.defaultRule,isDisabled:!0},this.setRuleOnMount=()=>{const e=this.props,t=e.isEdit,a=e.selectedRule;t&&this.setState({localRule:a})},this.cleanState=()=>{this.props.isEdit&&this.props.finishEdit(this.state.localRule),this.setState({localRule:this.defaultRule})},this.getAvaliableOptions=()=>{const e=this.props,t=e.commands,a=e.currentRules,s=e.selectedRule,n=e.isEdit,r=null===t||void 0===t?void 0:t.filter(e=>!(e.unique&&a.find(t=>(null===t||void 0===t?void 0:t.rule)===e.rule)));return(null===s||void 0===s?void 0:s.unique)&&n?r.concat(s):r},this.getUniqueName=e=>{var t;const a=(null===(t=this.props.currentRules)||void 0===t?void 0:t.map(e=>null===e||void 0===e?void 0:e.name)).filter(t=>t.slice(0,t.length-2)===e),s=this.props.commands.find(({rule:t,unique:a})=>t===e&&a);if(a.length){let e=a[a.length-1],t=e.slice(e.length-1);return e.slice(0,e.length-1)+ ++t}return s?e:"".concat(e," 1")},this.createForm=()=>{const e=this.state.localRule,t=this.props.classes,a=this.getAvaliableOptions();return n.a.createElement(Pe.a,null,n.a.createElement(X.a,{fullWidth:!0},n.a.createElement(H.a,{shrink:!0,id:"rule"},v.a.t("Rule")),n.a.createElement(J.a,{onChange:t=>this.setState({localRule:Object(O.a)(Object(O.a)({},e),{},{rule:t.target.value,name:this.getUniqueName(t.target.value),isError:""}),isDisabled:t.target.value===this.defaultRule.rule}),value:e.rule,labelId:"rule",className:t.select},null===a||void 0===a?void 0:a.map(e=>n.a.createElement(V.a,{key:e.rule,value:e.rule},e.rule)))),n.a.createElement(K.a,{fullWidth:!0,id:"standard-basic",label:this.state.localRule.isError||v.a.t("Name"),value:e.name,onChange:t=>{var a;const s=null===(a=this.props.currentRules)||void 0===a?void 0:a.map(e=>null===e||void 0===e?void 0:e.name);this.setState({localRule:Object(O.a)(Object(O.a)({},e),{},{name:t.target.value,isError:s.includes(t.target.value)?"".concat(v.a.t("Name already exist")):""})})},error:!!this.state.localRule.isError,className:t.TextField}))},this.setDialogContent=()=>{const e=this.props,t=e.handleClose,a=e.handleSubmitOnCreate,s=e.handleSubmitOnEdit,r=e.isEdit?s:a;return n.a.createElement(Y.a,null,this.createForm(),n.a.createElement(N.a,null,n.a.createElement(q.a,{onClick:r.bind(this,this.state.localRule,this.state.localRule.isError),disabled:this.state.isDisabled},"Ok"),n.a.createElement(q.a,{onClick:t},v.a.t("Cancel"))))}}componentWillUnmount(){this.cleanState()}render(){return n.a.createElement(W.a,{open:this.props.isOpen,onClose:this.props.handleClose,onExited:this.cleanState,onEnter:this.setRuleOnMount,fullWidth:!0},n.a.createElement(P.a,null,v.a.t(this.props.isEdit?"Edit rule":"Create new rule")),this.setDialogContent())}}var Ye=Object(h.a)(e=>({select:{width:"100%",marginBottom:e.spacing(2.5)},TextField:{marginBottom:e.spacing(1)}}))(Fe);class Je extends s.PureComponent{constructor(e){var t;super(e),t=this,this.getSelectedLanguageCommands=()=>{var e,t;const a=(null===(e=this.state)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.language)||v.a.getLanguage();return[{rule:v.a.t("Select rule"),unique:!1},...Object.entries(window.commands).map(e=>{var t,s,n;const r=Object(y.a)(e,2),l=r[0],i=r[1],o=(i.name,Object(k.a)(i,["name"]));return Object(O.a)(Object(O.a)({},o),{},{rule:null===i||void 0===i?void 0:i.name[a],template:l,unique:i.unique,words:i.words&&i.words[a],args:null===(t=i.args)||void 0===t?void 0:t.map(e=>Object(O.a)(Object(O.a)({},e),{},{name:e.name[a]||"",default:e.default||"checkbox"!==e.type&&""})),ack:i.ack&&Object(O.a)(Object(O.a)({},i.ack),{},{name:i.ack.name[a],default:(null===(s=i.ack)||void 0===s?void 0:s.default)?i.ack.default[a]:"checkbox"!==(null===(n=i.ack)||void 0===n?void 0:n.type)&&""})})})]},this.commands=this.getSelectedLanguageCommands(),this.moveRule=(e,t)=>{const a=this.state.currentRules,s=a.find((e,a)=>a===t),n=a.filter((e,a)=>a!==t);n.splice(e,0,s),this.setState({currentRules:n})},this.handleOpen=()=>{this.setState({isOpen:!0})},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleSubmitOnCreate=(e,t)=>{if(t)return;const a=Object(j.a)(),s=Object(O.a)(Object(O.a)({},e),{},{id:a,_break:!0}),n=Object(O.a)(Object(O.a)({},this.commands.find(e=>e.rule===s.rule)),s),r=Object.values(this.state.unsavedRules).length;this.setState({currentRules:[...this.state.currentRules,n],unsavedRules:Object(O.a)(Object(O.a)({},this.state.unsavedRules),{},{[a]:{id:a,wasChangedGlobally:!0}}),selectedRule:r?this.state.selectedRule:n},()=>{r&&this.selectRule(n.id)}),this.handleClose()},this.handleSubmitOnEdit=(e,t)=>{t||(this.setState({unsavedRules:Object(O.a)(Object(O.a)({},this.state.unsavedRules),{},{[e.id]:{id:e.id,wasChangedGlobally:!0}}),currentRules:this.updateCurrentRules(e)}),this.handleClose())},this.selectRule=e=>{const t=this.state,a=t.selectedRule,s=t.currentRules;if(a.id===e);else if(this.state.unsavedRules[a.id])this.setState({pendingSelectedRuleId:e});else{const t=s.find(t=>t.id===e);this.setState({selectedRule:t,isLeftBarOpen:!!this.isMdScreen&&this.state.isLeftBarOpen})}},this.updateCurrentRules=e=>this.state.currentRules.map(t=>t.id===e.id?e:t),this.handleEdit=()=>{this.setState({isEdit:!0}),this.handleOpen()},this.finishEdit=e=>{let t;const a=e.rule,s=e.id,n=e.name,r=e._break,l=e.template;if(this.state.selectedRule.rule!==a){const e=this.commands.find(e=>e.rule===a);t=Object(O.a)(Object(O.a)({},e),{},{name:n,rule:a,id:s,_break:r,template:l})}else t=e;this.setState({isEdit:!1,selectedRule:t})},this.removeRule=e=>{const a=function(){var a=Object(C.a)(w.a.mark((function a(){var s,n,r,l;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.props.readConfig();case 2:s=a.sent,n=s.rules,r=Object(k.a)(s,["rules"]),l=Object(O.a)({rules:n.filter(t=>t.id!==e)},r),t.props.saveConfig(l);case 6:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),s=this.state.currentRules.filter(t=>t.id!==e);this.setState({currentRules:s,selectedRule:s.length?s[s.length-1]:null},a)},this.updateConfig=function(){var e=Object(C.a)(w.a.mark((function e(a){var s,n,r,l,i,o,c,u,d,h;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.state.unsavedRules,n=a.id,s[n],r=Object(k.a)(s,[n].map(b.a)),e.next=3,t.props.readConfig();case 3:return l=e.sent,i=l.rules,o=Object(k.a)(l,["rules"]),c=i.find(e=>e.id===a.id),u=t.updateCurrentRules(a),d=c?i.map(e=>e.id===a.id?t.getRuleShortData(a):e):[...i,t.getRuleShortData(a)],h=Object(O.a)({rules:d},o),e.next=11,t.props.saveConfig(h);case 11:t.setState({selectedRule:a||t.state.selectedRule||null,currentRules:u,unsavedRules:r});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getDataFromConfig=Object(C.a)(w.a.mark((function e(){var a,s,n,r,l;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.props.readConfig();case 2:return a=e.sent,s=a.rules,n=Object(k.a)(a,["rules"]),r=v.a.getLanguage(),l=s.map(e=>{var t,a,s;const n=window.commands[e.template];return Object(O.a)(Object(O.a)({},n),{},{rule:null===n||void 0===n?void 0:n.name[r],ack:Object(O.a)(Object(O.a)({},n.ack),{},{default:e.ack||"checkbox"!==(null===(t=n.ack)||void 0===t?void 0:t.type)&&"",name:null===(a=n.ack)||void 0===a?void 0:a.name[r]}),args:null===(s=n.args)||void 0===s?void 0:s.map((t,a)=>Object(O.a)(Object(O.a)({},t),{},{default:e.args[a]||"checkbox"!==(null===t||void 0===t?void 0:t.type)&&"",name:(null===t||void 0===t?void 0:t.name[r])||""})),name:e.name||(null===n||void 0===n?void 0:n.name[r]),words:e.words,_break:e._break,id:e.id||Object(j.a)(),template:e.template})}),e.next=8,t.setState({currentRules:l,selectedRule:l.find(e=>e.id===localStorage.getItem("selectedRule"))||l[l.length-1]||null,settings:n});case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)}))),this.revertChangesFromConfig=function(){var e=Object(C.a)(w.a.mark((function e(a){var s,n,r,l,i,o,c,u,d,h,m;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state.currentRules,r=t.state.unsavedRules,l=a.id,r[l],i=Object(k.a)(r,[l].map(b.a)),e.next=4,t.props.readConfig();case 4:return o=e.sent,c=o.rules,u=Object(k.a)(o,["rules"]),d=c.find(e=>e.id===a.id),h=null===(s=t.state.unsavedRules[a.id])||void 0===s?void 0:s.wasChangedGlobally,d&&h?m=n.map(e=>{var t;return e.id===d.id?Object(O.a)(Object(O.a)({},e),{},{ack:Object(O.a)(Object(O.a)({},e.ack),{},{default:d.ack||""}),args:null===(t=e.args)||void 0===t?void 0:t.map(e=>Object(O.a)(Object(O.a)({},e),{},{default:d.arg||""})),rule:window.commands[d.template].name[v.a.getLanguage()],words:d.words||"",name:d.name||"",_break:d._break||!0}):e}):d||(m=n.filter(e=>e.id!==a.id)),e.next=11,t.setState({currentRules:m||n,selectedRule:(h?m.find(e=>e.id===a.id):t.state.selectedRule)||null,settings:u,unsavedRules:i});case 11:t.state.currentRules.length!==n.length&&t.setState({selectedRule:t.state.currentRules[t.state.currentRules.length-1]||null});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.saveSettings=function(){var e=Object(C.a)(w.a.mark((function e(a,s){var n,r,l;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.props.readConfig();case 2:return n=e.sent,r=n.rules,t.setState({settings:a}),l=Object(O.a)({rules:r},a),e.next=8,t.props.saveConfig(l);case 8:s();case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.setUnsavedRule=e=>{this.setState({unsavedRules:Object(O.a)(Object(O.a)({},this.state.unsavedRules),{},{[e]:{id:e,wasChangedGlobally:!1}})})},this.removeUnsavedRule=e=>{const t=this.state.unsavedRules,a=(t[e],Object(k.a)(t,[e].map(b.a)));this.setState({unsavedRules:a})},this.getRuleShortData=({_break:e,template:t,words:a,ack:s,args:n,name:r,id:l})=>({words:a||"",ack:(null===s||void 0===s?void 0:s.default)||"",args:(null===n||void 0===n?void 0:n.map(e=>e.default))||[],_break:e,template:t,name:r,id:l}),this.clearStateOnConfirmModalUnmount=e=>{const t=this.state.unsavedRules,a=(t[e],Object(k.a)(t,[e].map(b.a)));this.setState({pendingSelectedRuleId:!1,unsavedRules:a})},this.isLargeScreen=Object(I.c)("lg",this.props.width),this.isMdScreen=Object(I.c)("md",this.props.width),this.isSmScreen=Object(I.c)("sm",this.props.width),this.isMobileScreen=Object(I.c)("xs",this.props.width),this.toggleLeftBar=()=>{window.localStorage.setItem("App.menuHidden",!this.state.isLeftBarOpen),this.setState({isLeftBarOpen:!this.state.isLeftBarOpen})},this.closeDrawer=()=>{this.setState({isLeftBarOpen:!1})},this.menuSize=parseFloat(window.localStorage.getItem("App.menuSize"))||350,this.state={currentRules:[],isOpen:!1,isEdit:!1,selectedRule:null,unsavedRules:{},isLeftBarOpen:"true"===window.localStorage.getItem("App.menuHidden")},this.commands=this.getSelectedLanguageCommands()}componentDidMount(){this.getDataFromConfig().then(e=>{let t=e.rules,a=Object(k.a)(e,["rules"]);const s=t.map(e=>{var t;return e.id&&e.name?e:Object(O.a)(Object(O.a)({},e),{},{id:e.id?e.id:Object(j.a)(),name:e.name?e.name:null===(t=window.commands[e.template])||void 0===t?void 0:t.name[v.a.getLanguage()]})});Me()(t,s)||this.props.saveConfig(Object(O.a)({rules:s},a))}),this.isMdScreen||this.setState({isLeftBarOpen:!0})}componentDidUpdate(e,t){var a,s,n,r,l;if((null===(a=this.state.settings)||void 0===a?void 0:a.language)!==this.state.lang&&(null===(s=this.state.settings)||void 0===s?void 0:s.language)){var i;const e=null===(i=this.state.settings)||void 0===i?void 0:i.language;v.a.setLanguage(e),this.commands=this.getSelectedLanguageCommands()}(null===(n=t.selectedRule)||void 0===n?void 0:n.id)!==(null===(r=this.state.selectedRule)||void 0===r?void 0:r.id)&&(null===(l=t.selectedRule)||void 0===l?void 0:l.id)&&this.state.selectedRule&&localStorage.setItem("selectedRule",this.state.selectedRule.id)}renderModalDialog(){return this.state.isOpen?n.a.createElement(Ye,{key:"modal",commands:this.commands,isEdit:this.state.isEdit,handleSubmitOnCreate:this.handleSubmitOnCreate,handleSubmitOnEdit:this.handleSubmitOnEdit,handleClose:this.handleClose,isOpen:this.state.isOpen,currentRules:this.state.currentRules,selectedRule:this.state.selectedRule,finishEdit:this.finishEdit}):null}render(){console.log(this.state);const e=this.props.classes,t=this.state,a=t.currentRules,s=t.selectedRule,r=t.isLeftBarOpen;return this.isMdScreen?n.a.createElement(n.a.Fragment,null,n.a.createElement(E.a,{key:"splitterLayout",customClassName:Object(D.a)(r?e.hidden:e.opened,e.layout),primaryMinSize:350,primaryIndex:1,secondaryMinSize:350,onSecondaryPaneSizeChange:e=>this.menuSize=parseFloat(e),onDragEnd:()=>{window.localStorage.setItem("App.menuSize",this.menuSize.toString())},secondaryInitialSize:this.menuSize},n.a.createElement(Ie,{handleOpen:this.handleOpen,rules:a,moveRule:this.moveRule,handleEdit:this.handleEdit,selectRule:this.selectRule,selectedRule:s,removeRule:this.removeRule,settings:this.state.settings,socket:this.props.socket,saveSettings:this.saveSettings,theme:this.props.theme,unsavedRules:this.state.unsavedRules,isMdScreen:this.isMdScreen}),this.state.settings?n.a.createElement(We,{selectedRule:s,socket:this.props.socket,updateCurrentRules:this.updateCurrentRules,updateConfig:this.updateConfig,revertChangesFromConfig:this.revertChangesFromConfig,pendingSelectedRuleId:this.state.pendingSelectedRuleId,unsavedRules:this.state.unsavedRules,selectRule:this.selectRule,clearStateOnConfirmModalUnmount:this.clearStateOnConfirmModalUnmount,lang:this.state.settings.language,setUnsavedRule:this.setUnsavedRule,removeUnsavedRule:this.removeUnsavedRule,toggleLeftBar:this.toggleLeftBar,isLeftBarOpen:this.state.isLeftBarOpen,isMdScreen:this.isMdScreen}):null),this.renderModalDialog()):n.a.createElement(n.a.Fragment,null,n.a.createElement(A.a,{anchor:"left",open:this.state.isLeftBarOpen,onClose:this.closeDrawer},n.a.createElement(Ie,{handleOpen:this.handleOpen,rules:a,moveRule:this.moveRule,handleEdit:this.handleEdit,selectRule:this.selectRule,selectedRule:s,removeRule:this.removeRule,settings:this.state.settings,socket:this.props.socket,saveSettings:this.saveSettings,theme:this.props.theme,toggleLeftBar:this.toggleLeftBar,unsavedRules:this.state.unsavedRules,isMdScreen:this.isMdScreen,closeDrawer:this.closeDrawer})),this.state.settings?n.a.createElement(We,{selectedRule:s,socket:this.props.socket,updateConfig:this.updateConfig,revertChangesFromConfig:this.revertChangesFromConfig,pendingSelectedRuleId:this.state.pendingSelectedRuleId,unsavedRules:this.state.unsavedRules,selectRule:this.selectRule,clearStateOnConfirmModalUnmount:this.clearStateOnConfirmModalUnmount,lang:this.state.settings.language,setUnsavedRule:this.setUnsavedRule,removeUnsavedRule:this.removeUnsavedRule,toggleLeftBar:this.toggleLeftBar,isLeftBarOpen:this.state.isLeftBarOpen,isMdScreen:this.isMdScreen}):null,this.renderModalDialog())}}var Ve=Object(h.a)(e=>({layout:{"& .layout-pane:first":{overflow:"hidden"}},hidden:{"& .layout-pane:first-child":{width:"0 !important"},background:e.palette.background.default},opened:{"& .layout-pane-primary":{width:""},overflow:"hidden",background:e.palette.background.default}}))(Object(I.a)()(Je));class Ke extends S.a{constructor(e){super(e),this.translations={en:a(395),de:a(396),ru:a(397),pt:a(398),nl:a(399),fr:a(400),it:a(401),es:a(402),pl:a(403),"zh-cn":a(404)},v.a.setTranslations(this.translations),v.a.setLanguage((navigator.language||navigator.userLanguage||"en").substring(0,2).toLowerCase())}onConnectionReady(){const e={};this.socket.getSystemConfig().then(t=>(e.systemConfig=t,this.readConfig())).then(e=>{console.log(e),this.setState({config:e,ready:!0}),e.language!==v.a.getLanguage()&&e.language&&v.a.setLanguage(e.language)}).catch(e=>this.showError(e))}readConfig(){return this.socket.getObject("system.adapter."+this.adapterName+"."+this.instance).then(e=>{const t=e.native||{};return t.rules=t.rules||[],t.sayitInstance=t.sayitInstance||"",t.language=t.language||"",t.processorId=t.processorId||"",t.processorTimeout=t.processorTimeout||1e3,t})}saveConfig(e){return this.socket.getObject("system.adapter."+this.adapterName+"."+this.instance).then(t=>{if(!Me()(t.native,e))return t.native=e,this.socket.setObject("system.adapter."+this.adapterName+"."+this.instance,t)})}render(){return this.state.config?n.a.createElement(c.a,{theme:this.state.theme},n.a.createElement("div",{className:"App"},n.a.createElement(Ve,{theme:this.state.theme,socket:this.socket,readConfig:this.readConfig.bind(this),saveConfig:this.saveConfig.bind(this)}),this.renderError())):n.a.createElement(c.a,{theme:this.state.theme},n.a.createElement(p.a,{theme:this.state.themeType}))}}var qe=Object(h.a)(e=>({root:{},logo:{width:32,height:32,padding:e.spacing(1),display:"inline-block"}}))(Ke),Ge=a(217),He=a(209),Xe=a.n(He),Ze=a(91),$e=a.n(Ze);window.adapterName="text2command";let Qe=$e.a.getThemeName();console.log("iobroker."+window.adapterName+"@"+Ge.a+' using theme "'+Qe+'"'),"localhost:3000"!==window.location.host&&i.a({dsn:"https://9806f910556240219f831ecfe2ee3ad1@sentry.iobroker.net/87",release:"iobroker."+window.adapterName+"@"+Ge.a,integrations:[new o.a]}),function e(){return l.a.render(n.a.createElement(c.a,{theme:Xe()(Qe)},n.a.createElement(qe,{onThemeChange:t=>{Qe=t,e()}})),document.getElementById("root"))}(),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat(".","/service-worker.js");u?(!function(e,t){fetch(e).then(a=>{const s=a.headers.get("content-type");404===a.status||null!=s&&-1===s.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):d(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):d(t,e)})}}()}},[[347,1,2]]]);
//# sourceMappingURL=main.55ecfb8e.chunk.js.map