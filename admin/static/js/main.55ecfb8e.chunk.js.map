{"version":3,"sources":["serviceWorker.js","components/Rule.js","components/LeftBar.js","components/RightBar.js","components/CreateRuleDialog.js","components/Layout.js","App.js","index.js"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","Rule","React","forwardRef","props","ref","name","handleEdit","rule","isDragging","connectDragSource","connectDropTarget","id","selectRule","selectedRule","_break","matchingRules","unsavedRules","index","theme","removeMatched","words","classes","makeStyles","listItem","cursor","transition","position","listItemText","color","palette","text","primary","secondary","textOverflow","overflow","dot","backgroundColor","top","right","width","height","borderRadius","maximize","dark","marginBottom","spacing","elementRef","useRef","opacity","useImperativeHandle","getNode","current","selectRuleMemo","useCallback","handleEditMemo","icons","icon","className","handleClick","useState","bg","setBg","useEffect","length","matchingRule","find","item","indexOf","setTimeout","timer","background","default","style","ListItem","onClick","selected","ListItemText","ListItemIcon","Children","toArray","map","IconButton","disabled","Box","ItemTypes","DropTarget","hover","monitor","component","node","dragIndex","getItem","hoverIndex","hoverBoundingRect","getBoundingClientRect","hoverMiddleY","bottom","hoverClientY","getClientOffset","y","moveRule","connect","dropTarget","DragSource","beginDrag","dragSource","CustomTooltip","withStyles","tooltip","fontSize","Tooltip","LeftBar","Component","textCommand","isSettingsDialogOpen","isConfirmRemoveDialogOpen","isSearchActive","filteredRules","searchedValue","localSettings","language","processorId","processorTimeout","sayitInstance","getDefaultSettings","this","setState","settings","handleTextCommand","event","target","value","handleSubmit","iconPlay","key","matched","findMatchingRules","number","handleOpenSettingsModal","handleDialogSelectIdSubmit","selectedSettingsName","handleDelete","removeRule","handleCloseConfirmRemoveDialog","handleSearch","matchedRules","rules","filter","toLowerCase","includes","toggleSearch","a","createSettingsModal","t","I18n","handleClose","isSettingsWasNotSaved","handleChange","Dialog","open","onClose","fullWidth","onExited","DialogTitle","Typography","variant","align","DialogContent","noValidate","autoComplete","FormControl","root","settingsItem","InputLabel","Select","width100","onChange","MenuItem","option","TextField","label","showDialogSelectId","helperText","e","DialogActions","Button","saveSettings","mainIcons","handler","handleOpen","createIcons","iconsData","title","componentDidUpdate","prevProps","prevState","findMatched","JSON","parse","stringify","renderSelectIdDialog","socket","onOk","renderConfirmDialog","render","isMdScreen","closeDrawer","settingsDialog","renderedRules","additionalIcons","push","main","Toolbar","toolbar","search","InputProps","endAdornment","undefined","autoFocus","closeBtn","DndProvider","backend","HTML5Backend","List","list","test","size","clsx","onKeyDown","inputProps","padding","play","boxSizing","minWidth","overflowX","overflowY","header","minHeight","border","divider","textInput","breakpoints","down","settingsTitle","maxWidth","settingsContent","flexDirection","display","common","white","flexBasis","RightBar","PureComponent","defaultState","editable","args","ack","localRule","showDialog","createConfirmModalActions","updateConfig","pendingSelectedRuleId","clearStateOnConfirmModalUnmount","revertChangesFromConfig","cancelSavingChanges","closeConfirmDialog","dontSaveAndGo","handleSaveAndGo","submitForm","saveAndGoBtn","btnDanger","createSaveSettingsForm","handleSave","isLocalStateWasUpdated","revertChanges","emptyButtons","confirmChanges","createInput","type","note","keywords","onSwitchChange","textField","switchControl","Switch","checked","createOptionsData","handlers","keywordsText","breakOnSwitch","handleSetDialogClick","bind","param1OnSwitch","param2Text","confirmText","confirmOnSwitch","createInputHandlers","_this","arg","unsavedRule","isEqual","wasChangedGlobally","removeUnsavedRule","setUnsavedRule","lang","forceUpdate","componentDidMount","isLeftBarHidden","toggleLeftBar","mt","box","Paper","container","mx","mainTitle","justifyContent","mb","row","noRulesText","toggleIcon","marginTop","margin","alignItems","textAlign","marginLeft","marginRight","left","paddingTop","light","CreateRuleDialog","defaultRule","isDisabled","setRuleOnMount","isEdit","cleanState","finishEdit","getAvaliableOptions","commands","currentRules","uniqueOptions","unique","concat","getUniqueName","ruleName","matchingNames","slice","isUnique","lastChar","createForm","FormGroup","shrink","isError","labelId","select","existingNames","setDialogContent","handleSubmitOnCreate","handleSubmitOnEdit","onSubmitHandler","componentWillUnmount","isOpen","onEnter","Layout","constructor","super","getSelectedLanguageCommands","getLanguage","Object","entries","command","rest","template","sourceRule","_","sortRules","splice","uuid","shortDataRule","isUnsavedChanges","values","updateCurrentRules","isLeftBarOpen","editableRule","updatedRule","updatedRuleOptions","deleteRuleFromConfig","readConfig","newConfig","saveConfig","updatedRules","currentSelectedRule","ids","updatedCurrentRules","getRuleShortData","getDataFromConfig","rulesFullData","obj","localStorage","isRuleWasUpdatedGlobally","localeSettings","closeModal","isLargeScreen","isWidthUp","isSmScreen","isMobileScreen","setItem","menuSize","parseFloat","rulesWithId","setLanguage","renderModalDialog","customClassName","hidden","opened","layout","primaryMinSize","primaryIndex","secondaryMinSize","onSecondaryPaneSizeChange","onDragEnd","toString","secondaryInitialSize","Drawer","anchor","withWidth","App","GenericApp","translations","en","require","de","ru","pt","nl","fr","it","es","pl","setTranslations","userLanguage","substring","onConnectionReady","newState","getSystemConfig","systemConfig","ready","showError","getObject","adapterName","instance","native","setObject","renderError","themeType","logo","themeName","Utils","getThemeName","version","host","Sentry","dsn","release","integrations","SentryIntegrations","build","ReactDOM","onThemeChange","_theme","document","getElementById","URL","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.55ecfb8e.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read http://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n\twindow.location.hostname === \"localhost\" ||\r\n\t\t// [::1] is the IPv6 localhost address.\r\n\t\twindow.location.hostname === \"[::1]\" ||\r\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\r\n\t\twindow.location.hostname.match(\r\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n\t\t)\r\n);\r\n\r\nexport function register(config) {\r\n\tif (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\r\n\t\t// The URL constructor is available in all browsers that support SW.\r\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n\t\tif (publicUrl.origin !== window.location.origin) {\r\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\r\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\r\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\twindow.addEventListener(\"load\", () => {\r\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n\t\t\tif (isLocalhost) {\r\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\r\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\r\n\r\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\r\n\t\t\t\t// service worker/PWA documentation.\r\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\r\n\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\"This web app is being served cache-first by a service \" +\r\n\t\t\t\t\t\t\t\"worker. To learn more, visit http://bit.ly/CRA-PWA\"\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Is not localhost. Just register service worker\r\n\t\t\t\tregisterValidSW(swUrl, config);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n\tnavigator.serviceWorker\r\n\t\t.register(swUrl)\r\n\t\t.then(registration => {\r\n\t\t\tregistration.onupdatefound = () => {\r\n\t\t\t\tconst installingWorker = registration.installing;\r\n\t\t\t\tif (installingWorker == null) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tinstallingWorker.onstatechange = () => {\r\n\t\t\t\t\tif (installingWorker.state === \"installed\") {\r\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\r\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\r\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\r\n\t\t\t\t\t\t\t// content until all client tabs are closed.\r\n\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t\"New content is available and will be used when all \" +\r\n\t\t\t\t\t\t\t\t\t\"tabs for this page are closed. See http://bit.ly/CRA-PWA.\"\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t// Execute callback\r\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\r\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// At this point, everything has been precached.\r\n\t\t\t\t\t\t\t// It's the perfect time to display a\r\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\r\n\t\t\t\t\t\t\tconsole.log(\"Content is cached for offline use.\");\r\n\r\n\t\t\t\t\t\t\t// Execute callback\r\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\r\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\t})\r\n\t\t.catch(error => {\r\n\t\t\tconsole.error(\"Error during service worker registration:\", error);\r\n\t\t});\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n\t// Check if the service worker can be found. If it can't reload the page.\r\n\tfetch(swUrl)\r\n\t\t.then(response => {\r\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\r\n\t\t\tconst contentType = response.headers.get(\"content-type\");\r\n\t\t\tif (\r\n\t\t\t\tresponse.status === 404 ||\r\n\t\t\t\t(contentType != null && contentType.indexOf(\"javascript\") === -1)\r\n\t\t\t) {\r\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\r\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\r\n\t\t\t\t\tregistration.unregister().then(() => {\r\n\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Service worker found. Proceed as normal.\r\n\t\t\t\tregisterValidSW(swUrl, config);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(() => {\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"No internet connection found. App is running in offline mode.\"\r\n\t\t\t);\r\n\t\t});\r\n}\r\n\r\nexport function unregister() {\r\n\tif (\"serviceWorker\" in navigator) {\r\n\t\tnavigator.serviceWorker.ready.then(registration => {\r\n\t\t\tregistration.unregister();\r\n\t\t});\r\n\t}\r\n}\r\n","import React, {\r\n    useRef,\r\n    useImperativeHandle,\r\n    useCallback,\r\n    Children,\r\n    useState,\r\n    useEffect,\r\n} from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport { ListItemIcon, IconButton, Box } from '@material-ui/core';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\nimport MaximizeIcon from '@material-ui/icons/Maximize';\r\n\r\nimport { DropTarget, DragSource } from 'react-dnd';\r\n\r\nconst Rule = React.forwardRef((props, ref) => {\r\n    const {\r\n        name,\r\n        handleEdit,\r\n        rule,\r\n        isDragging,\r\n        connectDragSource,\r\n        connectDropTarget,\r\n        id,\r\n        selectRule,\r\n        selectedRule,\r\n        _break,\r\n        matchingRules,\r\n        unsavedRules,\r\n        index,\r\n        theme,\r\n        removeMatched,\r\n        words,\r\n    } = props;\r\n\r\n    const classes = makeStyles({\r\n        listItem: {\r\n            cursor: 'pointer',\r\n            transition: 'background-color 0.3s linear',\r\n            position: 'relative',\r\n        },\r\n        listItemText: {\r\n            '& span': {\r\n                color: theme.palette.text.primary,\r\n            },\r\n            '& p': {\r\n                color: theme.palette.text.secondary,\r\n                textOverflow: 'ellipsis',\r\n                overflow: 'hidden',\r\n            },\r\n        },\r\n        dot: {\r\n            position: 'absolute',\r\n            backgroundColor: 'red',\r\n            top: 5,\r\n            right: 15,\r\n            width: 10,\r\n            height: 10,\r\n            borderRadius: '50%',\r\n        },\r\n        maximize: {\r\n            color: theme.palette.error?.dark,\r\n            marginBottom: -theme.spacing(2),\r\n        },\r\n    })();\r\n\r\n    const elementRef = useRef(null);\r\n    connectDragSource(elementRef);\r\n    connectDropTarget(elementRef);\r\n    const opacity = isDragging ? 0 : 1;\r\n    useImperativeHandle(ref, () => ({\r\n        getNode: () => elementRef.current,\r\n    }));\r\n\r\n    const selectRuleMemo = useCallback(() => selectRule(id), [id, selectRule]);\r\n    const handleEditMemo = useCallback(() => handleEdit(id), [id, handleEdit]);\r\n\r\n    const icons = [\r\n        {\r\n            icon: _break ? (\r\n                <MaximizeIcon className={classes.maximize} />\r\n            ) : (\r\n                <ArrowDownwardIcon color=\"primary\" />\r\n            ),\r\n        },\r\n        { icon: <EditIcon />, handleClick: handleEditMemo },\r\n    ];\r\n\r\n    const [bg, setBg] = useState('');\r\n\r\n    useEffect(() => {\r\n        if (matchingRules.length) {\r\n            const matchingRule = matchingRules.find(item => item.indexOf === index);\r\n            if (matchingRule) {\r\n                setTimeout(() => setBg(theme?.palette?.secondary.dark), matchingRule.timer);\r\n                setTimeout(() => {\r\n                    setBg(selectedRule.id === id ? theme?.palette?.background?.default : '');\r\n                    if (_break || index === matchingRules[matchingRules.length - 1].indexOf) removeMatched();\r\n                }, 1500 * (matchingRule.index + 1));\r\n            } // only when matching rules have been changed\r\n        } // eslint-disable-next-line\r\n    }, [matchingRules]);\r\n\r\n    let secondary = rule !== name ? rule : '';\r\n    secondary += `${secondary ? ' ' : ''}[${words}]`;\r\n    return (\r\n        <div\r\n            ref={elementRef}\r\n            style={{\r\n                opacity,\r\n                backgroundColor: bg,\r\n            }}>\r\n            <ListItem\r\n                onClick={selectRuleMemo}\r\n                selected={selectedRule?.id === id}\r\n                className={classes.listItem}>\r\n                <ListItemText\r\n                    primary={name}\r\n                    secondary={secondary}\r\n                    className={classes.listItemText}\r\n                />\r\n                <ListItemIcon>\r\n                    {Children.toArray(\r\n                        icons.map(({ icon, handleClick }, index) => (\r\n                            <IconButton disabled={!index} onClick={handleClick}>\r\n                                {icon}\r\n                            </IconButton>\r\n                        ))\r\n                    )}\r\n                </ListItemIcon>\r\n                {unsavedRules[id] && <Box className={classes.dot} />}\r\n            </ListItem>\r\n        </div>\r\n    );\r\n});\r\n\r\nconst ItemTypes = {\r\n    RULE: 'rule',\r\n};\r\n\r\nexport default DropTarget(\r\n    ItemTypes.RULE,\r\n    {\r\n        hover(props, monitor, component) {\r\n            if (!component) return null;\r\n\r\n            const node = component.getNode();\r\n            if (!node) {\r\n                return null;\r\n            }\r\n            const dragIndex = monitor.getItem().index;\r\n            const hoverIndex = props.index;\r\n            if (dragIndex === hoverIndex) return;\r\n\r\n            const hoverBoundingRect = node.getBoundingClientRect();\r\n            const hoverMiddleY = (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\r\n            const clientOffset = monitor.getClientOffset();\r\n            const hoverClientY = clientOffset.y - hoverBoundingRect.top;\r\n            if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\r\n                return;\r\n            }\r\n            if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\r\n                return;\r\n            }\r\n            props.moveRule(dragIndex, hoverIndex);\r\n\r\n            monitor.getItem().index = hoverIndex;\r\n        },\r\n    },\r\n    connect => ({ connectDropTarget: connect.dropTarget() })\r\n)(\r\n    DragSource(\r\n        ItemTypes.RULE,\r\n        {\r\n            beginDrag: props => ({\r\n                id: props.id,\r\n                index: props.index,\r\n            }),\r\n        },\r\n        (connect, monitor) => ({\r\n            connectDragSource: connect.dragSource(),\r\n            isDragging: monitor.isDragging(),\r\n        })\r\n    )(Rule)\r\n);\r\n\r\nRule.propTypes = {\r\n    removeRule: PropTypes.func,\r\n    name: PropTypes.string.isRequired,\r\n    theme: PropTypes.object.isRequired,\r\n    isDragging: PropTypes.bool,\r\n    connectDropTarget: PropTypes.func,\r\n    connectDragTarget: PropTypes.func,\r\n    _break: PropTypes.bool.isRequired,\r\n    selectRule: PropTypes.func.isRequired,\r\n    id: PropTypes.string.isRequired,\r\n    matchingRules: PropTypes.array,\r\n    selectedRule: PropTypes.shape({\r\n        id: PropTypes.string,\r\n    }),\r\n    unsavedRules: PropTypes.object,\r\n};\r\n","import React, { Component, Children } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport clsx from 'clsx';\r\nimport { DndProvider } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend';\r\n\r\n// Material UI Components\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport List from '@material-ui/core/List';\r\nimport {\r\n    TextField,\r\n    Typography,\r\n    Box,\r\n    withStyles,\r\n    Dialog,\r\n    DialogTitle,\r\n    DialogContent,\r\n    Button,\r\n    Select,\r\n    MenuItem,\r\n} from '@material-ui/core';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport FormControl from '@material-ui/core/FormControl';\r\n\r\n// icons\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport CachedIcon from '@material-ui/icons/Cached';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport FormatClearIcon from '@material-ui/icons/FormatClear';\r\nimport ClearIcon from '@material-ui/icons/Close';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\r\n\r\nimport Rule from './Rule';\r\n\r\nconst styles = theme => ({\r\n    test: {\r\n        width: '100%',\r\n        boxSizing: 'border-box',\r\n        height: 64,\r\n    },\r\n    main: {\r\n        minWidth: 330,\r\n        overflow: 'hidden',\r\n        height: '100%',\r\n    },\r\n    toolbar: {\r\n        background: theme.palette.primary.main,\r\n        position: 'relative',\r\n    },\r\n    list: {\r\n        height: 'calc(100% - 64px - 64px - 18px)',\r\n        overflowX: 'hidden',\r\n        overflowY: 'auto',\r\n    },\r\n    root: {\r\n        width: 'calc(100% - 48px)',\r\n        // '& .MuiInputLabel-outlined-70.MuiInputLabel-marginDense-66': {\r\n        //     transform: '',\r\n        // },\r\n    },\r\n    header: {\r\n        minHeight: 44,\r\n        height: 'auto',\r\n        padding: theme.spacing(1.3),\r\n        border: `1px solid ${theme.palette.divider}`,\r\n    },\r\n    textInput: {\r\n        width: '60%',\r\n        [theme.breakpoints.down('sm')]: {\r\n            width: '100%',\r\n        },\r\n    },\r\n    settingsTitle: {\r\n        fontSize: '20px',\r\n        maxWidth: 145,\r\n        [theme.breakpoints.down('sm')]: {\r\n            marginBottom: theme.spacing(1),\r\n        },\r\n    },\r\n    settingsContent: {\r\n        [theme.breakpoints.down('sm')]: {\r\n            flexDirection: 'column',\r\n            display: 'flex',\r\n        },\r\n    },\r\n    closeBtn: {\r\n        position: 'absolute',\r\n        top: 0,\r\n        right: 0,\r\n        color: theme.palette.common.white,\r\n    },\r\n    search: {\r\n        flexBasis: '80%',\r\n        [theme.breakpoints.down('sm')]: {\r\n            flexBasis: '70%',\r\n        },\r\n    },\r\n    settingsItem: {\r\n        marginBottom: theme.spacing(3),\r\n    },\r\n    width100: {\r\n        width: '100%',\r\n    },\r\n});\r\n\r\nconst tooltipStyles = theme => ({\r\n    tooltip: {\r\n        fontSize: 14,\r\n    },\r\n});\r\n\r\nconst CustomTooltip = withStyles(tooltipStyles)(Tooltip);\r\n\r\nclass LeftBar extends Component {\r\n    state = {\r\n        textCommand: '',\r\n        matchingRules: [],\r\n        isSettingsDialogOpen: false,\r\n        isConfirmRemoveDialogOpen: false,\r\n        isSearchActive: false,\r\n        filteredRules: [],\r\n        searchedValue: '',\r\n        localSettings: {\r\n            language: '',\r\n            processorId: '',\r\n            processorTimeout: 1000,\r\n            sayitInstance: '',\r\n        },\r\n    };\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.settings !== prevProps.settings && this.props.settings) {\r\n            this.getDefaultSettings();\r\n        }\r\n    }\r\n\r\n    getDefaultSettings = () => {\r\n        this.setState({\r\n            localSettings: {\r\n                ...this.props.settings,\r\n            },\r\n        });\r\n    };\r\n\r\n    handleTextCommand = event => {\r\n        this.setState({\r\n            textCommand: event.target.value,\r\n        });\r\n    };\r\n\r\n    handleSubmit = (event, iconPlay) => {\r\n        if (event.key === 'Enter' || iconPlay) {\r\n            const matched = this.findMatchingRules();\r\n            this.setState({\r\n                matchingRules: matched.map((number, index) => ({\r\n                    indexOf: number,\r\n                    timer: index * 1500,\r\n                    index,\r\n                })),\r\n            });\r\n        }\r\n    };\r\n\r\n    removeMatched = () => {\r\n        this.setState({\r\n            matchingRules: [],\r\n        });\r\n    };\r\n\r\n    findMatchingRules() {\r\n        const text = this.state.textCommand;\r\n        return text ? window.findMatched(text, JSON.parse(JSON.stringify(this.props.rules))) : [];\r\n    }\r\n\r\n    handleOpenSettingsModal = () => {\r\n        this.setState({\r\n            isSettingsDialogOpen: true,\r\n        });\r\n    };\r\n\r\n    handleDialogSelectIdSubmit = (selected, selectedSettingsName) => {\r\n        this.setState({\r\n            localSettings: {\r\n                ...this.state.localSettings,\r\n                [selectedSettingsName]: selected,\r\n            },\r\n        });\r\n    };\r\n\r\n    handleDelete = () => {\r\n        this.props.removeRule(this.props.selectedRule.id);\r\n        this.handleCloseConfirmRemoveDialog();\r\n    };\r\n\r\n    handleCloseConfirmRemoveDialog = () => {\r\n        this.setState({\r\n            isConfirmRemoveDialogOpen: false,\r\n        });\r\n    };\r\n\r\n    handleSearch = event => {\r\n        const matchedRules = this.props.rules.filter(rule =>\r\n            rule.name.toLowerCase().includes(event.target.value.toLowerCase())\r\n        );\r\n        this.setState({\r\n            filteredRules: matchedRules || [],\r\n            searchedValue: event.target.value,\r\n        });\r\n    };\r\n\r\n    toggleSearch = async () => {\r\n        await this.setState({\r\n            isSearchActive: !this.state.isSearchActive,\r\n        });\r\n    };\r\n\r\n    createSettingsModal = () => {\r\n        const { t } = I18n;\r\n        const options = ['en', 'de', 'ru'];\r\n        const { classes } = this.props;\r\n\r\n        const handleClose = () => {\r\n            this.setState({\r\n                isSettingsDialogOpen: false,\r\n                isSettingsWasNotSaved: true,\r\n            });\r\n        };\r\n\r\n        const submitSettings = () => {\r\n            this.props.saveSettings(this.state.localSettings, handleClose);\r\n        };\r\n\r\n        const handleChange = (event, name) => {\r\n            let value = event.target.value;\r\n            if (name === 'language' && value === 'system') {\r\n                value = '';\r\n            }\r\n\r\n            this.setState({\r\n                localSettings: {\r\n                    ...this.state.localSettings,\r\n                    [name]: value,\r\n                },\r\n            });\r\n        };\r\n\r\n        return (\r\n            <Dialog\r\n                open={this.state.isSettingsDialogOpen}\r\n                onClose={handleClose}\r\n                fullWidth\r\n                onExited={this.getDefaultSettings}>\r\n                <DialogTitle>\r\n                    <Typography variant=\"h4\" component=\"span\" align=\"center\">\r\n                        {t('Settings')}\r\n                    </Typography>\r\n                </DialogTitle>\r\n                <DialogContent>\r\n                    <form noValidate autoComplete=\"off\">\r\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\r\n                            <InputLabel id=\"demo-simple-select-label\">{t('Language')}</InputLabel>\r\n                            <Select\r\n                                classes={{ root: classes.width100 }}\r\n                                onChange={event => handleChange(event, 'language')}\r\n                                value={\r\n                                    !this.state.localSettings.language\r\n                                        ? 'system'\r\n                                        : this.state.localSettings.language\r\n                                }>\r\n                                <MenuItem value=\"system\">{t('System')}</MenuItem>\r\n                                {Children.toArray(\r\n                                    options.map(option => (\r\n                                        <MenuItem value={option}>{t('lang_' + option)}</MenuItem>\r\n                                    ))\r\n                                )}\r\n                            </Select>\r\n                        </FormControl>\r\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\r\n                            <TextField\r\n                                label={t('Answer in id')}\r\n                                value={this.state.localSettings.sayitInstance}\r\n                                onClick={() =>\r\n                                    this.setState({\r\n                                        showDialogSelectId: true,\r\n                                        selectedSettingsName: 'sayitInstance',\r\n                                    })\r\n                                }\r\n                            />\r\n                        </FormControl>\r\n\r\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\r\n                            <TextField\r\n                                label={t(`Processor's id`)}\r\n                                value={this.state.localSettings.processorId}\r\n                                onClick={() =>\r\n                                    this.setState({\r\n                                        showDialogSelectId: true,\r\n                                        selectedSettingsName: 'processorId',\r\n                                    })\r\n                                }\r\n                            />\r\n                        </FormControl>\r\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\r\n                            <TextField\r\n                                label={t('Timeout for processor')}\r\n                                helperText={t('ms')}\r\n                                value={this.state.localSettings.processorTimeout}\r\n                                onChange={e => handleChange(e, 'processorTimeout')}\r\n                            />\r\n                        </FormControl>\r\n                    </form>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={submitSettings}>Ok</Button>\r\n                    <Button onClick={handleClose}>{I18n.t('Cancel')}</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    };\r\n\r\n    mainIcons = [\r\n        {\r\n            icon: <AddIcon />,\r\n            handler: () => this.props.handleOpen(),\r\n            tooltip: I18n.t('Create rule'),\r\n        },\r\n        {\r\n            icon: <SettingsIcon />,\r\n            handler: () => this.handleOpenSettingsModal(),\r\n            tooltip: I18n.t('Settings'),\r\n        },\r\n        {\r\n            icon: <CachedIcon />,\r\n            handler: () => console.log('refresh'),\r\n            tooltip: I18n.t('Refresh'),\r\n        },\r\n    ];\r\n\r\n    createIcons = iconsData =>\r\n        iconsData.map(({ icon, handler, tooltip }, index) => (\r\n            <CustomTooltip title={tooltip} key={index}>\r\n                <IconButton onClick={handler}>{icon}</IconButton>\r\n            </CustomTooltip>\r\n        ));\r\n\r\n    renderSelectIdDialog() {\r\n        return this.state.showDialogSelectId ? (\r\n            <DialogSelectID\r\n                socket={this.props.socket}\r\n                title={'Select ID'}\r\n                onClose={() => this.setState({ showDialogSelectId: false })}\r\n                onOk={selected =>\r\n                    this.handleDialogSelectIdSubmit(selected, this.state.selectedSettingsName)\r\n                }\r\n            />\r\n        ) : null;\r\n    }\r\n\r\n    renderConfirmDialog() {\r\n        return this.state.isConfirmRemoveDialogOpen ? (\r\n            <Dialog\r\n                open={this.state.isConfirmRemoveDialogOpen}\r\n                onClose={this.handleCloseConfirmRemoveDialog}\r\n                fullWidth>\r\n                <DialogTitle>{I18n.t('Are you sure?')}</DialogTitle>\r\n                <DialogContent>\r\n                    <Typography variant=\"h5\" component=\"h5\">\r\n                        {I18n.t('You want to delete') + ': '}\r\n                        <strong>{this.props.selectedRule.name}</strong>\r\n                    </Typography>\r\n                    <DialogActions>\r\n                        <Button onClick={this.handleDelete}>{I18n.t('Ok')}</Button>\r\n                        <Button onClick={this.handleCloseConfirmRemoveDialog} color=\"primary\">\r\n                            {I18n.t('Cancel')}\r\n                        </Button>\r\n                    </DialogActions>\r\n                </DialogContent>\r\n            </Dialog>\r\n        ) : null;\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            selectedRule,\r\n            moveRule,\r\n            handleEdit,\r\n            rules,\r\n            selectRule,\r\n            classes,\r\n            isMdScreen,\r\n            closeDrawer,\r\n        } = this.props;\r\n        const { filteredRules, isSearchActive, searchedValue } = this.state;\r\n        const settingsDialog = this.createSettingsModal();\r\n        const renderedRules = isSearchActive && searchedValue.length ? filteredRules : rules;\r\n        const additionalIcons = [];\r\n\r\n        selectedRule &&\r\n            selectedRule.id &&\r\n            additionalIcons.push({\r\n                icon: !isSearchActive && <DeleteIcon />,\r\n                handler: () =>\r\n                    this.setState({\r\n                        isConfirmRemoveDialogOpen: true,\r\n                    }),\r\n                tooltip: I18n.t('Remove rule'),\r\n                key: 'delete',\r\n            });\r\n        rules.length &&\r\n            additionalIcons.push({\r\n                icon: isSearchActive ? <FormatClearIcon /> : <SearchIcon />,\r\n                handler: () => this.toggleSearch(),\r\n                tooltip: I18n.t('Search rule'),\r\n                key: 'search',\r\n            });\r\n\r\n        return (\r\n            <Box className={classes.main}>\r\n                <Toolbar position=\"static\" classes={{ root: classes.toolbar }}>\r\n                    {isSearchActive ? (\r\n                        <TextField\r\n                            className={classes.search}\r\n                            onChange={this.handleSearch}\r\n                            value={this.state.searchedValue}\r\n                            InputProps={{\r\n                                endAdornment: this.state.searchedValue ? (\r\n                                    <IconButton\r\n                                        onClick={() => this.setState({ searchedValue: '' })}>\r\n                                        <ClearIcon />\r\n                                    </IconButton>\r\n                                ) : undefined,\r\n                            }}\r\n                            autoFocus\r\n                        />\r\n                    ) : (\r\n                        <div>{this.createIcons(this.mainIcons)}</div>\r\n                    )}\r\n                    <div>{this.createIcons(additionalIcons)}</div>\r\n                    {!isMdScreen && (\r\n                        <IconButton className={classes.closeBtn} onClick={closeDrawer}>\r\n                            <CloseIcon />\r\n                        </IconButton>\r\n                    )}\r\n                </Toolbar>\r\n\r\n                <DndProvider backend={HTML5Backend}>\r\n                    <List className={classes.list}>\r\n                        {renderedRules.map((rule, index) => (\r\n                            <Rule\r\n                                theme={this.props.theme}\r\n                                handleEdit={handleEdit}\r\n                                {...rule}\r\n                                index={index}\r\n                                moveRule={moveRule}\r\n                                key={rule.id}\r\n                                selectRule={selectRule}\r\n                                selectedRule={selectedRule}\r\n                                matchingRules={this.state.matchingRules}\r\n                                unsavedRules={this.props.unsavedRules}\r\n                                removeMatched={this.removeMatched}\r\n                            />\r\n                        ))}\r\n                    </List>\r\n                </DndProvider>\r\n\r\n                <Toolbar className={classes.test} variant=\"dense\">\r\n                    <TextField\r\n                        onChange={this.handleTextCommand}\r\n                        label={I18n.t('Test phrase')}\r\n                        variant=\"outlined\"\r\n                        size=\"small\"\r\n                        color=\"primary\"\r\n                        className={clsx('outlined-basic', classes.root)}\r\n                        onKeyDown={this.handleSubmit}\r\n                        value={this.state.textCommand}\r\n                        inputProps={{\r\n                            style: {\r\n                                padding: '10px 10px',\r\n                            },\r\n                        }}\r\n                        InputProps={{\r\n                            endAdornment: this.state.textCommand ? (\r\n                                <IconButton onClick={() => this.setState({ textCommand: '' })}>\r\n                                    <ClearIcon />\r\n                                </IconButton>\r\n                            ) : undefined,\r\n                        }}\r\n                    />\r\n                    <IconButton\r\n                        variant=\"outlined\"\r\n                        onClick={event => this.handleSubmit(event, true)}>\r\n                        <PlayArrowIcon className={classes.play} />\r\n                    </IconButton>\r\n                </Toolbar>\r\n\r\n                {settingsDialog}\r\n\r\n                {this.renderConfirmDialog()}\r\n\r\n                {this.renderSelectIdDialog()}\r\n            </Box>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(LeftBar);\r\n\r\nLeftBar.propTypes = {\r\n    handleOpen: PropTypes.func.isRequired,\r\n    rules: PropTypes.arrayOf(\r\n        PropTypes.shape({\r\n            id: PropTypes.string,\r\n        })\r\n    ),\r\n    moveRule: PropTypes.func.isRequired,\r\n    selectRule: PropTypes.func.isRequired,\r\n    theme: PropTypes.object.isRequired,\r\n    selectedRule: PropTypes.shape({\r\n        id: PropTypes.string,\r\n    }),\r\n    removeRule: PropTypes.func,\r\n    handleEdit: PropTypes.func.isRequired,\r\n    classes: PropTypes.object.isRequired,\r\n    settings: PropTypes.object,\r\n    socket: PropTypes.object.isRequired,\r\n    saveSettings: PropTypes.func.isRequired,\r\n    unsavedRules: PropTypes.object,\r\n    toggleLeftBar: PropTypes.func,\r\n    isMdScreen: PropTypes.bool.isRequired,\r\n    closeDrawer: PropTypes.func,\r\n};\r\n","import React, { PureComponent } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport clsx from 'clsx';\r\n\r\nimport { TextField, Switch, Typography, withStyles, Box } from '@material-ui/core';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Button from '@material-ui/core/Button';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\r\nimport isEqual from 'lodash.isequal';\r\n\r\nconst styles = theme => ({\r\n    box: {\r\n        display: 'inline-flex',\r\n        justifyContent: 'space-around',\r\n        padding: theme.spacing(2),\r\n        width: 'calc(100% - ' + theme.spacing(4) + 'px)',\r\n        position: 'relative',\r\n        '& .outlined-basic': {\r\n            padding: '12px 10px',\r\n            //border: `2px solid ${theme.palette.grey[700]}`,\r\n        },\r\n        [theme.breakpoints.down('md')]: {\r\n            '& .outlined-basic': {\r\n                padding: 0,\r\n            },\r\n        },\r\n    },\r\n    container: {\r\n        width: '70%',\r\n        // minWidth: 340,\r\n        padding: theme.spacing(2),\r\n        [theme.breakpoints.down('md')]: {\r\n            width: '90%',\r\n        },\r\n        [theme.breakpoints.down('lg')]: {\r\n            width: '80%',\r\n        },\r\n    },\r\n    textField: {\r\n        flexBasis: '60%',\r\n        [theme.breakpoints.down('sm')]: {\r\n            width: '100%',\r\n            marginTop: theme.spacing(1),\r\n        },\r\n    },\r\n    submitForm: {\r\n        flexDirection: 'row',\r\n        margin: '10px auto 20px',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        width: '100%',\r\n        [theme.breakpoints.down('xs')]: {\r\n            flexDirection: 'column',\r\n        },\r\n    },\r\n    mainTitle: {\r\n        marginBottom: '30px',\r\n    },\r\n    title: {\r\n        marginTop: 16,\r\n        [theme.breakpoints.down('md')]: {\r\n            maxWidth: 200,\r\n        },\r\n        [theme.breakpoints.down('sm')]: {\r\n            width: '100%',\r\n            maxWidth: 'none',\r\n        },\r\n    },\r\n    row: {\r\n        [theme.breakpoints.down('md')]: {\r\n            alignItems: 'center',\r\n        },\r\n        [theme.breakpoints.down('sm')]: {\r\n            flexDirection: 'column',\r\n            alignItems: 'flex-start',\r\n            textAlign: 'center',\r\n        },\r\n    },\r\n    btnDanger: {\r\n        marginLeft: 20,\r\n        [theme.breakpoints.down('xs')]: {\r\n            marginLeft: 0,\r\n            marginTop: theme.spacing(0.5),\r\n        },\r\n        //backgroundColor: theme.palette.error?.dark,\r\n    },\r\n    saveAndGoBtn: {\r\n        marginRight: 20,\r\n        [theme.breakpoints.down('xs')]: {\r\n            marginRight: 0,\r\n            marginBottom: theme.spacing(0.5),\r\n        },\r\n    },\r\n    toggleIcon: {\r\n        position: 'absolute',\r\n        top: -15,\r\n        left: 0,\r\n        backgroundColor: theme.palette.primary.main,\r\n        width: 20,\r\n        height: 25,\r\n        cursor: 'pointer',\r\n        padding: theme.spacing(1),\r\n        borderRadius: '0 5px 5px 0',\r\n    },\r\n    switchControl: {\r\n        paddingTop: theme.spacing(1),\r\n        flexBasis: '60%',\r\n    },\r\n    emptyButtons: {\r\n        height: 36,\r\n        [theme.breakpoints.down('sm')]: {\r\n            height: 0,\r\n        },\r\n    },\r\n    noRulesText: {\r\n        fontSize: 24,\r\n        color: theme.palette.primary.light\r\n    },\r\n});\r\n\r\nclass RightBar extends PureComponent {\r\n    defaultState = {\r\n        words: I18n.t('Create Rule'),\r\n        name: I18n.t('Create Rule'),\r\n        _break: false,\r\n        editable: false,\r\n        args: [\r\n            {\r\n                default: I18n.t('Argument') + ' 1',\r\n            },\r\n            {\r\n                default: I18n.t('Argument') + ' 2',\r\n            },\r\n        ],\r\n        ack: {\r\n            name: '',\r\n            default: `${I18n.t('Confirmation text')}`,\r\n        },\r\n        id: 0,\r\n    };\r\n\r\n    state = {\r\n        localRule: null,\r\n        showDialog: false,\r\n    };\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (\r\n            prevProps.selectedRule?.name !== this.props.selectedRule?.name ||\r\n            prevState.localRule?.name !== this.state.localRule?.name\r\n        ) {\r\n            if (!this.props.selectedRule || !this.props.selectedRule.name) {\r\n                this.setState({\r\n                    localRule: null,\r\n                });\r\n            } else {\r\n                this.setState({\r\n                    localRule: {\r\n                        ...this.props.selectedRule,\r\n                    },\r\n                });\r\n            }\r\n        } else if (this.state.isLocalStateWasUpdated) {\r\n            const unsavedRule = this.props.unsavedRules[this.state.localRule.id];\r\n\r\n            if (\r\n                isEqual(this.props.selectedRule, this.state.localRule) &&\r\n                !unsavedRule?.wasChangedGlobally\r\n            ) {\r\n                this.setState({\r\n                    isLocalStateWasUpdated: false,\r\n                });\r\n\r\n                if (!unsavedRule?.wasChangedGlobally) {\r\n                    this.props.removeUnsavedRule(this.state.localRule.id);\r\n                }\r\n            } else if (!unsavedRule && !this.props.pendingSelectedRuleId) {\r\n                this.props.setUnsavedRule(this.state.localRule.id);\r\n            }\r\n        } else if (\r\n            !this.state.isLocalStateWasUpdated &&\r\n            this.props.unsavedRules[this.state.localRule.id]\r\n        ) {\r\n            this.setState({\r\n                isLocalStateWasUpdated: true,\r\n            });\r\n        }\r\n\r\n        if (this.props.pendingSelectedRuleId && this.state.isLocalStateWasUpdated) {\r\n            if (this.props.pendingSelectedRuleId === this.state.localRule.id) return;\r\n            this.setState({\r\n                confirmChanges: true,\r\n            });\r\n        }\r\n\r\n        if (this.props.lang !== prevProps.lang) {\r\n            this.forceUpdate();\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (!this.state.localRule && this.props.selectedRule) {\r\n            this.setState({\r\n                localRule: this.props.selectedRule,\r\n            });\r\n        }\r\n    }\r\n\r\n    createConfirmModalActions = () => {\r\n        const { t } = I18n;\r\n        const {\r\n            updateConfig,\r\n            classes,\r\n            selectRule,\r\n            pendingSelectedRuleId,\r\n            clearStateOnConfirmModalUnmount,\r\n            revertChangesFromConfig,\r\n        } = this.props;\r\n        const { localRule } = this.state;\r\n\r\n        const cancelSavingChanges = async () => {\r\n            await clearStateOnConfirmModalUnmount();\r\n            this.closeConfirmDialog();\r\n        };\r\n\r\n        const dontSaveAndGo = async () => {\r\n            await revertChangesFromConfig(localRule);\r\n            await selectRule(pendingSelectedRuleId);\r\n            await clearStateOnConfirmModalUnmount(localRule.id);\r\n\r\n            this.closeConfirmDialog();\r\n        };\r\n        const handleSaveAndGo = async () => {\r\n            await updateConfig(localRule);\r\n            await selectRule(pendingSelectedRuleId);\r\n            await clearStateOnConfirmModalUnmount();\r\n\r\n            this.closeConfirmDialog();\r\n        };\r\n        return (\r\n            <FormControl className={classes.submitForm}>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    onClick={handleSaveAndGo}\r\n                    color=\"primary\"\r\n                    className={classes.saveAndGoBtn}>\r\n                    {t('Save and go')}\r\n                </Button>\r\n                <Button onClick={dontSaveAndGo} variant=\"contained\" color=\"secondary\">\r\n                    {t(`Don't save and go`)}\r\n                </Button>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    className={classes.btnDanger}\r\n                    onClick={cancelSavingChanges}>\r\n                    {t('Cancel')}\r\n                </Button>\r\n            </FormControl>\r\n        );\r\n    };\r\n\r\n    createSaveSettingsForm = () => {\r\n        const { t } = I18n;\r\n        const { updateConfig, classes, revertChangesFromConfig, selectedRule } = this.props;\r\n        const { localRule } = this.state;\r\n\r\n        const handleSave = async () => {\r\n            await updateConfig(localRule);\r\n            this.setState({\r\n                isLocalStateWasUpdated: false,\r\n            });\r\n        };\r\n\r\n        const revertChanges = async () => {\r\n            await revertChangesFromConfig(localRule);\r\n\r\n            await this.setState({\r\n                localRule: selectedRule,\r\n                isLocalStateWasUpdated: false,\r\n            });\r\n        };\r\n\r\n        if (!this.state.isLocalStateWasUpdated) {\r\n            return <div className={this.props.classes.emptyButtons} />;\r\n        } else {\r\n            return (\r\n                <FormControl className={classes.submitForm}>\r\n                    <Button onClick={handleSave} variant=\"contained\" color=\"primary\">\r\n                        {t('Save')}\r\n                    </Button>\r\n                    <Button\r\n                        variant=\"contained\"\r\n                        className={classes.btnDanger}\r\n                        onClick={revertChanges}>\r\n                        {t('Cancel')}\r\n                    </Button>\r\n                </FormControl>\r\n            );\r\n        }\r\n    };\r\n\r\n    closeConfirmDialog = () => {\r\n        this.setState({\r\n            isLocalStateWasUpdated: false,\r\n            confirmChanges: false,\r\n        });\r\n    };\r\n\r\n    createInput = ({\r\n        value,\r\n        label,\r\n        onChange,\r\n        type,\r\n        onClick,\r\n        note,\r\n        disabled = !this.state.localRule,\r\n        keywords,\r\n        key,\r\n        onSwitchChange,\r\n    }) => {\r\n        if ((value === undefined || value === null) && !label && !keywords) {\r\n            return;\r\n        }\r\n        const { classes } = this.props;\r\n\r\n        return type !== 'checkbox' ? (\r\n            <TextField\r\n                //label={label}\r\n                variant=\"outlined\"\r\n                size=\"small\"\r\n                disabled={disabled}\r\n                value={value}\r\n                helperText={note || ''}\r\n                onClick={onClick}\r\n                onChange={onChange}\r\n                key={key}\r\n                className={clsx('outlined-basic', classes.textField)}\r\n            />\r\n        ) : (\r\n            <FormControl classes={{ root: classes.switchControl }}>\r\n                <Switch\r\n                    key={key}\r\n                    onClick={onSwitchChange}\r\n                    color={'primary'}\r\n                    disabled={disabled}\r\n                    checked={!!value}\r\n                />\r\n            </FormControl>\r\n        );\r\n    };\r\n\r\n    createOptionsData = (state = this.state) => {\r\n        const {\r\n            localRule: { args, ack, editable, _break },\r\n        } = state;\r\n        const { t } = I18n;\r\n\r\n        const createInput = this.createInput;\r\n        const handlers = this.handlers;\r\n\r\n        const isKeyWordsDisabled = () => {\r\n            if (editable === undefined) {\r\n                return false;\r\n            } else if (editable === false) {\r\n                return true;\r\n            }\r\n            return false;\r\n        };\r\n\r\n        return [\r\n            {\r\n                title: t('Keywords'),\r\n                item: createInput({\r\n                    value: this.state.localRule?.words || '',\r\n                    onChange: handlers.keywordsText,\r\n                    keywords: true,\r\n                    disabled: isKeyWordsDisabled(),\r\n                    key: 'keywords',\r\n                }),\r\n                id: 1,\r\n            },\r\n            {\r\n                title: t('Interrupt processing'), //`${t('Break')}:`,\r\n                item: createInput({\r\n                    type: 'checkbox',\r\n                    value: _break,\r\n                    onSwitchChange: handlers.breakOnSwitch,\r\n                    key: 'break',\r\n                }),\r\n                id: 2,\r\n            },\r\n            {\r\n                title: args && args[0]?.name, //`${t('Argument')}:`,\r\n                item: createInput({\r\n                    value: args && this.state.localRule.args[0]?.default,\r\n                    label: args && args[0]?.name,\r\n                    type: args && args[0]?.type,\r\n                    onClick: this.handleSetDialogClick.bind(this, args && args[0]),\r\n                    onSwitchChange: handlers.param1OnSwitch,\r\n                    key: 'Param1',\r\n                }),\r\n                id: 3,\r\n            },\r\n            {\r\n                title: args && args[1]?.name, //`${t('Argument')}:`,\r\n                item: createInput({\r\n                    value: args && this.state.localRule.args[1]?.default,\r\n                    label: args && args[1]?.name,\r\n                    onChange: handlers.param2Text,\r\n                    key: 'Param2',\r\n                }),\r\n                id: 4,\r\n            },\r\n            {\r\n                title: t('Confirmation text'),\r\n                item: createInput({\r\n                    value: ack && ack.default,\r\n                    label: ack && ack.name,\r\n                    note: t(\r\n                        'You can use %s, that will be replaced with current value of state. %u will be replaced by unit'\r\n                    ),\r\n                    type: ack && ack.type,\r\n                    key: 'confirmationText',\r\n                    onChange: handlers.confirmText,\r\n                    onSwitchChange: handlers.confirmOnSwitch,\r\n                }),\r\n                id: 5,\r\n            },\r\n        ];\r\n    };\r\n\r\n    createInputHandlers = () => {\r\n        const _this = this;\r\n\r\n        return {\r\n            keywordsText(event) {\r\n                _this.setState({\r\n                    localRule: {\r\n                        ..._this.state.localRule,\r\n                        words: event.target.value,\r\n                    },\r\n                    isLocalStateWasUpdated: true,\r\n                });\r\n            },\r\n            param2Text(event) {\r\n                _this.setState({\r\n                    localRule: {\r\n                        ..._this.state.localRule,\r\n                        args: _this.state.localRule.args.map((arg, index) =>\r\n                            index > 0\r\n                                ? {\r\n                                      ...arg,\r\n                                      default: event.target.value,\r\n                                  }\r\n                                : arg\r\n                        ),\r\n                    },\r\n                    isLocalStateWasUpdated: true,\r\n                });\r\n            },\r\n            confirmText(event) {\r\n                _this.setState({\r\n                    localRule: {\r\n                        ..._this.state.localRule,\r\n                        ack: {\r\n                            ..._this.state.localRule.ack,\r\n                            default: event.target.value,\r\n                        },\r\n                    },\r\n                    isLocalStateWasUpdated: true,\r\n                });\r\n            },\r\n            param1OnSwitch() {\r\n                _this.setState({\r\n                    localRule: {\r\n                        ..._this.state.localRule,\r\n                        args: _this.state.localRule.args.map((arg, index) =>\r\n                            !index ? { ...arg, default: !arg.default ? true : !arg.default } : arg\r\n                        ),\r\n                    },\r\n                    isLocalStateWasUpdated: true,\r\n                });\r\n            },\r\n            confirmOnSwitch() {\r\n                _this.setState({\r\n                    localRule: {\r\n                        ..._this.state.localRule,\r\n                        ack: {\r\n                            ..._this.state.localRule.ack,\r\n                            default: !_this.state.localRule.ack.default,\r\n                        },\r\n                    },\r\n                    isLocalStateWasUpdated: true,\r\n                });\r\n            },\r\n            async breakOnSwitch() {\r\n                await _this.setState({\r\n                    localRule: {\r\n                        ..._this.state.localRule,\r\n                        _break: !_this.state.localRule._break,\r\n                    },\r\n                    isLocalStateWasUpdated: true,\r\n                });\r\n            },\r\n        };\r\n    };\r\n\r\n    handlers = this.createInputHandlers();\r\n\r\n    handleSetDialogClick = arg => {\r\n        if (arg.type === 'id') {\r\n            this.setState({\r\n                showDialog: true,\r\n            });\r\n        }\r\n    };\r\n\r\n    handleDialogSelectIdSubmit = selected => {\r\n        this.setState({\r\n            localRule: {\r\n                ...this.state.localRule,\r\n                args: this.state.localRule.args.map((arg, index) =>\r\n                    !index\r\n                        ? {\r\n                              ...arg,\r\n                              default: selected,\r\n                          }\r\n                        : arg\r\n                ),\r\n            },\r\n            isLocalStateWasUpdated: true,\r\n        });\r\n    };\r\n\r\n    renderConfirmDialog() {\r\n        return this.state.confirmChanges ? (\r\n            <Dialog fullWidth open={this.state.confirmChanges} maxWidth={'md'}>\r\n                <DialogTitle>\r\n                    {I18n.t('Please confirm or cancel changes before leaving')}\r\n                </DialogTitle>\r\n                <DialogContent>\r\n                    <Typography>\r\n                        {I18n.t('You have changed rule') + ': '}{' '}\r\n                        <strong>{this.state.localRule.name}</strong>\r\n                    </Typography>\r\n                    <DialogActions>{this.createConfirmModalActions()}</DialogActions>\r\n                </DialogContent>\r\n            </Dialog>\r\n        ) : null;\r\n    }\r\n\r\n    renderSelectIdDialog() {\r\n        return this.state.showDialog ? (\r\n            <DialogSelectID\r\n                socket={this.props.socket}\r\n                title={'Select ID'}\r\n                onClose={id => {\r\n                    console.log(id);\r\n                    this.setState({ showDialog: false });\r\n                }}\r\n                onOk={this.handleDialogSelectIdSubmit}\r\n            />\r\n        ) : null;\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            localRule,\r\n            isLocalStateWasUpdated,\r\n        } = this.state;\r\n        const { classes, isLeftBarHidden, toggleLeftBar } = this.props;\r\n        const name = localRule ? localRule.name : '';\r\n\r\n        return (\r\n            <Box mt=\"30px\" className={classes.box}>\r\n                {localRule ?\r\n                    <Paper className={classes.container} mx=\"auto\">\r\n                        <Typography\r\n                            variant=\"h4\"\r\n                            align=\"center\"\r\n                            className={!isLocalStateWasUpdated ? classes.mainTitle : ''}>\r\n                            {name}\r\n                        </Typography>\r\n\r\n                        {this.createSaveSettingsForm()}\r\n\r\n                        {this.createOptionsData().map(({title, item, id}) => {\r\n                            if (!item) return null;\r\n                            return (\r\n                                <Box\r\n                                    display=\"flex\"\r\n                                    justifyContent=\"space-between\"\r\n                                    mb=\"10px\"\r\n                                    key={id}\r\n                                    className={classes.row}>\r\n                                    <Typography\r\n                                        variant=\"h6\"\r\n                                        component=\"h6\"\r\n                                        align=\"left\"\r\n                                        className={classes.title}>\r\n                                        {title ? title + ':' : ''}\r\n                                    </Typography>\r\n                                    {item}\r\n                                </Box>\r\n                            );\r\n                        })}\r\n                    </Paper>\r\n                    :\r\n                    <div className={classes.noRulesText}>{I18n.t('Create a new rule with a \"+\" on the left')}</div>\r\n                }\r\n\r\n                <Box className={classes.toggleIcon} onClick={toggleLeftBar}>\r\n                    {isLeftBarHidden || !this.props.isMdScreen ? <MenuIcon /> : <ArrowBackIcon />}\r\n                </Box>\r\n\r\n                {this.renderSelectIdDialog()}\r\n                {this.renderConfirmDialog()}\r\n            </Box>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(RightBar);\r\n\r\nRightBar.propTypes = {\r\n    selectedRule: PropTypes.shape({\r\n        name: PropTypes.string,\r\n        id: PropTypes.string,\r\n        rule: PropTypes.string,\r\n        ack: PropTypes.shape({\r\n            default: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\r\n            value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n        }),\r\n        arg: PropTypes.arrayOf(\r\n            PropTypes.shape({\r\n                name: PropTypes.string,\r\n                type: PropTypes.string,\r\n                default: PropTypes.oneOfType([PropTypes.string, PropTypes.number, PropTypes.bool]),\r\n            })\r\n        ),\r\n        words: PropTypes.string,\r\n    }).isRequired,\r\n    socket: PropTypes.object.isRequired,\r\n    updateConfig: PropTypes.func.isRequired,\r\n    revertChangesFromConfig: PropTypes.func.isRequired,\r\n    classes: PropTypes.object.isRequired,\r\n    selectRule: PropTypes.func.isRequired,\r\n    pendingSelectedRuleId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\r\n    clearStateOnConfirmModalUnmount: PropTypes.func.isRequired,\r\n    unsavedRules: PropTypes.object.isRequired,\r\n    setUnsavedRule: PropTypes.func.isRequired,\r\n    removeUnsavedRule: PropTypes.func.isRequired,\r\n    toggleLeftBar: PropTypes.func.isRequired,\r\n    isLeftBarHidden: PropTypes.bool,\r\n    isMdScreen: PropTypes.bool.isRequired,\r\n};\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport FormGroup from '@material-ui/core/FormGroup';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport { DialogActions, Button, Select, TextField, MenuItem, withStyles } from '@material-ui/core';\r\n\r\nconst styles = theme => ({\r\n    select: {\r\n        width: '100%',\r\n        marginBottom: theme.spacing(2.5),\r\n    },\r\n    TextField: {\r\n        marginBottom: theme.spacing(1),\r\n    },\r\n});\r\n\r\nclass CreateRuleDialog extends Component {\r\n    defaultRule = {\r\n        rule: I18n.t('Select rule'),\r\n        name: I18n.t('New rule'),\r\n        id: '',\r\n    };\r\n\r\n    state = {\r\n        localRule: this.defaultRule,\r\n        isDisabled: true,\r\n    };\r\n\r\n    componentWillUnmount() {\r\n        this.cleanState();\r\n    }\r\n\r\n    setRuleOnMount = () => {\r\n        const { isEdit, selectedRule } = this.props;\r\n        if (isEdit) {\r\n            this.setState({\r\n                localRule: selectedRule,\r\n            });\r\n        }\r\n    };\r\n\r\n    cleanState = () => {\r\n        if (this.props.isEdit) {\r\n            this.props.finishEdit(this.state.localRule);\r\n        }\r\n        this.setState({\r\n            localRule: this.defaultRule,\r\n        });\r\n    };\r\n\r\n    getAvaliableOptions = () => {\r\n        const { commands, currentRules, selectedRule, isEdit } = this.props;\r\n\r\n        const uniqueOptions = commands?.filter(\r\n            option => !(option.unique && currentRules.find(item => item?.rule === option.rule))\r\n        );\r\n\r\n        return selectedRule?.unique && isEdit ? uniqueOptions.concat(selectedRule) : uniqueOptions;\r\n    };\r\n\r\n    getUniqueName = ruleName => {\r\n        const existingNames = this.props.currentRules?.map(rule => rule?.name);\r\n\r\n        const matchingNames = existingNames.filter(\r\n            name => name.slice(0, name.length - 2) === ruleName\r\n        );\r\n        const isUnique = this.props.commands.find(\r\n            ({ rule, unique }) => rule === ruleName && unique\r\n        );\r\n\r\n        if (matchingNames.length) {\r\n            let name = matchingNames[matchingNames.length - 1];\r\n            let lastChar = name.slice(name.length - 1);\r\n\r\n            return name.slice(0, name.length - 1) + ++lastChar;\r\n        }\r\n\r\n        return isUnique ? ruleName : `${ruleName} 1`;\r\n    };\r\n\r\n    createForm = () => {\r\n        const { localRule } = this.state;\r\n        const { classes } = this.props;\r\n        const commands = this.getAvaliableOptions();\r\n\r\n        const handleSelectChange = event =>\r\n            this.setState({\r\n                localRule: {\r\n                    ...localRule,\r\n                    rule: event.target.value,\r\n                    name: this.getUniqueName(event.target.value),\r\n                    isError: '',\r\n                },\r\n                isDisabled: event.target.value === this.defaultRule.rule,\r\n            });\r\n\r\n        const handleInputChange = event => {\r\n            const existingNames = this.props.currentRules?.map(rule => rule?.name);\r\n\r\n            this.setState({\r\n                localRule: {\r\n                    ...localRule,\r\n                    name: event.target.value,\r\n                    isError: existingNames.includes(event.target.value)\r\n                        ? `${I18n.t('Name already exist')}`\r\n                        : '',\r\n                },\r\n            });\r\n        };\r\n\r\n        return (\r\n            <FormGroup>\r\n                <FormControl fullWidth>\r\n                    <InputLabel shrink id=\"rule\">\r\n                        {I18n.t('Rule')}\r\n                    </InputLabel>\r\n                    <Select\r\n                        onChange={handleSelectChange}\r\n                        value={localRule.rule}\r\n                        labelId={'rule'}\r\n                        className={classes.select}>\r\n                        {commands?.map(option => (\r\n                            <MenuItem key={option.rule} value={option.rule}>\r\n                                {option.rule}\r\n                            </MenuItem>\r\n                        ))}\r\n                    </Select>\r\n                </FormControl>\r\n                <TextField\r\n                    fullWidth\r\n                    id=\"standard-basic\"\r\n                    label={this.state.localRule.isError || I18n.t('Name')}\r\n                    value={localRule.name}\r\n                    onChange={handleInputChange}\r\n                    error={!!this.state.localRule.isError}\r\n                    className={classes.TextField}/>\r\n            </FormGroup>\r\n        );\r\n    };\r\n\r\n    setDialogContent = () => {\r\n        const { handleClose, handleSubmitOnCreate, handleSubmitOnEdit, isEdit } = this.props;\r\n        const onSubmitHandler = !isEdit ? handleSubmitOnCreate : handleSubmitOnEdit;\r\n        return (\r\n            <DialogContent>\r\n                {this.createForm()}\r\n                <DialogActions>\r\n                    <Button\r\n                        onClick={onSubmitHandler.bind(\r\n                            this,\r\n                            this.state.localRule,\r\n                            this.state.localRule.isError\r\n                        )}\r\n                        disabled={this.state.isDisabled}>\r\n                        Ok\r\n                    </Button>\r\n                    <Button onClick={handleClose}>{I18n.t('Cancel')}</Button>\r\n                </DialogActions>\r\n            </DialogContent>\r\n        );\r\n    };\r\n    render() {\r\n        return (\r\n            <Dialog\r\n                open={this.props.isOpen}\r\n                onClose={this.props.handleClose}\r\n                onExited={this.cleanState}\r\n                onEnter={this.setRuleOnMount}\r\n                fullWidth>\r\n                <DialogTitle>\r\n                    {I18n.t(!this.props.isEdit ? 'Create new rule' : 'Edit rule')}\r\n                </DialogTitle>\r\n                {this.setDialogContent()}\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(CreateRuleDialog);\r\n\r\nCreateRuleDialog.propTypes = {\r\n    handleClose: PropTypes.func.isRequired,\r\n    handleSubmitOnCreate: PropTypes.func.isRequired,\r\n    handleSubmitOnEdit: PropTypes.func.isRequired,\r\n    isEdit: PropTypes.bool.isRequired,\r\n    commands: PropTypes.arrayOf(\r\n        PropTypes.shape({\r\n            rule: PropTypes.string.isRequired,\r\n            unique: PropTypes.bool.isRequired,\r\n        }).isRequired\r\n    ),\r\n    isOpen: PropTypes.bool.isRequired,\r\n    currentRules: PropTypes.arrayOf(\r\n        PropTypes.shape({\r\n            id: PropTypes.string.isRequired,\r\n            name: PropTypes.string.isRequired,\r\n            rule: PropTypes.string.isRequired,\r\n            unique: PropTypes.bool,\r\n        })\r\n    ).isRequired,\r\n    finishEdit: PropTypes.func.isRequired,\r\n    classes: PropTypes.object.isRequired,\r\n};\r\n","import React, { PureComponent } from 'react';\r\nimport SplitterLayout from 'react-splitter-layout';\r\nimport { v4 as uuid } from 'uuid';\r\nimport PropTypes from 'prop-types';\r\nimport clsx from 'clsx';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport withWidth, { isWidthUp } from '@material-ui/core/withWidth';\r\nimport 'react-splitter-layout/lib/index.css';\r\nimport Drawer from '@material-ui/core/Drawer';\r\n\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\n\r\nimport LeftBar from './LeftBar';\r\nimport RightBar from './RightBar';\r\nimport CreateRuleDialog from './CreateRuleDialog';\r\nimport isEqual from 'lodash.isequal';\r\n\r\nconst styles = theme => ({\r\n    layout: {\r\n        '& .layout-pane:first': {\r\n            overflow: 'hidden',\r\n        },\r\n    },\r\n    hidden: {\r\n        '& .layout-pane:first-child': {\r\n            width: '0 !important',\r\n        },\r\n        background: theme.palette.background.default,\r\n    },\r\n    opened: {\r\n        '& .layout-pane-primary': {\r\n            width: '',\r\n        },\r\n        overflow: 'hidden',\r\n        background: theme.palette.background.default,\r\n    },\r\n});\r\n\r\nclass Layout extends PureComponent {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.menuSize = parseFloat(window.localStorage.getItem('App.menuSize')) || 350;\r\n        this.state = {\r\n            currentRules: [],\r\n            isOpen: false,\r\n            isEdit: false,\r\n            selectedRule: null,\r\n            unsavedRules: {},\r\n            isLeftBarOpen: window.localStorage.getItem('App.menuHidden') === 'true',\r\n        };\r\n        this.commands = this.getSelectedLanguageCommands();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getDataFromConfig()\r\n            .then(({ rules, ...settings }) => {\r\n                const rulesWithId = rules.map(rule =>\r\n                    !rule.id || !rule.name\r\n                        ? {\r\n                              ...rule,\r\n                              id: !rule.id ? uuid() : rule.id,\r\n                              name: !rule.name\r\n                                  ? window.commands[rule.template]?.name[I18n.getLanguage()]\r\n                                  : rule.name,\r\n                          }\r\n                        : rule\r\n                );\r\n                if (!isEqual(rules, rulesWithId)) {\r\n                    this.props.saveConfig({ rules: rulesWithId, ...settings });\r\n                }\r\n            });\r\n\r\n        if (!this.isMdScreen) {\r\n            this.setState({\r\n                isLeftBarOpen: true,\r\n            });\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.state.settings?.language !== this.state.lang && this.state.settings?.language) {\r\n            const lang = this.state.settings?.language;\r\n            I18n.setLanguage(lang);\r\n\r\n            this.commands = this.getSelectedLanguageCommands();\r\n        }\r\n\r\n        if (\r\n            prevState.selectedRule?.id !== this.state.selectedRule?.id &&\r\n            prevState.selectedRule?.id && this.state.selectedRule\r\n        ) {\r\n            localStorage.setItem('selectedRule', this.state.selectedRule.id);\r\n        }\r\n    }\r\n\r\n    getSelectedLanguageCommands = () => {\r\n        const lang = this.state?.settings?.language || I18n.getLanguage();\r\n\r\n        return [\r\n            { rule: I18n.t('Select rule'), unique: false },\r\n            ...Object.entries(window.commands).map(item => {\r\n                const [key, command] = item;\r\n                const { name, ...rest } = command;\r\n                const obj = {\r\n                    ...rest,\r\n                    rule: command?.name[lang],\r\n                    template: key,\r\n                    unique: command.unique,\r\n                    words: command.words && command.words[lang],\r\n                    args: command.args?.map(arg => ({\r\n                        ...arg,\r\n                        name: arg.name[lang] || '',\r\n                        default: arg.default || (arg.type === 'checkbox' ? false : ''),\r\n                    })),\r\n                    ack: command.ack && {\r\n                        ...command.ack,\r\n                        name: command.ack.name[lang],\r\n                        default: !command.ack?.default\r\n                            ? command.ack?.type === 'checkbox'\r\n                                ? false\r\n                                : ''\r\n                            : command.ack.default[lang],\r\n                    },\r\n                };\r\n\r\n                return obj;\r\n            }),\r\n        ];\r\n    };\r\n\r\n    commands = this.getSelectedLanguageCommands();\r\n\r\n    moveRule = (dragIndex, hoverIndex) => {\r\n        const { currentRules } = this.state;\r\n        const sourceRule = currentRules.find((_, index) => index === hoverIndex);\r\n        const sortRules = currentRules.filter((_, index) => index !== hoverIndex);\r\n        sortRules.splice(dragIndex, 0, sourceRule);\r\n        this.setState({ currentRules: sortRules });\r\n    };\r\n\r\n    handleOpen = () => {\r\n        this.setState({\r\n            isOpen: true,\r\n        });\r\n    };\r\n    handleClose = () => {\r\n        this.setState({ isOpen: false });\r\n    };\r\n\r\n    handleSubmitOnCreate = (selectedRule, isError) => {\r\n        if (isError) {\r\n            return;\r\n        }\r\n\r\n        const id = uuid();\r\n        const shortDataRule = {\r\n            ...selectedRule,\r\n            id,\r\n            _break: true,\r\n        };\r\n\r\n        const rule = {\r\n            ...this.commands.find(command => command.rule === shortDataRule.rule),\r\n            ...shortDataRule,\r\n        };\r\n        const isUnsavedChanges = Object.values(this.state.unsavedRules).length;\r\n\r\n        this.setState(\r\n            {\r\n                currentRules: [...this.state.currentRules, rule],\r\n                unsavedRules: {\r\n                    ...this.state.unsavedRules,\r\n                    [id]: {\r\n                        id,\r\n                        wasChangedGlobally: true,\r\n                    },\r\n                },\r\n                selectedRule: !isUnsavedChanges ? rule : this.state.selectedRule,\r\n            },\r\n            () => {\r\n                if (isUnsavedChanges) {\r\n                    this.selectRule(rule.id);\r\n                }\r\n            }\r\n        );\r\n\r\n        this.handleClose();\r\n    };\r\n\r\n    handleSubmitOnEdit = (selectedRule, isError) => {\r\n        if (isError) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            unsavedRules: {\r\n                ...this.state.unsavedRules,\r\n                [selectedRule.id]: {\r\n                    id: selectedRule.id,\r\n                    wasChangedGlobally: true,\r\n                },\r\n            },\r\n            currentRules: this.updateCurrentRules(selectedRule),\r\n        });\r\n        this.handleClose();\r\n    };\r\n\r\n    selectRule = id => {\r\n        const { selectedRule, currentRules } = this.state;\r\n\r\n        if (selectedRule.id === id) {\r\n            // ignore\r\n        } else if (this.state.unsavedRules[selectedRule.id]) {\r\n            this.setState({\r\n                pendingSelectedRuleId: id,\r\n            });\r\n        } else {\r\n            const rule = currentRules.find(item => item.id === id);\r\n\r\n            this.setState({\r\n                selectedRule: rule,\r\n                isLeftBarOpen: !this.isMdScreen ? false : this.state.isLeftBarOpen\r\n            });\r\n        }\r\n    };\r\n\r\n    updateCurrentRules = selectedRule => {\r\n        return this.state.currentRules.map(item =>\r\n            item.id === selectedRule.id ? selectedRule : item\r\n        );\r\n    };\r\n\r\n    handleEdit = () => {\r\n        this.setState({\r\n            isEdit: true,\r\n        });\r\n        this.handleOpen();\r\n    };\r\n\r\n    finishEdit = editableRule => {\r\n        let updatedRule;\r\n\r\n        const { rule, id, name, _break, template } = editableRule;\r\n        const initialSelectedRule = this.state.selectedRule;\r\n\r\n        if (initialSelectedRule.rule !== rule) {\r\n            const updatedRuleOptions = this.commands.find(command => command.rule === rule);\r\n            updatedRule = {\r\n                ...updatedRuleOptions,\r\n                name,\r\n                rule,\r\n                id,\r\n                _break,\r\n                template,\r\n            };\r\n        } else {\r\n            updatedRule = editableRule;\r\n        }\r\n\r\n        this.setState({\r\n            isEdit: false,\r\n            selectedRule: updatedRule,\r\n        });\r\n    };\r\n\r\n    removeRule = id => {\r\n        const deleteRuleFromConfig = async () => {\r\n            const config = await this.props.readConfig();\r\n            const { rules, ...settings } = config;\r\n            const newConfig = { rules: rules.filter(rule => rule.id !== id), ...settings };\r\n            this.props.saveConfig(newConfig);\r\n        };\r\n        const updatedRules = this.state.currentRules.filter(rule => rule.id !== id);\r\n        this.setState(\r\n            {\r\n                currentRules: updatedRules,\r\n                selectedRule: updatedRules.length ? updatedRules[updatedRules.length - 1] : null,\r\n            },\r\n            deleteRuleFromConfig\r\n        );\r\n    };\r\n\r\n    updateConfig = async currentSelectedRule => {\r\n        const { [currentSelectedRule.id]: removedId, ...ids } = this.state.unsavedRules;\r\n        const config = await this.props.readConfig();\r\n        const { rules, ...settings } = config;\r\n\r\n        const matchingRule = rules.find(rule => rule.id === currentSelectedRule.id);\r\n        const updatedCurrentRules = this.updateCurrentRules(currentSelectedRule)\r\n\r\n        let updatedRules;\r\n        if (matchingRule) {\r\n            updatedRules = rules.map(rule =>\r\n                rule.id === currentSelectedRule.id\r\n                    ? this.getRuleShortData(currentSelectedRule)\r\n                    : rule\r\n            );\r\n        } else {\r\n            updatedRules = [...rules, this.getRuleShortData(currentSelectedRule)];\r\n        }\r\n\r\n        const newConfig = { rules: updatedRules, ...settings };\r\n        await this.props.saveConfig(newConfig);\r\n\r\n        this.setState({\r\n            selectedRule: currentSelectedRule || this.state.selectedRule || null,\r\n            currentRules: updatedCurrentRules,\r\n            unsavedRules: ids,\r\n        });\r\n    };\r\n    getDataFromConfig = async () => {\r\n        const config = await this.props.readConfig();\r\n        const { rules, ...settings } = config;\r\n        const lang = I18n.getLanguage();\r\n\r\n        const rulesFullData = rules.map(rule => {\r\n            const obj = window.commands[rule.template];\r\n\r\n            return {\r\n                ...obj,\r\n                rule: obj?.name[lang],\r\n                ack: {\r\n                    ...obj.ack,\r\n                    default: rule.ack || (obj.ack?.type === 'checkbox' ? false : ''),\r\n                    name: obj.ack?.name[lang],\r\n                },\r\n                args: obj.args?.map((arg, index) => ({\r\n                    ...arg,\r\n                    default: rule.args[index] || (arg?.type === 'checkbox' ? false : ''),\r\n                    name: arg?.name[lang] || '',\r\n                })),\r\n                name: rule.name || obj?.name[lang],\r\n                words: rule.words,\r\n                _break: rule._break,\r\n                id: rule.id || uuid(),\r\n                template: rule.template,\r\n            };\r\n        });\r\n        await this.setState({\r\n            currentRules: rulesFullData,\r\n            selectedRule:\r\n                rulesFullData.find(rule => rule.id === localStorage.getItem('selectedRule')) ||\r\n                rulesFullData[rulesFullData.length - 1] ||\r\n                null,\r\n            settings,\r\n        });\r\n        return config;\r\n    };\r\n\r\n    revertChangesFromConfig = async selectedRule => {\r\n        const { currentRules } = this.state;\r\n        const { [selectedRule.id]: removedId, ...ids } = this.state.unsavedRules;\r\n        const config = await this.props.readConfig();\r\n        const { rules, ...settings } = config;\r\n\r\n        const matchingRule = rules.find(rule => rule.id === selectedRule.id);\r\n        const isRuleWasUpdatedGlobally = this.state.unsavedRules[selectedRule.id]\r\n            ?.wasChangedGlobally;\r\n\r\n        let updatedRules;\r\n        if (matchingRule && isRuleWasUpdatedGlobally) {\r\n            updatedRules = currentRules.map(rule =>\r\n                rule.id === matchingRule.id\r\n                    ? {\r\n                          ...rule,\r\n                          ack: {\r\n                              ...rule.ack,\r\n                              default: matchingRule.ack || '',\r\n                          },\r\n                          args: rule.args?.map(arg => ({\r\n                              ...arg,\r\n                              default: matchingRule.arg || '',\r\n                          })),\r\n                          rule: window.commands[matchingRule.template].name[I18n.getLanguage()],\r\n                          words: matchingRule.words || '',\r\n                          name: matchingRule.name || '',\r\n                          _break: matchingRule._break || true,\r\n                      }\r\n                    : rule\r\n            );\r\n        } else if (!matchingRule) {\r\n            updatedRules = currentRules.filter(rule => rule.id !== selectedRule.id);\r\n        }\r\n\r\n        await this.setState({\r\n            currentRules: updatedRules || currentRules,\r\n            selectedRule:\r\n                (isRuleWasUpdatedGlobally\r\n                    ? updatedRules.find(rule => rule.id === selectedRule.id)\r\n                    : this.state.selectedRule) || null,\r\n            settings,\r\n            unsavedRules: ids,\r\n        });\r\n\r\n        if (this.state.currentRules.length !== currentRules.length) {\r\n            this.setState({\r\n                selectedRule: this.state.currentRules[this.state.currentRules.length - 1] || null,\r\n            });\r\n        }\r\n    };\r\n\r\n    saveSettings = async (localeSettings, closeModal) => {\r\n        const config = await this.props.readConfig();\r\n        const { rules } = config;\r\n        this.setState({\r\n            settings: localeSettings,\r\n        });\r\n        const newConfig = { rules, ...localeSettings };\r\n        await this.props.saveConfig(newConfig);\r\n        closeModal();\r\n    };\r\n\r\n    setUnsavedRule = id => {\r\n        this.setState({\r\n            unsavedRules: {\r\n                ...this.state.unsavedRules,\r\n                [id]: {\r\n                    id,\r\n                    wasChangedGlobally: false,\r\n                },\r\n            },\r\n        });\r\n    };\r\n\r\n    removeUnsavedRule = id => {\r\n        const { [id]: removedId, ...ids } = this.state.unsavedRules;\r\n        this.setState({\r\n            unsavedRules: ids,\r\n        });\r\n    };\r\n\r\n    getRuleShortData = ({ _break, template, words, ack, args, name, id }) => ({\r\n        words: words || '',\r\n        ack: ack?.default || '',\r\n        args: args?.map(arg => arg.default) || [],\r\n        _break,\r\n        template,\r\n        name,\r\n        id,\r\n    });\r\n\r\n    clearStateOnConfirmModalUnmount = id => {\r\n        const { [id]: removedId, ...ids } = this.state.unsavedRules;\r\n\r\n        this.setState({\r\n            pendingSelectedRuleId: false,\r\n            unsavedRules: ids,\r\n        });\r\n    };\r\n\r\n    isLargeScreen = isWidthUp('lg', this.props.width);\r\n    isMdScreen = isWidthUp('md', this.props.width);\r\n    isSmScreen = isWidthUp('sm', this.props.width);\r\n    isMobileScreen = isWidthUp('xs', this.props.width);\r\n\r\n    toggleLeftBar = () => {\r\n        window.localStorage.setItem('App.menuHidden', !this.state.isLeftBarOpen);\r\n        this.setState({\r\n            isLeftBarOpen: !this.state.isLeftBarOpen,\r\n        });\r\n    };\r\n\r\n    closeDrawer = () => {\r\n        this.setState({\r\n            isLeftBarOpen: false,\r\n        });\r\n    };\r\n\r\n    renderModalDialog() {\r\n        return this.state.isOpen ? (\r\n            <CreateRuleDialog\r\n                key=\"modal\"\r\n                commands={this.commands}\r\n                isEdit={this.state.isEdit}\r\n                handleSubmitOnCreate={this.handleSubmitOnCreate}\r\n                handleSubmitOnEdit={this.handleSubmitOnEdit}\r\n                handleClose={this.handleClose}\r\n                isOpen={this.state.isOpen}\r\n                currentRules={this.state.currentRules}\r\n                selectedRule={this.state.selectedRule}\r\n                finishEdit={this.finishEdit}\r\n            />\r\n        ) : null;\r\n    }\r\n    render() {\r\n        console.log(this.state);\r\n        const { classes } = this.props;\r\n        const { currentRules, selectedRule, isLeftBarOpen } = this.state;\r\n\r\n        if (!this.isMdScreen) {\r\n            return (\r\n                <>\r\n                    <Drawer\r\n                        anchor=\"left\"\r\n                        open={this.state.isLeftBarOpen}\r\n                        onClose={this.closeDrawer}>\r\n                        <LeftBar\r\n                            handleOpen={this.handleOpen}\r\n                            rules={currentRules}\r\n                            moveRule={this.moveRule}\r\n                            handleEdit={this.handleEdit}\r\n                            selectRule={this.selectRule}\r\n                            selectedRule={selectedRule}\r\n                            removeRule={this.removeRule}\r\n                            settings={this.state.settings}\r\n                            socket={this.props.socket}\r\n                            saveSettings={this.saveSettings}\r\n                            theme={this.props.theme}\r\n                            toggleLeftBar={this.toggleLeftBar}\r\n                            unsavedRules={this.state.unsavedRules}\r\n                            isMdScreen={this.isMdScreen}\r\n                            closeDrawer={this.closeDrawer}\r\n                        />\r\n                    </Drawer>\r\n                    {this.state.settings ?\r\n                        <RightBar\r\n                            selectedRule={selectedRule}\r\n                            socket={this.props.socket}\r\n                            updateConfig={this.updateConfig}\r\n                            revertChangesFromConfig={this.revertChangesFromConfig}\r\n                            pendingSelectedRuleId={this.state.pendingSelectedRuleId}\r\n                            unsavedRules={this.state.unsavedRules}\r\n                            selectRule={this.selectRule}\r\n                            clearStateOnConfirmModalUnmount={this.clearStateOnConfirmModalUnmount}\r\n                            lang={this.state.settings.language}\r\n                            setUnsavedRule={this.setUnsavedRule}\r\n                            removeUnsavedRule={this.removeUnsavedRule}\r\n                            toggleLeftBar={this.toggleLeftBar}\r\n                            isLeftBarOpen={this.state.isLeftBarOpen}\r\n                            isMdScreen={this.isMdScreen}\r\n                        /> : null}\r\n                    {this.renderModalDialog()}\r\n                </>\r\n            );\r\n        } else {\r\n            return (\r\n                <>\r\n                    <SplitterLayout\r\n                        key=\"splitterLayout\"\r\n                        customClassName={clsx(\r\n                            isLeftBarOpen ? classes.hidden : classes.opened,\r\n                            classes.layout\r\n                        )}\r\n                        primaryMinSize={350}\r\n                        primaryIndex={1}\r\n                        secondaryMinSize={350}\r\n                        onSecondaryPaneSizeChange={size => (this.menuSize = parseFloat(size))}\r\n                        onDragEnd={() => {\r\n                            window.localStorage.setItem('App.menuSize', this.menuSize.toString());\r\n                        }}\r\n                        secondaryInitialSize={this.menuSize}>\r\n                        <LeftBar\r\n                            handleOpen={this.handleOpen}\r\n                            rules={currentRules}\r\n                            moveRule={this.moveRule}\r\n                            handleEdit={this.handleEdit}\r\n                            selectRule={this.selectRule}\r\n                            selectedRule={selectedRule}\r\n                            removeRule={this.removeRule}\r\n                            settings={this.state.settings}\r\n                            socket={this.props.socket}\r\n                            saveSettings={this.saveSettings}\r\n                            theme={this.props.theme}\r\n                            unsavedRules={this.state.unsavedRules}\r\n                            isMdScreen={this.isMdScreen}\r\n                        />\r\n                        {this.state.settings ?\r\n                            <RightBar\r\n                                selectedRule={selectedRule}\r\n                                socket={this.props.socket}\r\n                                updateCurrentRules={this.updateCurrentRules}\r\n                                updateConfig={this.updateConfig}\r\n                                revertChangesFromConfig={this.revertChangesFromConfig}\r\n                                pendingSelectedRuleId={this.state.pendingSelectedRuleId}\r\n                                unsavedRules={this.state.unsavedRules}\r\n                                selectRule={this.selectRule}\r\n                                clearStateOnConfirmModalUnmount={\r\n                                    this.clearStateOnConfirmModalUnmount\r\n                                }\r\n                                lang={this.state.settings.language}\r\n                                setUnsavedRule={this.setUnsavedRule}\r\n                                removeUnsavedRule={this.removeUnsavedRule}\r\n                                toggleLeftBar={this.toggleLeftBar}\r\n                                isLeftBarOpen={this.state.isLeftBarOpen}\r\n                                isMdScreen={this.isMdScreen}\r\n                            /> : null}\r\n                    </SplitterLayout>\r\n                    {this.renderModalDialog()}\r\n                </>\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nLayout.propTypes = {\r\n    socket: PropTypes.object.isRequired,\r\n    theme: PropTypes.object.isRequired,\r\n    readConfig: PropTypes.func.isRequired,\r\n    saveConfig: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default withStyles(styles)(withWidth()(Layout));\r\n","import React from 'react';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\n\r\nimport Loader from '@iobroker/adapter-react/Components/Loader';\r\nimport I18n from '@iobroker/adapter-react/i18n';\r\nimport GenericApp from '@iobroker/adapter-react/GenericApp';\r\nimport Layout from './components/Layout';\r\nimport isEqual from 'lodash.isequal';\r\n\r\n// Icons\r\n\r\nconst styles = theme => ({\r\n    root: {},\r\n    logo: {\r\n        width: 32,\r\n        height: 32,\r\n        padding: theme.spacing(1),\r\n        display: 'inline-block',\r\n    },\r\n});\r\n\r\nclass App extends GenericApp {\r\n    constructor(props) {\r\n        super(props);\r\n        this.translations = {\r\n            en: require('./i18n/en'),\r\n            de: require('./i18n/de'),\r\n            ru: require('./i18n/ru'),\r\n            pt: require('./i18n/pt'),\r\n            nl: require('./i18n/nl'),\r\n            fr: require('./i18n/fr'),\r\n            it: require('./i18n/it'),\r\n            es: require('./i18n/es'),\r\n            pl: require('./i18n/pl'),\r\n            'zh-cn': require('./i18n/zh-cn'),\r\n        };\r\n\r\n        // init translations\r\n        I18n.setTranslations(this.translations);\r\n        I18n.setLanguage(\r\n            (navigator.language || navigator.userLanguage || 'en').substring(0, 2).toLowerCase()\r\n        );\r\n    }\r\n\r\n    onConnectionReady() {\r\n        const newState = {};\r\n\r\n        this.socket\r\n            .getSystemConfig()\r\n            .then(systemConfig => {\r\n                newState.systemConfig = systemConfig;\r\n                return this.readConfig();\r\n            })\r\n            .then(config => {\r\n                console.log(config);\r\n                this.setState({ config, ready: true });\r\n                if (config.language !== I18n.getLanguage() && config.language) {\r\n                    I18n.setLanguage(config.language);\r\n                }\r\n            })\r\n            .catch(e => this.showError(e));\r\n    }\r\n\r\n    readConfig() {\r\n        return this.socket\r\n            .getObject('system.adapter.' + this.adapterName + '.' + this.instance)\r\n            .then(config => {\r\n                const native = config.native || {};\r\n                native.rules = native.rules || [];\r\n                native.sayitInstance = native.sayitInstance || '';\r\n                native.language = native.language || '';\r\n                native.processorId = native.processorId || '';\r\n                native.processorTimeout = native.processorTimeout || 1000;\r\n                return native;\r\n            });\r\n    }\r\n\r\n    saveConfig(config) {\r\n        return this.socket\r\n            .getObject('system.adapter.' + this.adapterName + '.' + this.instance)\r\n            .then(obj => {\r\n                if (!isEqual(obj.native, config)) {\r\n                    obj.native = config;\r\n                    return this.socket.setObject(\r\n                        'system.adapter.' + this.adapterName + '.' + this.instance,\r\n                        obj\r\n                    );\r\n                }\r\n            });\r\n    }\r\n\r\n    render() {\r\n        if (!this.state.config) {\r\n            return (\r\n                <MuiThemeProvider theme={this.state.theme}>\r\n                    <Loader theme={this.state.themeType} />\r\n                </MuiThemeProvider>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <MuiThemeProvider theme={this.state.theme}>\r\n                <div className=\"App\">\r\n                    <Layout\r\n                        theme={this.state.theme}\r\n                        socket={this.socket}\r\n                        readConfig={this.readConfig.bind(this)}\r\n                        saveConfig={this.saveConfig.bind(this)}\r\n                    />\r\n                    {this.renderError()}\r\n                </div>\r\n            </MuiThemeProvider>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(App);\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport * as Sentry from '@sentry/browser';\r\nimport * as SentryIntegrations from '@sentry/integrations';\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nimport './index.css';\r\nimport App from './App';\r\nimport { version } from '../package.json';\r\nimport theme from '@iobroker/adapter-react/Theme';\r\nimport Utils from '@iobroker/adapter-react/Components/Utils';\r\n\r\nwindow.adapterName = 'text2command';\r\nlet themeName = Utils.getThemeName();\r\n\r\nconsole.log('iobroker.' + window.adapterName + '@' + version + ' using theme \"' + themeName + '\"');\r\n\r\nfunction build() {\r\n    return ReactDOM.render(\r\n        <MuiThemeProvider theme={theme(themeName)}>\r\n            <App\r\n                onThemeChange={_theme => {\r\n                    themeName = _theme;\r\n                    build();\r\n                }}\r\n            />\r\n        </MuiThemeProvider>,\r\n        document.getElementById('root')\r\n    );\r\n}\r\n\r\n\r\n// if not local development\r\nif (window.location.host !== 'localhost:3000') {\r\n    Sentry.init({\r\n        dsn: 'https://9806f910556240219f831ecfe2ee3ad1@sentry.iobroker.net/87',\r\n        release: 'iobroker.' + window.adapterName + '@' + version,\r\n        integrations: [new SentryIntegrations.Dedupe()],\r\n    });\r\n}\r\n\r\nbuild();\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.register();\r\n"],"sourceRoot":""}