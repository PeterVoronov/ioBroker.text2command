{"version":3,"sources":["serviceWorker.js","components/Rule.js","components/LeftBar.js","components/RightBar.js","components/CreateRuleDialog.js","components/Layout.js","App.js","index.js"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","Rule","React","forwardRef","props","ref","name","handleEdit","rule","isDragging","connectDragSource","connectDropTarget","id","selectRule","selectedRule","_break","matchingRules","unsavedRules","index","theme","removeMatched","words","classes","makeStyles","listItem","cursor","transition","position","listItemText","color","palette","text","primary","secondary","textOverflow","overflow","dot","backgroundColor","top","right","width","height","borderRadius","maximize","dark","marginTop","spacing","ruleButton","paddingTop","elementRef","useRef","opacity","useImperativeHandle","getNode","current","selectRuleMemo","useCallback","handleEditMemo","useState","bg","setBg","useEffect","length","matchingRule","find","item","indexOf","setTimeout","timer","background","default","style","ListItem","onClick","selected","className","clsx","ListItemText","ListItemIcon","Tooltip","title","I18n","t","IconButton","Box","ItemTypes","DropTarget","hover","monitor","component","node","dragIndex","getItem","hoverIndex","hoverBoundingRect","getBoundingClientRect","hoverMiddleY","bottom","hoverClientY","getClientOffset","y","moveRule","connect","dropTarget","DragSource","beginDrag","dragSource","CustomTooltip","withStyles","tooltip","fontSize","LeftBar","textCommand","isSettingsDialogOpen","isConfirmRemoveDialogOpen","isSearchActive","filteredRules","searchedValue","localSettings","language","processorId","processorTimeout","sayitInstance","toast","alive","getDefaultSettings","setState","settings","onAlive","val","onResponse","toastError","socket","getState","instance","handleTextCommand","event","target","value","testTimer","clearTimeout","matched","findMatchingRules","map","number","handleSubmit","iconPlay","key","err","handleOpenSettingsModal","handleDialogSelectIdSubmit","selectedSettingsName","handleDelete","removeRule","handleCloseConfirmRemoveDialog","handleSearch","matchedRules","rules","filter","toLowerCase","includes","toggleSearch","a","createSettingsModal","handleClose","isSettingsWasNotSaved","handleChange","undefined","checked","Dialog","open","onClose","fullWidth","onExited","DialogTitle","Typography","variant","align","DialogContent","noValidate","autoComplete","FormControl","root","settingsItem","InputLabel","Select","width100","onChange","MenuItem","Children","toArray","option","TextField","label","showDialogSelectId","helperText","e","FormControlLabel","control","Checkbox","writeEveryAnswer","DialogActions","Button","saveSettings","mainIcons","icon","handler","handleOpen","createIcons","iconsData","this","subscribeState","document","getElementsByClassName","scrollIntoView","unsubscribeState","prevProps","prevState","findMatched","JSON","parse","stringify","imagePrefix","onOk","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Alert","elevation","severity","isMobile","closeDrawer","settingsDialog","renderedRules","additionalIcons","push","main","Toolbar","toolbar","search","InputProps","endAdornment","autoFocus","closeBtn","flexGrow","iconNotAlive","DndProvider","backend","HTML5Backend","List","list","test","size","onKeyDown","inputProps","padding","play","renderConfirmDialog","renderSelectIdDialog","renderToast","Component","boxSizing","minWidth","overflowX","overflowY","header","minHeight","border","divider","textInput","breakpoints","down","settingsTitle","maxWidth","marginBottom","settingsContent","flexDirection","display","common","white","float","flexBasis","RightBar","defaultState","editable","args","ack","localRule","showDialog","createConfirmModalActions","updateConfig","pendingSelectedRuleId","clearStateOnConfirmModalUnmount","revertChangesFromConfig","cancelSavingChanges","closeConfirmDialog","dontSaveAndGo","handleSaveAndGo","submitForm","saveAndGoBtn","btnDanger","createSaveSettingsForm","handleSave","isLocalStateWasUpdated","revertChanges","emptyButtons","confirmChanges","createInput","type","note","disabled","keywords","onSwitchChange","textField","switchControl","Switch","createOptionsData","handlers","isKeyWordsDisabled","keywordsText","breakOnSwitch","handleSetDialogClick","bind","param1OnSwitch","param2Text","param2OnSwitch","confirmText","confirmOnSwitch","createInputHandlers","_this","arg","unsavedRule","isEqual","wasChangedGlobally","removeUnsavedRule","setUnsavedRule","lang","forceUpdate","isLeftBarHidden","toggleLeftBar","mt","box","boxMobile","boxDesktop","Paper","container","mx","mainTitle","justifyContent","mb","row","toggleIcon","PureComponent","margin","alignItems","textAlign","marginLeft","marginRight","left","noRulesText","light","CreateRuleDialog","defaultRule","isDisabled","setRuleOnMount","isEdit","cleanState","finishEdit","getAvailableOptions","commands","currentRules","uniqueOptions","unique","concat","getUniqueName","ruleName","matchingNames","slice","isUnique","lastChar","createForm","FormGroup","shrink","isError","labelId","select","existingNames","setDialogContent","handleSubmitOnCreate","handleSubmitOnEdit","onSubmitHandler","isOpen","onEnter","Layout","getSelectedLanguageCommands","getLanguage","Object","entries","command","rest","template","sourceRule","_","sortRules","splice","uuid","shortDataRule","isUnsavedChanges","values","updateCurrentRules","isLeftBarOpen","editableRule","updatedRule","updatedRuleOptions","deleteRuleFromConfig","readConfig","newConfig","saveConfig","updatedRules","currentSelectedRule","ids","updatedCurrentRules","getRuleShortData","getDataFromConfig","obj","ready","localStorage","isRuleWasUpdatedGlobally","localeSettings","closeModal","setItem","menuSize","parseFloat","rulesWithId","en","setLanguage","Fragment","Drawer","anchor","renderModalDialog","customClassName","hidden","opened","layout","primaryMinSize","primaryIndex","secondaryMinSize","onSecondaryPaneSizeChange","onDragEnd","toString","secondaryInitialSize","withWidth","App","extendedProps","translations","require","newState","getSystemConfig","systemConfig","showError","getObject","adapterName","native","setObject","renderError","themeType","GenericApp","logo","themeName","Utils","getThemeName","version","host","Sentry","dsn","release","integrations","SentryIntegrations","build","ReactDOM","render","onThemeChange","_theme","getElementById","URL","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.018910c7.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === \"localhost\" ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === \"[::1]\" ||\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\n\t\twindow.location.hostname.match(\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n\t\t)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener(\"load\", () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\"This web app is being served cache-first by a service \" +\n\t\t\t\t\t\t\t\"worker. To learn more, visit http://bit.ly/CRA-PWA\"\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === \"installed\") {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t\"New content is available and will be used when all \" +\n\t\t\t\t\t\t\t\t\t\"tabs for this page are closed. See http://bit.ly/CRA-PWA.\"\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log(\"Content is cached for offline use.\");\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error(\"Error during service worker registration:\", error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl)\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get(\"content-type\");\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null && contentType.indexOf(\"javascript\") === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log(\n\t\t\t\t\"No internet connection found. App is running in offline mode.\"\n\t\t\t);\n\t\t});\n}\n\nexport function unregister() {\n\tif (\"serviceWorker\" in navigator) {\n\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\tregistration.unregister();\n\t\t});\n\t}\n}\n","import React, {\n    useRef,\n    useImperativeHandle,\n    useCallback,\n    useState,\n    useEffect,\n} from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { DropTarget, DragSource } from 'react-dnd';\n\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport IconButton from '@material-ui/core/IconButton';\nimport Box from '@material-ui/core/Box';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\n\nimport I18n from '@iobroker/adapter-react/i18n';\n\nimport EditIcon from '@material-ui/icons/Edit';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport MaximizeIcon from '@material-ui/icons/Maximize';\n\nconst Rule = React.forwardRef((props, ref) => {\n    const {\n        name,\n        handleEdit,\n        rule,\n        isDragging,\n        connectDragSource,\n        connectDropTarget,\n        id,\n        selectRule,\n        selectedRule,\n        _break,\n        matchingRules,\n        unsavedRules,\n        index,\n        theme,\n        removeMatched,\n        words,\n    } = props;\n\n    const classes = makeStyles({\n        listItem: {\n            cursor: 'pointer',\n            transition: 'background-color 0.3s linear',\n            position: 'relative',\n        },\n        listItemText: {\n            '& span': {\n                color: theme.palette.text.primary,\n            },\n            '& p': {\n                color: theme.palette.text.secondary,\n                textOverflow: 'ellipsis',\n                overflow: 'hidden',\n            },\n        },\n        dot: {\n            position: 'absolute',\n            backgroundColor: 'red',\n            top: 5,\n            right: 15,\n            width: 10,\n            height: 10,\n            borderRadius: '50%',\n        },\n        maximize: {\n            color: theme.palette.error?.dark,\n            marginTop: theme.spacing(1),\n        },\n        ruleButton: {\n            paddingTop: theme.spacing(1.5),\n        }\n    })();\n\n    const elementRef = useRef(null);\n    connectDragSource(elementRef);\n    connectDropTarget(elementRef);\n    const opacity = isDragging ? 0 : 1;\n    useImperativeHandle(ref, () => ({\n        getNode: () => elementRef.current,\n    }));\n\n    const selectRuleMemo = useCallback(() => selectRule(id), [id, selectRule]);\n    const handleEditMemo = useCallback(() => handleEdit(id), [id, handleEdit]);\n\n    const [bg, setBg] = useState('');\n\n    useEffect(() => {\n        if (matchingRules.length) {\n            const matchingRule = matchingRules.find(item => item.indexOf === index);\n            if (matchingRule) {\n                setTimeout(() => setBg(theme?.palette?.secondary.dark), matchingRule.timer);\n                setTimeout(() => {\n                    setBg(selectedRule.id === id ? theme?.palette?.background?.default : '');\n                    if (_break || index === matchingRules[matchingRules.length - 1].indexOf) removeMatched();\n                }, 1500 * (matchingRule.index + 1));\n            } // only when matching rules have been changed\n        } // eslint-disable-next-line\n    }, [matchingRules]);\n\n    let secondary = rule !== name ? rule || '' : '';\n    secondary += `${secondary ? ' ' : ''}[${words}]`;\n    return <div\n        ref={elementRef}\n        style={{\n            opacity,\n            backgroundColor: bg,\n        }}>\n        <ListItem\n            onClick={selectRuleMemo}\n            selected={selectedRule?.id === id}\n            className={clsx(classes.listItem, selectedRule?.id === id && 'rule-selected')}>\n            <ListItemText\n                primary={name}\n                secondary={secondary}\n                className={classes.listItemText}\n            />\n            <ListItemIcon>\n                {\n                    _break ?\n                        <Tooltip title={I18n.t('Interrupt processing')}>\n                            <MaximizeIcon className={clsx(classes.ruleButton, classes.maximize)} />\n                        </Tooltip>\n                    :\n                        <Tooltip title={I18n.t('Do not interrupt processing')}><ArrowDownwardIcon className={classes.ruleButton} color=\"primary\"/></Tooltip>\n                }\n                <Tooltip title={I18n.t('Edit name or type of rule')}><IconButton onClick={handleEditMemo}><EditIcon /></IconButton></Tooltip>\n            </ListItemIcon>\n            {unsavedRules[id] && <Box className={classes.dot} />}\n        </ListItem>\n    </div>;\n});\n\nconst ItemTypes = {\n    RULE: 'rule',\n};\n\nexport default DropTarget(\n    ItemTypes.RULE,\n    {\n        hover(props, monitor, component) {\n            if (!component) {\n                return null;\n            }\n\n            const node = component.getNode();\n            if (!node) {\n                return null;\n            }\n            const dragIndex = monitor.getItem().index;\n            const hoverIndex = props.index;\n            if (dragIndex === hoverIndex) {\n                return;\n            }\n\n            const hoverBoundingRect = node.getBoundingClientRect();\n            const hoverMiddleY = (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\n            const clientOffset = monitor.getClientOffset();\n            const hoverClientY = clientOffset.y - hoverBoundingRect.top;\n            if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\n                return;\n            }\n            if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\n                return;\n            }\n            props.moveRule(dragIndex, hoverIndex);\n\n            monitor.getItem().index = hoverIndex;\n        },\n    },\n    connect => ({ connectDropTarget: connect.dropTarget() })\n)(\n    DragSource(\n        ItemTypes.RULE,\n        {\n            beginDrag: props => ({\n                id: props.id,\n                index: props.index,\n            }),\n        },\n        (connect, monitor) => ({\n            connectDragSource: connect.dragSource(),\n            isDragging: monitor.isDragging(),\n        })\n    )(Rule)\n);\n\nRule.propTypes = {\n    removeRule: PropTypes.func,\n    name: PropTypes.string.isRequired,\n    theme: PropTypes.object.isRequired,\n    isDragging: PropTypes.bool,\n    connectDropTarget: PropTypes.func,\n    connectDragTarget: PropTypes.func,\n    _break: PropTypes.bool.isRequired,\n    selectRule: PropTypes.func.isRequired,\n    id: PropTypes.string.isRequired,\n    matchingRules: PropTypes.array,\n    selectedRule: PropTypes.shape({\n        id: PropTypes.string,\n    }),\n    unsavedRules: PropTypes.object,\n};\n","import React, { Component, Children } from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport withStyles from '@material-ui/core/styles/withStyles';\n\n// Material UI Components\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport List from '@material-ui/core/List';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport Box from '@material-ui/core/Box';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport Button from '@material-ui/core/Button';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport IconButton from '@material-ui/core/IconButton';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport Alert from '@material-ui/lab/Alert';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox from '@material-ui/core/Checkbox';\n\n// icons\nimport AddIcon from '@material-ui/icons/Add';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport CachedIcon from '@material-ui/icons/Cached';\nimport CloseIcon from '@material-ui/icons/Close';\nimport SearchIcon from '@material-ui/icons/Search';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport FormatClearIcon from '@material-ui/icons/FormatClear';\nimport ClearIcon from '@material-ui/icons/Close';\nimport WarningIcon from '@material-ui/icons/Warning';\n\nimport I18n from '@iobroker/adapter-react/i18n';\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\n\nimport Rule from './Rule';\n\nconst styles = theme => ({\n    test: {\n        width: '100%',\n        boxSizing: 'border-box',\n        height: 64,\n    },\n    main: {\n        minWidth: 300,\n        overflow: 'hidden',\n        height: '100%',\n    },\n    toolbar: {\n        background: theme.palette.primary.main,\n        position: 'relative',\n    },\n    list: {\n        height: 'calc(100% - 64px - 64px - 18px)',\n        overflowX: 'hidden',\n        overflowY: 'auto',\n    },\n    root: {\n        width: 'calc(100% - 48px)',\n        // '& .MuiInputLabel-outlined-70.MuiInputLabel-marginDense-66': {\n        //     transform: '',\n        // },\n    },\n    header: {\n        minHeight: 44,\n        height: 'auto',\n        padding: theme.spacing(1.3),\n        border: `1px solid ${theme.palette.divider}`,\n    },\n    textInput: {\n        width: '60%',\n        [theme.breakpoints.down('sm')]: {\n            width: '100%',\n        },\n    },\n    settingsTitle: {\n        fontSize: '20px',\n        maxWidth: 145,\n        [theme.breakpoints.down('sm')]: {\n            marginBottom: theme.spacing(1),\n        },\n    },\n    settingsContent: {\n        [theme.breakpoints.down('sm')]: {\n            flexDirection: 'column',\n            display: 'flex',\n        },\n    },\n    closeBtn: {\n        position: 'absolute',\n        top: 0,\n        right: 0,\n        color: theme.palette.common.white,\n    },\n    iconNotAlive: {\n        color: '#ffc10a',\n        float: 'right'\n    },\n    search: {\n        flexBasis: '80%',\n        [theme.breakpoints.down('sm')]: {\n            flexBasis: '70%',\n        },\n    },\n    settingsItem: {\n        marginBottom: theme.spacing(3),\n    },\n    width100: {\n        width: '100%',\n    },\n});\n\nconst tooltipStyles = theme => ({\n    tooltip: {\n        fontSize: 14,\n    },\n});\n\nconst CustomTooltip = withStyles(tooltipStyles)(Tooltip);\n\nclass LeftBar extends Component {\n    state = {\n        textCommand: '',\n        matchingRules: [],\n        isSettingsDialogOpen: false,\n        isConfirmRemoveDialogOpen: false,\n        isSearchActive: false,\n        filteredRules: [],\n        searchedValue: '',\n        localSettings: {\n            language: '',\n            processorId: '',\n            processorTimeout: 1000,\n            sayitInstance: '',\n        },\n        toast: null,\n        alive: false,\n    };\n\n    componentDidMount() {\n        this.props.socket.subscribeState('text2command.' + this.props.instance + '.response', this.onResponse);\n        this.props.socket.subscribeState('system.adapter.text2command.' + this.props.instance + '.alive', this.onAlive);\n        if (this.props.selectedRule && this.props.selectedRule.id) {\n            //scroll to\n            setTimeout(() => {\n                const rules = window.document.getElementsByClassName('rule-selected');\n                if (rules.length) {\n                    rules[0].scrollIntoView()\n                }\n            }, 50);\n        }\n    }\n\n    componentWillUnmount() {\n        this.props.socket.unsubscribeState('text2command.' + this.props.instance + '.response', this.onResponse);\n        this.props.socket.unsubscribeState('system.adapter.text2command.' + this.props.instance + '.alive', this.onAlive);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props.settings !== prevProps.settings && this.props.settings) {\n            this.getDefaultSettings();\n        }\n    }\n\n    getDefaultSettings = () => {\n        this.setState({\n            localSettings: {\n                ...this.props.settings,\n            },\n        });\n    };\n\n    onAlive = (id, state) => {\n        if (state && state.val) {\n            !this.state.alive && this.setState({alive: true});\n        } else {\n            this.state.alive && this.setState({alive: false});\n        }\n    };\n\n    onResponse = (id, state) => {\n        if (this.state.toast === null) {\n            this.setState({toast: '', toastError: false});\n        } else\n        if (state) {\n            if (state.val && state.val.match(/^Error\\.|^Fehler\\.|^Ошибка\\./)) {\n                this.props.socket.getState('text2command.' + this.props.instance + '.error')\n                    .then(state =>\n                        this.setState({toast: state && state.val ? state.val : (state.val || ''), toastError: true}));\n            } else {\n                this.setState({toast: state.val || '', toastError: false});\n            }\n        }\n    };\n\n    handleTextCommand = event => {\n        this.setState({textCommand: event.target.value}, () => {\n            this.testTimer && clearTimeout(this.testTimer);\n            this.testTimer = setTimeout(() => {\n                const matched = this.findMatchingRules();\n                this.setState({\n                    matchingRules: matched.map((number, index) => ({\n                        indexOf: number,\n                        timer: index * 1500,\n                        index,\n                    })),\n                });\n            }, 500);\n        });\n    };\n\n    handleSubmit = (event, iconPlay) => {\n        if ((event && event.key === 'Enter') || iconPlay) {\n            this.props.socket.setState('text2command.' + this.props.instance + '.text', this.state.textCommand)\n                .catch(err => console.error(err));\n\n            if (!this.state.alive) {\n                this.setState({toast: I18n.t('Instance is not running'), toastError: true});\n            }\n        }\n    };\n\n    removeMatched = () => {\n        this.setState({\n            matchingRules: [],\n        });\n    };\n\n    findMatchingRules() {\n        const text = this.state.textCommand;\n        return text ? window.findMatched(text, JSON.parse(JSON.stringify(this.props.rules))) : [];\n    }\n\n    handleOpenSettingsModal = () => {\n        this.setState({\n            isSettingsDialogOpen: true,\n        });\n    };\n\n    handleDialogSelectIdSubmit = (selected, selectedSettingsName) => {\n        this.setState({\n            localSettings: {\n                ...this.state.localSettings,\n                [selectedSettingsName]: selected,\n            },\n        });\n    };\n\n    handleDelete = () => {\n        this.props.removeRule(this.props.selectedRule.id);\n        this.handleCloseConfirmRemoveDialog();\n    };\n\n    handleCloseConfirmRemoveDialog = () => {\n        this.setState({\n            isConfirmRemoveDialogOpen: false,\n        });\n    };\n\n    handleSearch = event => {\n        const matchedRules = this.props.rules.filter(rule =>\n            rule.name.toLowerCase().includes(event.target.value.toLowerCase()));\n        this.setState({\n            filteredRules: matchedRules || [],\n            searchedValue: event.target.value,\n        });\n    };\n\n    toggleSearch = async () => {\n        await this.setState({\n            isSearchActive: !this.state.isSearchActive,\n        });\n    };\n\n    createSettingsModal = () => {\n        const { t } = I18n;\n        const options = ['en', 'de', 'ru'];\n        const { classes } = this.props;\n\n        const handleClose = () => {\n            this.setState({\n                isSettingsDialogOpen: false,\n                isSettingsWasNotSaved: true,\n            });\n        };\n\n        const submitSettings = () => {\n            this.props.saveSettings(this.state.localSettings, handleClose);\n        };\n\n        const handleChange = (event, name) => {\n            let value = event.target.checked !== undefined ? event.target.checked : event.target.value;\n            if (name === 'language' && value === 'system') {\n                value = '';\n            }\n\n            this.setState({\n                localSettings: {\n                    ...this.state.localSettings,\n                    [name]: value,\n                },\n            });\n        };\n\n        return (\n            <Dialog\n                open={this.state.isSettingsDialogOpen}\n                onClose={handleClose}\n                fullWidth\n                onExited={this.getDefaultSettings}>\n                <DialogTitle>\n                    <Typography variant=\"h4\" component=\"span\" align=\"center\">\n                        {t('Settings')}\n                    </Typography>\n                </DialogTitle>\n                <DialogContent>\n                    <form noValidate autoComplete=\"off\">\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                            <InputLabel id=\"demo-simple-select-label\">{t('Language')}</InputLabel>\n                            <Select\n                                classes={{ root: classes.width100 }}\n                                onChange={event => handleChange(event, 'language')}\n                                value={\n                                    !this.state.localSettings.language\n                                        ? 'system'\n                                        : this.state.localSettings.language\n                                }>\n                                <MenuItem value=\"system\">{t('System')}</MenuItem>\n                                {Children.toArray(\n                                    options.map(option => (\n                                        <MenuItem value={option}>{t('lang_' + option)}</MenuItem>\n                                    ))\n                                )}\n                            </Select>\n                        </FormControl>\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                            <TextField\n                                label={t('Answer in id')}\n                                value={this.state.localSettings.sayitInstance}\n                                onClick={() =>\n                                    this.setState({\n                                        showDialogSelectId: true,\n                                        selectedSettingsName: 'sayitInstance',\n                                    })\n                                }\n                            />\n                        </FormControl>\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                            <TextField\n                                label={t(`Processor's id`)}\n                                value={this.state.localSettings.processorId}\n                                onClick={() =>\n                                    this.setState({\n                                        showDialogSelectId: true,\n                                        selectedSettingsName: 'processorId',\n                                    })\n                                }\n                            />\n                        </FormControl>\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                            <TextField\n                                label={t('Timeout for processor')}\n                                helperText={t('ms')}\n                                value={this.state.localSettings.processorTimeout}\n                                onChange={e => handleChange(e, 'processorTimeout')}\n                            />\n                        </FormControl>\n                        <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                            <FormControlLabel\n                                control={<Checkbox checked={this.state.localSettings.writeEveryAnswer} onChange={e => handleChange(e, 'writeEveryAnswer')} />}\n                                label={t('Write to response by every command')}\n                            />\n                        </FormControl>\n                    </form>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={submitSettings}>Ok</Button>\n                    <Button onClick={handleClose}>{I18n.t('Cancel')}</Button>\n                </DialogActions>\n            </Dialog>\n        );\n    };\n\n    mainIcons = [\n        {\n            icon: <AddIcon />,\n            handler: () => this.props.handleOpen(),\n            tooltip: I18n.t('Create rule'),\n        },\n        {\n            icon: <SettingsIcon />,\n            handler: () => this.handleOpenSettingsModal(),\n            tooltip: I18n.t('Settings'),\n        },\n        {\n            icon: <CachedIcon />,\n            handler: () => console.log('refresh'),\n            tooltip: I18n.t('Refresh'),\n        },\n    ];\n\n    createIcons = iconsData =>\n        iconsData.map(({ icon, handler, tooltip }, index) => (\n            <CustomTooltip title={tooltip} key={index}>\n                <IconButton onClick={handler}>{icon}</IconButton>\n            </CustomTooltip>\n        ));\n\n    renderSelectIdDialog() {\n        return this.state.showDialogSelectId ? (\n            <DialogSelectID\n                imagePrefix={'../..'}\n                socket={this.props.socket}\n                title={'Select ID'}\n                onClose={() => this.setState({ showDialogSelectId: false })}\n                onOk={selected =>\n                    this.handleDialogSelectIdSubmit(selected, this.state.selectedSettingsName)\n                }\n            />\n        ) : null;\n    }\n\n    renderConfirmDialog() {\n        return this.state.isConfirmRemoveDialogOpen ? (\n            <Dialog\n                open={this.state.isConfirmRemoveDialogOpen}\n                onClose={this.handleCloseConfirmRemoveDialog}\n                fullWidth>\n                <DialogTitle>{I18n.t('Are you sure?')}</DialogTitle>\n                <DialogContent>\n                    <Typography variant=\"h5\" component=\"h5\">\n                        {I18n.t('You want to delete') + ': '}\n                        <strong>{this.props.selectedRule.name}</strong>\n                    </Typography>\n                    <DialogActions>\n                        <Button onClick={this.handleDelete}>{I18n.t('Ok')}</Button>\n                        <Button onClick={this.handleCloseConfirmRemoveDialog} color=\"primary\">\n                            {I18n.t('Cancel')}\n                        </Button>\n                    </DialogActions>\n                </DialogContent>\n            </Dialog>\n        ) : null;\n    }\n\n    renderToast() {\n        if (this.state.toast) {\n            return <Snackbar\n                anchorOrigin={{\n                    vertical: 'top',\n                    horizontal: 'right',\n                }}\n                open={true}\n                autoHideDuration={4000}\n                onClose={() => this.setState({toast: ''})}\n            >\n                {\n                    this.state.toastError ?\n                        <Alert elevation={6} variant=\"filled\" onClose={() => this.setState({toast: ''})} severity=\"error\">{this.state.toast}</Alert>\n                        :\n                        <Alert elevation={6} variant=\"filled\" onClose={() => this.setState({toast: ''})} severity=\"success\">{this.state.toast}</Alert>\n                }\n            </Snackbar>\n        } else {\n            return null;\n        }\n    }\n\n    render() {\n        const {\n            selectedRule,\n            moveRule,\n            handleEdit,\n            rules,\n            selectRule,\n            classes,\n            isMobile,\n            closeDrawer,\n        } = this.props;\n        const { filteredRules, isSearchActive, searchedValue } = this.state;\n        const settingsDialog = this.createSettingsModal();\n        const renderedRules = isSearchActive && searchedValue.length ? filteredRules : rules;\n        const additionalIcons = [];\n\n        selectedRule &&\n            selectedRule.id &&\n            additionalIcons.push({\n                icon: !isSearchActive && <DeleteIcon />,\n                handler: () =>\n                    this.setState({\n                        isConfirmRemoveDialogOpen: true,\n                    }),\n                tooltip: I18n.t('Remove rule'),\n                key: 'delete',\n            });\n\n        rules.length &&\n            additionalIcons.push({\n                icon: isSearchActive ? <FormatClearIcon /> : <SearchIcon />,\n                handler: () => this.toggleSearch(),\n                tooltip: I18n.t('Search rule'),\n                key: 'search',\n            });\n\n        return <Box className={classes.main}>\n            <Toolbar position=\"static\" classes={{ root: classes.toolbar }}>\n                {isSearchActive ? (\n                    <TextField\n                        className={classes.search}\n                        onChange={this.handleSearch}\n                        value={this.state.searchedValue}\n                        InputProps={{\n                            endAdornment: this.state.searchedValue ? (\n                                <IconButton\n                                    onClick={() => this.setState({ searchedValue: '' })}>\n                                    <ClearIcon />\n                                </IconButton>\n                            ) : undefined,\n                        }}\n                        autoFocus\n                    />\n                ) : (\n                    <div>{this.createIcons(this.mainIcons)}</div>\n                )}\n                <div>{this.createIcons(additionalIcons)}</div>\n                {isMobile && (\n                    <IconButton className={classes.closeBtn} onClick={closeDrawer}>\n                        <CloseIcon />\n                    </IconButton>\n                )}\n                {!isSearchActive && !this.state.alive ? <div style={{flexGrow: 1}}/> : null}\n                {!isSearchActive && !this.state.alive ? <Tooltip title={I18n.t('Instance is not running')}><WarningIcon className={classes.iconNotAlive}/></Tooltip> : null}\n\n            </Toolbar>\n\n            <DndProvider backend={HTML5Backend}>\n                <List className={classes.list}>\n                    {renderedRules.map((rule, index) => (\n                        <Rule\n                            theme={this.props.theme}\n                            handleEdit={handleEdit}\n                            {...rule}\n                            index={index}\n                            moveRule={moveRule}\n                            key={rule.id}\n                            selectRule={selectRule}\n                            selectedRule={selectedRule}\n                            matchingRules={this.state.matchingRules}\n                            unsavedRules={this.props.unsavedRules}\n                            removeMatched={this.removeMatched}\n                        />\n                    ))}\n                </List>\n            </DndProvider>\n\n            <Toolbar className={classes.test} variant=\"dense\">\n                <TextField\n                    onChange={this.handleTextCommand}\n                    label={I18n.t('Test phrase')}\n                    variant=\"outlined\"\n                    size=\"small\"\n                    color=\"primary\"\n                    className={clsx('outlined-basic', classes.root)}\n                    onKeyDown={this.handleSubmit}\n                    value={this.state.textCommand}\n                    inputProps={{\n                        style: {\n                            padding: '10px 10px',\n                        },\n                    }}\n                    InputProps={{\n                        endAdornment: this.state.textCommand ? (\n                            <IconButton onClick={() => this.setState({ textCommand: '' })}>\n                                <ClearIcon />\n                            </IconButton>\n                        ) : undefined,\n                    }}\n                />\n                <IconButton\n                    variant=\"outlined\"\n                    onClick={event => this.handleSubmit(event, true)}>\n                    <PlayArrowIcon className={classes.play} />\n                </IconButton>\n            </Toolbar>\n\n            {settingsDialog}\n\n            {this.renderConfirmDialog()}\n            {this.renderSelectIdDialog()}\n            {this.renderToast()}\n        </Box>;\n    }\n}\n\nexport default withStyles(styles)(LeftBar);\n\nLeftBar.propTypes = {\n    handleOpen: PropTypes.func.isRequired,\n    rules: PropTypes.arrayOf(\n        PropTypes.shape({\n            id: PropTypes.string,\n        })\n    ),\n    instance: PropTypes.number.isRequired,\n    moveRule: PropTypes.func.isRequired,\n    selectRule: PropTypes.func.isRequired,\n    theme: PropTypes.object.isRequired,\n    selectedRule: PropTypes.shape({\n        id: PropTypes.string,\n    }),\n    removeRule: PropTypes.func,\n    handleEdit: PropTypes.func.isRequired,\n    classes: PropTypes.object.isRequired,\n    settings: PropTypes.object,\n    socket: PropTypes.object.isRequired,\n    saveSettings: PropTypes.func.isRequired,\n    unsavedRules: PropTypes.object,\n    toggleLeftBar: PropTypes.func,\n    isMobile: PropTypes.bool.isRequired,\n    closeDrawer: PropTypes.func,\n};\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\n\nimport { TextField, Switch, Typography, withStyles, Box } from '@material-ui/core';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport FormControl from '@material-ui/core/FormControl';\nimport Button from '@material-ui/core/Button';\nimport Paper from '@material-ui/core/Paper';\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport MenuIcon from '@material-ui/icons/Menu';\n\nimport I18n from '@iobroker/adapter-react/i18n';\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\nimport isEqual from 'lodash.isequal';\n\nconst styles = theme => ({\n    root: {\n        width: '100%',\n        height: '100%',\n        padding: 0,\n        margin: 0,\n        position: 'relative',\n    },\n    box: {\n        display: 'inline-flex',\n        justifyContent: 'space-around',\n        position: 'relative',\n        '& .outlined-basic': {\n            padding: '12px 10px',\n            //border: `2px solid ${theme.palette.grey[700]}`,\n        },\n        [theme.breakpoints.down('md')]: {\n            '& .outlined-basic': {\n                padding: 0,\n            },\n        },\n    },\n    boxMobile: {\n        padding: 0,\n        width: '100%',\n        marginTop: theme.spacing(1),\n        height: '100%',\n        overflow: 'hidden'\n    },\n    boxDesktop: {\n        padding: theme.spacing(2),\n        width: 'calc(100% - ' + theme.spacing(4) + 'px)',\n        marginTop: 30,\n    },\n    container: {\n        width: 'calc(100% - 32px)',\n        padding: theme.spacing(2),\n        height: '100%',\n        overflow: 'auto',\n        [theme.breakpoints.down('md')]: {\n            width: 'calc(100% - ' + theme.spacing(3) + 'px)',\n            padding: theme.spacing(1),\n        },\n    },\n    textField: {\n        flexBasis: '60%',\n        [theme.breakpoints.down('sm')]: {\n            width: '100%',\n            marginTop: theme.spacing(1),\n        },\n    },\n    submitForm: {\n        flexDirection: 'row',\n        margin: '10px auto 20px',\n        display: 'flex',\n        justifyContent: 'center',\n        width: '100%',\n        [theme.breakpoints.down('xs')]: {\n            flexDirection: 'column',\n        },\n    },\n    mainTitle: {\n        marginBottom: '30px',\n    },\n    title: {\n        marginTop: 16,\n        [theme.breakpoints.down('md')]: {\n            maxWidth: 200,\n        },\n        [theme.breakpoints.down('sm')]: {\n            width: '100%',\n            maxWidth: 'none',\n        },\n    },\n    row: {\n        [theme.breakpoints.down('md')]: {\n            alignItems: 'center',\n        },\n        [theme.breakpoints.down('sm')]: {\n            flexDirection: 'column',\n            alignItems: 'flex-start',\n            textAlign: 'center',\n        },\n    },\n    btnDanger: {\n        marginLeft: 20,\n        [theme.breakpoints.down('xs')]: {\n            marginLeft: 0,\n            marginTop: theme.spacing(0.5),\n        },\n        //backgroundColor: theme.palette.error?.dark,\n    },\n    saveAndGoBtn: {\n        marginRight: 20,\n        [theme.breakpoints.down('xs')]: {\n            marginRight: 0,\n            marginBottom: theme.spacing(0.5),\n        },\n    },\n    toggleIcon: {\n        position: 'absolute',\n        opacity: 0.8,\n        top: 10,\n        left: 0,\n        backgroundColor: theme.palette.primary.main,\n        width: 20,\n        height: 25,\n        cursor: 'pointer',\n        padding: theme.spacing(1),\n        borderRadius: '0 5px 5px 0',\n    },\n    switchControl: {\n        paddingTop: theme.spacing(1),\n        flexBasis: '60%',\n    },\n    emptyButtons: {\n        height: 36,\n        [theme.breakpoints.down('sm')]: {\n            height: 0,\n        },\n    },\n    noRulesText: {\n        fontSize: 24,\n        color: theme.palette.primary.light\n    },\n});\n\nclass RightBar extends PureComponent {\n    defaultState = {\n        words: I18n.t('Create Rule'),\n        name: I18n.t('Create Rule'),\n        _break: false,\n        editable: false,\n        args: [\n            {\n                default: I18n.t('Argument') + ' 1',\n            },\n            {\n                default: I18n.t('Argument') + ' 2',\n            },\n        ],\n        ack: {\n            name: '',\n            default: `${I18n.t('Confirmation text')}`,\n        },\n        id: 0,\n    };\n\n    state = {\n        localRule: null,\n        showDialog: false,\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        if ((!props.selectedRule && state.localRule) ||\n            (props.selectedRule && !state.localRule) ||\n            (props.selectedRule?.id !== state.localRule?.id)) {\n            return {\n                localRule: {...props.selectedRule}\n            };\n        } else {\n            return null;\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (\n            prevProps.selectedRule?.name !== this.props.selectedRule?.name ||\n            prevState.localRule?.name !== this.state.localRule?.name\n        ) {\n            if (!this.props.selectedRule || !this.props.selectedRule.name) {\n                this.setState({\n                    localRule: null,\n                });\n            } else {\n                this.setState({\n                    localRule: {\n                        ...this.props.selectedRule,\n                    },\n                });\n            }\n        } else if (this.state.isLocalStateWasUpdated) {\n            const unsavedRule = this.props.unsavedRules[this.state.localRule.id];\n\n            if (\n                isEqual(this.props.selectedRule, this.state.localRule) &&\n                !unsavedRule?.wasChangedGlobally\n            ) {\n                this.setState({\n                    isLocalStateWasUpdated: false,\n                });\n\n                if (!unsavedRule?.wasChangedGlobally) {\n                    this.props.removeUnsavedRule(this.state.localRule.id);\n                }\n            } else if (!unsavedRule && !this.props.pendingSelectedRuleId) {\n                this.props.setUnsavedRule(this.state.localRule.id);\n            }\n        } else if (\n            !this.state.isLocalStateWasUpdated &&\n            this.props.unsavedRules[this.state.localRule.id]\n        ) {\n            this.setState({\n                isLocalStateWasUpdated: true,\n            });\n        }\n\n        if (this.props.pendingSelectedRuleId && this.state.isLocalStateWasUpdated) {\n            if (this.props.pendingSelectedRuleId === this.state.localRule.id) {\n                return;\n            }\n            this.setState({\n                confirmChanges: true,\n            });\n        }\n\n        if (this.props.lang !== prevProps.lang) {\n            this.forceUpdate();\n        }\n    }\n\n    componentDidMount() {\n        if (!this.state.localRule && this.props.selectedRule) {\n            this.setState({\n                localRule: this.props.selectedRule,\n            });\n        }\n    }\n\n    createConfirmModalActions = () => {\n        const { t } = I18n;\n        const {\n            updateConfig,\n            classes,\n            selectRule,\n            pendingSelectedRuleId,\n            clearStateOnConfirmModalUnmount,\n            revertChangesFromConfig,\n        } = this.props;\n        const { localRule } = this.state;\n\n        const cancelSavingChanges = async () => {\n            await clearStateOnConfirmModalUnmount();\n            this.closeConfirmDialog();\n        };\n\n        const dontSaveAndGo = async () => {\n            await revertChangesFromConfig(localRule);\n            await selectRule(pendingSelectedRuleId);\n            await clearStateOnConfirmModalUnmount(localRule.id);\n\n            this.closeConfirmDialog();\n        };\n        const handleSaveAndGo = async () => {\n            await updateConfig(localRule);\n            await selectRule(pendingSelectedRuleId);\n            await clearStateOnConfirmModalUnmount();\n\n            this.closeConfirmDialog();\n        };\n        return (\n            <FormControl className={classes.submitForm}>\n                <Button\n                    variant=\"contained\"\n                    onClick={handleSaveAndGo}\n                    color=\"primary\"\n                    className={classes.saveAndGoBtn}>\n                    {t('Save and go')}\n                </Button>\n                <Button onClick={dontSaveAndGo} variant=\"contained\" color=\"secondary\">\n                    {t(`Don't save and go`)}\n                </Button>\n                <Button\n                    variant=\"contained\"\n                    className={classes.btnDanger}\n                    onClick={cancelSavingChanges}>\n                    {t('Cancel')}\n                </Button>\n            </FormControl>\n        );\n    };\n\n    createSaveSettingsForm = () => {\n        const { t } = I18n;\n        const { updateConfig, classes, revertChangesFromConfig, selectedRule } = this.props;\n        const { localRule } = this.state;\n\n        const handleSave = async () => {\n            await updateConfig(localRule);\n            this.setState({\n                isLocalStateWasUpdated: false,\n            });\n        };\n\n        const revertChanges = async () => {\n            await revertChangesFromConfig(localRule);\n\n            await this.setState({\n                localRule: selectedRule,\n                isLocalStateWasUpdated: false,\n            });\n        };\n\n        if (!this.state.isLocalStateWasUpdated) {\n            return <div className={this.props.classes.emptyButtons} />;\n        } else {\n            return (\n                <FormControl className={classes.submitForm}>\n                    <Button onClick={handleSave} variant=\"contained\" color=\"primary\">\n                        {t('Save')}\n                    </Button>\n                    <Button\n                        variant=\"contained\"\n                        className={classes.btnDanger}\n                        onClick={revertChanges}>\n                        {t('Cancel')}\n                    </Button>\n                </FormControl>\n            );\n        }\n    };\n\n    closeConfirmDialog = () => {\n        this.setState({\n            isLocalStateWasUpdated: false,\n            confirmChanges: false,\n        });\n    };\n\n    createInput = ({\n        value,\n        label,\n        onChange,\n        type,\n        onClick,\n        note,\n        disabled = !this.state.localRule,\n        keywords,\n        key,\n        onSwitchChange,\n    }) => {\n        if ((value === undefined || value === null) && !label && !keywords) {\n            return null;\n        }\n        const { classes } = this.props;\n\n        return type !== 'checkbox' ?\n            <TextField\n                //label={label}\n                variant=\"outlined\"\n                size=\"small\"\n                disabled={disabled}\n                value={value}\n                helperText={note || ''}\n                onClick={onClick}\n                onChange={onChange}\n                key={key}\n                className={clsx('outlined-basic', classes.textField)}\n            />\n            :\n            <FormControl classes={{ root: classes.switchControl }}>\n                <Switch\n                    key={key}\n                    onClick={onSwitchChange}\n                    color={'primary'}\n                    disabled={disabled}\n                    checked={!!value}\n                />\n            </FormControl>\n        ;\n    };\n\n    createOptionsData = (state = this.state) => {\n        const {\n            localRule: { args, ack, editable, _break },\n        } = state;\n        const { t } = I18n;\n\n        const createInput = this.createInput;\n        const handlers = this.handlers;\n\n        const isKeyWordsDisabled = () => {\n            if (editable === undefined) {\n                return false;\n            } else if (editable === false) {\n                return true;\n            }\n            return false;\n        };\n\n        return [\n            {\n                title: t('Keywords'),\n                item: createInput({\n                    value: this.state.localRule?.words || '',\n                    onChange: handlers.keywordsText,\n                    keywords: true,\n                    disabled: isKeyWordsDisabled(),\n                    key: 'keywords',\n                }),\n                id: 1,\n            },\n            {\n                title: t('Interrupt processing'), //`${t('Break')}:`,\n                item: createInput({\n                    type: 'checkbox',\n                    value: _break,\n                    onSwitchChange: handlers.breakOnSwitch,\n                    key: 'break',\n                }),\n                id: 2,\n            },\n            {\n                title: args && args[0]?.name, //`${t('Argument')}:`,\n                item: createInput({\n                    value: args && this.state.localRule.args[0]?.default,\n                    label: args && args[0]?.name,\n                    type: args && args[0]?.type,\n                    onClick: this.handleSetDialogClick.bind(this, args && args[0]),\n                    onSwitchChange: handlers.param1OnSwitch,\n                    key: 'Param1',\n                }),\n                id: 3,\n            },\n            {\n                title: args && args[1]?.name, //`${t('Argument')}:`,\n                item: createInput({\n                    value: args && this.state.localRule.args[1]?.default,\n                    label: args && args[1]?.name,\n                    type: args && args[1]?.type,\n                    onChange: handlers.param2Text,\n                    onSwitchChange: handlers.param2OnSwitch,\n                    key: 'Param2',\n                }),\n                id: 4,\n            },\n            {\n                title: t('Confirmation text'),\n                item: createInput({\n                    value: ack && ack.default,\n                    label: ack && ack.name,\n                    note: t(\n                        'You can use %s, that will be replaced with current value of state. %u will be replaced by unit'\n                    ),\n                    type: ack && ack.type,\n                    key: 'confirmationText',\n                    onChange: handlers.confirmText,\n                    onSwitchChange: handlers.confirmOnSwitch,\n                }),\n                id: 5,\n            },\n        ];\n    };\n\n    createInputHandlers = () => {\n        const _this = this;\n\n        return {\n            keywordsText(event) {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        words: event.target.value,\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            param2Text(event) {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        args: _this.state.localRule.args.map((arg, index) =>\n                            index > 0\n                                ? {\n                                      ...arg,\n                                      default: event.target.value,\n                                  }\n                                : arg\n                        ),\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            confirmText(event) {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        ack: {\n                            ..._this.state.localRule.ack,\n                            default: event.target.value,\n                        },\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            param1OnSwitch() {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        args: _this.state.localRule.args.map((arg, index) =>\n                            !index ? { ...arg, default: !arg.default ? true : !arg.default } : arg\n                        ),\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            param2OnSwitch() {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        args: _this.state.localRule.args.map((arg, index) =>\n                            index ? { ...arg, default: !arg.default ? true : !arg.default } : arg\n                        ),\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            confirmOnSwitch() {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        ack: {\n                            ..._this.state.localRule.ack,\n                            default: !_this.state.localRule.ack.default,\n                        },\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            async breakOnSwitch() {\n                await _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        _break: !_this.state.localRule._break,\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n        };\n    };\n\n    handlers = this.createInputHandlers();\n\n    handleSetDialogClick = arg => {\n        if (arg.type === 'id') {\n            this.setState({\n                showDialog: true,\n            });\n        }\n    };\n\n    handleDialogSelectIdSubmit = selected => {\n        this.setState({\n            localRule: {\n                ...this.state.localRule,\n                args: this.state.localRule.args.map((arg, index) =>\n                    !index\n                        ? {\n                              ...arg,\n                              default: selected,\n                          }\n                        : arg\n                ),\n            },\n            isLocalStateWasUpdated: true,\n        });\n    };\n\n    renderConfirmDialog() {\n        return this.state.confirmChanges ? (\n            <Dialog fullWidth open={this.state.confirmChanges} maxWidth={'md'}>\n                <DialogTitle>\n                    {I18n.t('Please confirm or cancel changes before leaving')}\n                </DialogTitle>\n                <DialogContent>\n                    <Typography>\n                        {I18n.t('You have changed rule') + ': '}{' '}\n                        <strong>{this.state.localRule.name}</strong>\n                    </Typography>\n                    <DialogActions>{this.createConfirmModalActions()}</DialogActions>\n                </DialogContent>\n            </Dialog>\n        ) : null;\n    }\n\n    renderSelectIdDialog() {\n        return this.state.showDialog ?\n            <DialogSelectID\n                imagePrefix={'../..'}\n                socket={this.props.socket}\n                title={'Select ID'}\n                onClose={id => {\n                    console.log(id);\n                    this.setState({ showDialog: false });\n                }}\n                onOk={this.handleDialogSelectIdSubmit}\n            />: null;\n    }\n\n    render() {\n        const {\n            localRule,\n            isLocalStateWasUpdated,\n        } = this.state;\n\n        const { classes, isLeftBarHidden, toggleLeftBar } = this.props;\n        const name = localRule ? localRule.name : '';\n\n        if (!this.props.selectedRule) {\n            return null;\n        }\n\n\n        return <div className={classes.root}>\n            <Box mt=\"30px\" className={clsx(classes.box, this.props.isMobile ? classes.boxMobile : classes.boxDesktop)} key={this.props.selectedRule ? this.props.selectedRule.id : 'emptyLeft'}>\n                {localRule ?\n                    <Paper className={classes.container} mx=\"auto\">\n                        <Typography\n                            variant=\"h4\"\n                            align=\"center\"\n                            className={!isLocalStateWasUpdated ? classes.mainTitle : ''}>\n                            {name}\n                        </Typography>\n\n                        {this.createSaveSettingsForm()}\n\n                        {this.createOptionsData().map(({title, item, id}) => {\n                            if (!item) {\n                                return null;\n                            }\n\n                            return <Box\n                                display=\"flex\"\n                                justifyContent=\"space-between\"\n                                mb=\"10px\"\n                                key={id}\n                                className={classes.row}>\n                                <Typography\n                                    variant=\"h6\"\n                                    component=\"h6\"\n                                    align=\"left\"\n                                    className={classes.title}>\n                                    {title ? title + ':' : ''}\n                                </Typography>\n                                {item}\n                            </Box>;\n                        })}\n                    </Paper>\n                    :\n                    null\n                }\n\n                {this.renderSelectIdDialog()}\n                {this.renderConfirmDialog()}\n            </Box>\n\n            <Box className={classes.toggleIcon} onClick={toggleLeftBar}>\n                {isLeftBarHidden || this.props.isMobile ? <MenuIcon /> : <ArrowBackIcon />}\n            </Box>\n        </div>;\n    }\n}\n\nexport default withStyles(styles)(RightBar);\n\nRightBar.propTypes = {\n    selectedRule: PropTypes.shape({\n        name: PropTypes.string,\n        id: PropTypes.string,\n        rule: PropTypes.string,\n        ack: PropTypes.shape({\n            default: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n            value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n        }),\n        arg: PropTypes.arrayOf(\n            PropTypes.shape({\n                name: PropTypes.string,\n                type: PropTypes.string,\n                default: PropTypes.oneOfType([PropTypes.string, PropTypes.number, PropTypes.bool]),\n            })\n        ),\n        words: PropTypes.string,\n    }).isRequired,\n    socket: PropTypes.object.isRequired,\n    updateConfig: PropTypes.func.isRequired,\n    revertChangesFromConfig: PropTypes.func.isRequired,\n    classes: PropTypes.object.isRequired,\n    selectRule: PropTypes.func.isRequired,\n    pendingSelectedRuleId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n    clearStateOnConfirmModalUnmount: PropTypes.func.isRequired,\n    unsavedRules: PropTypes.object.isRequired,\n    setUnsavedRule: PropTypes.func.isRequired,\n    removeUnsavedRule: PropTypes.func.isRequired,\n    toggleLeftBar: PropTypes.func.isRequired,\n    isLeftBarHidden: PropTypes.bool,\n    isMobile: PropTypes.bool.isRequired,\n};\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControl from '@material-ui/core/FormControl';\nimport { DialogActions, Button, Select, TextField, MenuItem, withStyles } from '@material-ui/core';\n\nimport I18n from '@iobroker/adapter-react/i18n';\n\nconst styles = theme => ({\n    select: {\n        width: '100%',\n        marginBottom: theme.spacing(2.5),\n    },\n    TextField: {\n        marginBottom: theme.spacing(1),\n    },\n});\n\nclass CreateRuleDialog extends Component {\n    defaultRule = {\n        rule: I18n.t('Select rule'),\n        name: I18n.t('New rule'),\n        id: '',\n    };\n\n    state = {\n        localRule: this.defaultRule,\n        isDisabled: true,\n    };\n\n    componentWillUnmount() {\n        this.cleanState();\n    }\n\n    setRuleOnMount = () => {\n        const { isEdit, selectedRule } = this.props;\n        if (isEdit) {\n            this.setState({\n                localRule: selectedRule,\n            });\n        }\n    };\n\n    cleanState = () => {\n        if (this.props.isEdit) {\n            this.props.finishEdit(this.state.localRule);\n        }\n        this.setState({\n            localRule: this.defaultRule,\n        });\n    };\n\n    getAvailableOptions = () => {\n        const { commands, currentRules, selectedRule, isEdit } = this.props;\n\n        const uniqueOptions = commands?.filter(\n            option => !(option.unique && currentRules.find(item => item?.rule === option.rule))\n        );\n\n        return selectedRule?.unique && isEdit ? uniqueOptions.concat(selectedRule) : uniqueOptions;\n    };\n\n    getUniqueName = ruleName => {\n        const existingNames = this.props.currentRules?.map(rule => rule?.name);\n\n        const matchingNames = existingNames.filter(\n            name => name.slice(0, name.length - 2) === ruleName\n        );\n        const isUnique = this.props.commands.find(\n            ({ rule, unique }) => rule === ruleName && unique\n        );\n\n        if (matchingNames.length) {\n            let name = matchingNames[matchingNames.length - 1];\n            let lastChar = name.slice(name.length - 1);\n\n            return name.slice(0, name.length - 1) + ++lastChar;\n        }\n\n        return isUnique ? ruleName : `${ruleName} 1`;\n    };\n\n    createForm = () => {\n        const { localRule } = this.state;\n        const { classes } = this.props;\n        const commands = this.getAvailableOptions();\n\n        const handleSelectChange = event =>\n            this.setState({\n                localRule: {\n                    ...localRule,\n                    rule: event.target.value,\n                    name: this.getUniqueName(event.target.value),\n                    isError: '',\n                },\n            });\n\n        const handleInputChange = event => {\n            const existingNames = this.props.currentRules?.map(rule => rule?.name);\n\n            this.setState({\n                localRule: {\n                    ...localRule,\n                    name: event.target.value,\n                    isError: existingNames.includes(event.target.value)\n                        ? `${I18n.t('Name already exist')}`\n                        : '',\n                },\n            });\n        };\n\n        return (\n            <FormGroup>\n                <FormControl fullWidth>\n                    <InputLabel shrink id=\"rule\">\n                        {I18n.t('Rule')}\n                    </InputLabel>\n                    <Select\n                        onChange={handleSelectChange}\n                        value={localRule.rule}\n                        labelId={'rule'}\n                        className={classes.select}>\n                        {commands?.map(option => (\n                            <MenuItem key={option.rule} value={option.rule}>\n                                {option.rule}\n                            </MenuItem>\n                        ))}\n                    </Select>\n                </FormControl>\n                <TextField\n                    fullWidth\n                    id=\"standard-basic\"\n                    label={this.state.localRule.isError || I18n.t('Name')}\n                    value={localRule.name}\n                    onChange={handleInputChange}\n                    error={!!this.state.localRule.isError}\n                    className={classes.TextField}/>\n            </FormGroup>\n        );\n    };\n\n    setDialogContent = () => {\n        const { handleClose, handleSubmitOnCreate, handleSubmitOnEdit, isEdit } = this.props;\n        const onSubmitHandler = !isEdit ? handleSubmitOnCreate : handleSubmitOnEdit;\n        return (\n            <DialogContent>\n                {this.createForm()}\n                <DialogActions>\n                    <Button\n                        onClick={onSubmitHandler.bind(\n                            this,\n                            this.state.localRule,\n                            this.state.localRule.isError\n                        )}\n                        disabled={!this.state.localRule.name || !this.state.localRule.rule || (this.state.localRule.name === this.defaultRule.name && this.state.localRule.rule === this.defaultRule.rule) ||\n                        (this.state.localRule.name === this.props.selectedRule?.name && this.state.localRule.rule === this.props.selectedRule?.rule)}>\n                        { I18n.t('Ok') }\n                    </Button>\n                    <Button onClick={handleClose}>{I18n.t('Cancel')}</Button>\n                </DialogActions>\n            </DialogContent>\n        );\n    };\n    render() {\n        return (\n            <Dialog\n                open={this.props.isOpen}\n                onClose={this.props.handleClose}\n                onExited={this.cleanState}\n                onEnter={this.setRuleOnMount}\n                fullWidth>\n                <DialogTitle>\n                    {I18n.t(!this.props.isEdit ? 'Create new rule' : 'Edit rule')}\n                </DialogTitle>\n                {this.setDialogContent()}\n            </Dialog>\n        );\n    }\n}\n\nexport default withStyles(styles)(CreateRuleDialog);\n\nCreateRuleDialog.propTypes = {\n    handleClose: PropTypes.func.isRequired,\n    handleSubmitOnCreate: PropTypes.func.isRequired,\n    handleSubmitOnEdit: PropTypes.func.isRequired,\n    isEdit: PropTypes.bool.isRequired,\n    commands: PropTypes.arrayOf(\n        PropTypes.shape({\n            rule: PropTypes.string.isRequired,\n            unique: PropTypes.bool.isRequired,\n        }).isRequired\n    ),\n    isOpen: PropTypes.bool.isRequired,\n    selectedRule: PropTypes.shape({\n        id: PropTypes.string.isRequired,\n        name: PropTypes.string.isRequired,\n        rule: PropTypes.string.isRequired,\n        unique: PropTypes.bool,\n    }),\n    currentRules: PropTypes.arrayOf(\n        PropTypes.shape({\n            id: PropTypes.string.isRequired,\n            name: PropTypes.string.isRequired,\n            rule: PropTypes.string.isRequired,\n            unique: PropTypes.bool,\n        })\n    ).isRequired,\n    finishEdit: PropTypes.func.isRequired,\n    classes: PropTypes.object.isRequired,\n};\n","import React, { PureComponent } from 'react';\nimport SplitterLayout from 'react-splitter-layout';\nimport { v4 as uuid } from 'uuid';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { withStyles } from '@material-ui/core/styles';\nimport withWidth from '@material-ui/core/withWidth';\nimport 'react-splitter-layout/lib/index.css';\n\nimport Drawer from '@material-ui/core/Drawer';\n\nimport I18n from '@iobroker/adapter-react/i18n';\n\nimport LeftBar from './LeftBar';\nimport RightBar from './RightBar';\nimport CreateRuleDialog from './CreateRuleDialog';\nimport isEqual from 'lodash.isequal';\n\nconst styles = theme => ({\n    layout: {\n        '& .layout-pane:first': {\n            overflow: 'hidden',\n        },\n    },\n    hidden: {\n        '& .layout-pane:first-child': {\n            width: '0 !important',\n        },\n        background: theme.palette.background.default,\n    },\n    opened: {\n        '& .layout-pane-primary': {\n            width: '',\n        },\n        overflow: 'hidden',\n        background: theme.palette.background.default,\n    },\n    noRulesText: {\n        fontSize: 24,\n        color: theme.palette.primary.light,\n        textAlign: 'center',\n        paddingTop: theme.spacing(2),\n    },\n});\n\nclass Layout extends PureComponent {\n    constructor(props) {\n        super(props);\n\n        this.menuSize = parseFloat(window.localStorage.getItem('App.menuSize')) || 350;\n        this.state = {\n            currentRules: [],\n            isOpen: false,\n            isEdit: false,\n            selectedRule: null,\n            unsavedRules: {},\n            ready: false,\n            isLeftBarOpen: window.localStorage.getItem('App.menuHidden') === 'true',\n        };\n        this.commands = this.getSelectedLanguageCommands();\n        this.isMobile = this.props.width === 'sm' || this.props.width === 'xs';\n    }\n\n    componentDidMount() {\n        this.getDataFromConfig()\n            .then(({ rules, ...settings }) => {\n                const rulesWithId = rules.map(rule =>\n                    !rule.id || !rule.name\n                        ? {\n                              ...rule,\n                              id: rule.id || uuid(),\n                              name: rule.name || window.commands[rule.template]?.name[I18n.getLanguage()] || window.commands[rule.template]?.name.en,\n                          }\n                        : rule\n                );\n\n                if (!isEqual(rules, rulesWithId)) {\n                    this.props.saveConfig({ rules: rulesWithId, ...settings });\n                    setTimeout(() => this.setState({currentRules: rulesWithId}), 50);\n                }\n            });\n\n        if (this.isMobile) {\n            this.setState({\n                isLeftBarOpen: true,\n            });\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.settings?.language !== this.state.lang && this.state.settings?.language) {\n            const lang = this.state.settings?.language;\n            I18n.setLanguage(lang);\n\n            this.commands = this.getSelectedLanguageCommands();\n        }\n\n        if (\n            prevState.selectedRule?.id !== this.state.selectedRule?.id &&\n            prevState.selectedRule?.id && this.state.selectedRule\n        ) {\n            localStorage.setItem('selectedRule', this.state.selectedRule.id);\n        }\n    }\n\n    getSelectedLanguageCommands = () => {\n        const lang = this.state?.settings?.language || I18n.getLanguage();\n\n        return [\n            { rule: I18n.t('Select rule'), unique: false },\n            ...Object.entries(window.commands).map(item => {\n                const [key, command] = item;\n                const { name, ...rest } = command;\n                const obj = {\n                    ...rest,\n                    rule: command?.name[lang],\n                    template: key,\n                    unique: command.unique,\n                    words: command.words && command.words[lang],\n                    args: command.args?.map(arg => ({\n                        ...arg,\n                        name: arg.name[lang] || '',\n                        default: arg.default || (arg.type === 'checkbox' ? false : ''),\n                    })),\n                    ack: command.ack && {\n                        ...command.ack,\n                        name: command.ack.name[lang],\n                        default: !command.ack?.default\n                            ? command.ack?.type === 'checkbox'\n                                ? false\n                                : ''\n                            : command.ack.default[lang],\n                    },\n                };\n\n                return obj;\n            }),\n        ];\n    };\n\n    commands = this.getSelectedLanguageCommands();\n\n    moveRule = (dragIndex, hoverIndex) => {\n        const { currentRules } = this.state;\n        const sourceRule = currentRules.find((_, index) => index === hoverIndex);\n        const sortRules = currentRules.filter((_, index) => index !== hoverIndex);\n        sortRules.splice(dragIndex, 0, sourceRule);\n        this.setState({ currentRules: sortRules });\n    };\n\n    handleOpen = () => {\n        this.setState({\n            isOpen: true,\n        });\n    };\n    handleClose = () => {\n        this.setState({ isOpen: false });\n    };\n\n    handleSubmitOnCreate = (selectedRule, isError) => {\n        if (isError) {\n            return;\n        }\n\n        const id = uuid();\n        const shortDataRule = {\n            ...selectedRule,\n            id,\n            _break: true,\n        };\n\n        const rule = {\n            ...this.commands.find(command => command.rule === shortDataRule.rule),\n            ...shortDataRule,\n        };\n        const isUnsavedChanges = Object.values(this.state.unsavedRules).length;\n\n        this.setState(\n            {\n                currentRules: [...this.state.currentRules, rule],\n                unsavedRules: {\n                    ...this.state.unsavedRules,\n                    [id]: {\n                        id,\n                        wasChangedGlobally: true,\n                    },\n                },\n                selectedRule: !isUnsavedChanges ? rule : this.state.selectedRule,\n            },\n            () => {\n                if (isUnsavedChanges) {\n                    this.selectRule(rule.id);\n                }\n            }\n        );\n\n        this.handleClose();\n    };\n\n    handleSubmitOnEdit = (selectedRule, isError) => {\n        if (isError) {\n            return;\n        }\n\n        this.setState({\n            unsavedRules: {\n                ...this.state.unsavedRules,\n                [selectedRule.id]: {\n                    id: selectedRule.id,\n                    wasChangedGlobally: true,\n                },\n            },\n            currentRules: this.updateCurrentRules(selectedRule),\n        });\n        this.handleClose();\n    };\n\n    selectRule = id => {\n        const { selectedRule, currentRules } = this.state;\n\n        if (selectedRule.id === id) {\n            // ignore\n            if (this.isMobile) {\n                this.setState({isLeftBarOpen: false});\n            }\n        } else if (this.state.unsavedRules[selectedRule.id]) {\n            this.setState({\n                pendingSelectedRuleId: id,\n            });\n        } else {\n            const rule = currentRules.find(item => item.id === id);\n\n            this.setState({\n                selectedRule: rule,\n                isLeftBarOpen: this.isMobile ? false : this.state.isLeftBarOpen\n            });\n        }\n    };\n\n    updateCurrentRules = selectedRule => {\n        return this.state.currentRules.map(item =>\n            item.id === selectedRule.id ? selectedRule : item\n        );\n    };\n\n    handleEdit = () => {\n        this.setState({\n            isEdit: true,\n        });\n        this.handleOpen();\n    };\n\n    finishEdit = editableRule => {\n        let updatedRule;\n\n        const { rule, id, name, _break, template } = editableRule;\n        const initialSelectedRule = this.state.selectedRule;\n\n        if (initialSelectedRule.rule !== rule) {\n            const updatedRuleOptions = this.commands.find(command => command.rule === rule);\n            updatedRule = {\n                ...updatedRuleOptions,\n                name,\n                rule,\n                id,\n                _break,\n                template,\n            };\n        } else {\n            updatedRule = editableRule;\n        }\n\n        this.setState({\n            isEdit: false,\n            selectedRule: updatedRule,\n        });\n    };\n\n    removeRule = id => {\n        const deleteRuleFromConfig = async () => {\n            const config = await this.props.readConfig();\n            const { rules, ...settings } = config;\n            const newConfig = { rules: rules.filter(rule => rule.id !== id), ...settings };\n            this.props.saveConfig(newConfig);\n        };\n        const updatedRules = this.state.currentRules.filter(rule => rule.id !== id);\n        this.setState(\n            {\n                currentRules: updatedRules,\n                selectedRule: updatedRules.length ? updatedRules[updatedRules.length - 1] : null,\n            },\n            deleteRuleFromConfig\n        );\n    };\n\n    updateConfig = async currentSelectedRule => {\n        const { [currentSelectedRule.id]: removedId, ...ids } = this.state.unsavedRules;\n        const config = await this.props.readConfig();\n        const { rules, ...settings } = config;\n\n        const matchingRule = rules.find(rule => rule.id === currentSelectedRule.id);\n        const updatedCurrentRules = this.updateCurrentRules(currentSelectedRule)\n\n        let updatedRules;\n        if (matchingRule) {\n            updatedRules = rules.map(rule =>\n                rule.id === currentSelectedRule.id\n                    ? this.getRuleShortData(currentSelectedRule)\n                    : rule\n            );\n        } else {\n            updatedRules = [...rules, this.getRuleShortData(currentSelectedRule)];\n        }\n\n        const newConfig = { rules: updatedRules, ...settings };\n        await this.props.saveConfig(newConfig);\n\n        this.setState({\n            selectedRule: currentSelectedRule || this.state.selectedRule || null,\n            currentRules: updatedCurrentRules,\n            unsavedRules: ids,\n        });\n    };\n\n    getDataFromConfig = () => {\n        return this.props.readConfig()\n            .then(config => {\n                const { rules, ...settings } = config;\n                const lang = I18n.getLanguage();\n\n                const currentRules = rules.map(rule => {\n                    const obj = window.commands[rule.template];\n\n                    return {\n                        ...obj,\n                        rule: obj?.name[lang],\n                        ack: {\n                            ...obj.ack,\n                            default: rule.ack || (obj.ack?.type === 'checkbox' ? false : ''),\n                            name: obj.ack?.name[lang],\n                        },\n                        args: obj.args?.map((arg, index) => ({\n                            ...arg,\n                            default: rule.args[index] || (arg?.type === 'checkbox' ? false : ''),\n                            name: arg?.name[lang] || '',\n                        })),\n                        name: rule.name || obj?.name[lang],\n                        words: rule.words,\n                        _break: rule._break,\n                        id: rule.id || uuid(),\n                        template: rule.template,\n                    };\n                });\n\n                this.setState({\n                    currentRules,\n                    ready: true,\n                    selectedRule:\n                        currentRules.find(rule =>\n                            rule.id === localStorage.getItem('selectedRule')) ||\n                        currentRules[currentRules.length - 1] ||\n                        null,\n                    settings,\n                });\n\n                return config;\n            });\n    };\n\n    revertChangesFromConfig = async selectedRule => {\n        const { currentRules } = this.state;\n        const { [selectedRule.id]: removedId, ...ids } = this.state.unsavedRules;\n        const config = await this.props.readConfig();\n        const { rules, ...settings } = config;\n\n        const matchingRule = rules.find(rule => rule.id === selectedRule.id);\n        const isRuleWasUpdatedGlobally = this.state.unsavedRules[selectedRule.id]\n            ?.wasChangedGlobally;\n\n        let updatedRules;\n        if (matchingRule && isRuleWasUpdatedGlobally) {\n            updatedRules = currentRules.map(rule =>\n                rule.id === matchingRule.id\n                    ? {\n                          ...rule,\n                          ack: {\n                              ...rule.ack,\n                              default: matchingRule.ack || '',\n                          },\n                          args: rule.args?.map(arg => ({\n                              ...arg,\n                              default: matchingRule.arg || '',\n                          })),\n                          rule: window.commands[matchingRule.template].name[I18n.getLanguage()],\n                          words: matchingRule.words || '',\n                          name: matchingRule.name || '',\n                          _break: matchingRule._break || true,\n                      }\n                    : rule\n            );\n        } else if (!matchingRule) {\n            updatedRules = currentRules.filter(rule => rule.id !== selectedRule.id);\n        }\n\n        await this.setState({\n            currentRules: updatedRules || currentRules,\n            selectedRule:\n                (isRuleWasUpdatedGlobally\n                    ? updatedRules.find(rule => rule.id === selectedRule.id)\n                    : this.state.selectedRule) || null,\n            settings,\n            unsavedRules: ids,\n        });\n\n        if (this.state.currentRules.length !== currentRules.length) {\n            this.setState({\n                selectedRule: this.state.currentRules[this.state.currentRules.length - 1] || null,\n            });\n        }\n    };\n\n    saveSettings = async (localeSettings, closeModal) => {\n        const config = await this.props.readConfig();\n        const { rules } = config;\n        this.setState({\n            settings: localeSettings,\n        });\n        const newConfig = { rules, ...localeSettings };\n        await this.props.saveConfig(newConfig);\n        closeModal();\n    };\n\n    setUnsavedRule = id => {\n        this.setState({\n            unsavedRules: {\n                ...this.state.unsavedRules,\n                [id]: {\n                    id,\n                    wasChangedGlobally: false,\n                },\n            },\n        });\n    };\n\n    removeUnsavedRule = id => {\n        const { [id]: removedId, ...ids } = this.state.unsavedRules;\n        this.setState({\n            unsavedRules: ids,\n        });\n    };\n\n    getRuleShortData = ({ _break, template, words, ack, args, name, id }) => ({\n        words: words || '',\n        ack: ack?.default || '',\n        args: args?.map(arg => arg.default) || [],\n        _break,\n        template,\n        name,\n        id,\n    });\n\n    clearStateOnConfirmModalUnmount = id => {\n        const { [id]: removedId, ...ids } = this.state.unsavedRules;\n\n        this.setState({\n            pendingSelectedRuleId: false,\n            unsavedRules: ids,\n        });\n    };\n\n    toggleLeftBar = () => {\n        window.localStorage.setItem('App.menuHidden', !this.state.isLeftBarOpen);\n        this.setState({\n            isLeftBarOpen: !this.state.isLeftBarOpen,\n        });\n    };\n\n    closeDrawer = () => {\n        this.setState({\n            isLeftBarOpen: false,\n        });\n    };\n\n    renderModalDialog() {\n        return this.state.isOpen ?\n            <CreateRuleDialog\n                key=\"modal\"\n                commands={this.commands}\n                isEdit={this.state.isEdit}\n                handleSubmitOnCreate={this.handleSubmitOnCreate}\n                handleSubmitOnEdit={this.handleSubmitOnEdit}\n                handleClose={this.handleClose}\n                isOpen={this.state.isOpen}\n                currentRules={this.state.currentRules}\n                selectedRule={this.state.selectedRule}\n                finishEdit={this.finishEdit}\n            />\n         : null;\n    }\n\n    render() {\n        console.log(this.state);\n        const { classes } = this.props;\n        const { currentRules, selectedRule, isLeftBarOpen } = this.state;\n\n        if (!this.state.ready) {\n            return null;\n        }\n\n        if (this.isMobile) {\n            return <React.Fragment>\n                <Drawer\n                    anchor=\"left\"\n                    open={this.state.isLeftBarOpen}\n                    onClose={this.closeDrawer}>\n                    <LeftBar\n                        handleOpen={this.handleOpen}\n                        rules={currentRules}\n                        moveRule={this.moveRule}\n                        handleEdit={this.handleEdit}\n                        selectRule={this.selectRule}\n                        selectedRule={selectedRule}\n                        removeRule={this.removeRule}\n                        settings={this.state.settings}\n                        socket={this.props.socket}\n                        saveSettings={this.saveSettings}\n                        theme={this.props.theme}\n                        toggleLeftBar={this.toggleLeftBar}\n                        unsavedRules={this.state.unsavedRules}\n                        isMobile={this.isMobile}\n                        closeDrawer={this.closeDrawer}\n                    />\n                </Drawer>\n                {this.state.settings && selectedRule ?\n                    <RightBar\n                        key={selectedRule.id}\n                        selectedRule={selectedRule}\n                        socket={this.props.socket}\n                        updateConfig={this.updateConfig}\n                        revertChangesFromConfig={this.revertChangesFromConfig}\n                        pendingSelectedRuleId={this.state.pendingSelectedRuleId}\n                        unsavedRules={this.state.unsavedRules}\n                        selectRule={this.selectRule}\n                        clearStateOnConfirmModalUnmount={this.clearStateOnConfirmModalUnmount}\n                        lang={this.state.settings.language}\n                        setUnsavedRule={this.setUnsavedRule}\n                        removeUnsavedRule={this.removeUnsavedRule}\n                        toggleLeftBar={this.toggleLeftBar}\n                        isLeftBarOpen={this.state.isLeftBarOpen}\n                        isMobile={this.isMobile}\n                    />\n                    :\n                    <div className={classes.noRulesText}>{I18n.t('Create a new rule with a \"+\" on the left')}</div>}\n\n                {this.renderModalDialog()}\n            </React.Fragment>;\n        } else {\n            return <React.Fragment>\n                <SplitterLayout\n                    key=\"splitterLayout\"\n                    customClassName={clsx(\n                        isLeftBarOpen ? classes.hidden : classes.opened,\n                        classes.layout\n                    )}\n                    primaryMinSize={350}\n                    primaryIndex={1}\n                    secondaryMinSize={350}\n                    onSecondaryPaneSizeChange={size => (this.menuSize = parseFloat(size))}\n                    onDragEnd={() => window.localStorage.setItem('App.menuSize', this.menuSize.toString())}\n                    secondaryInitialSize={this.menuSize}>\n                    <LeftBar\n                        handleOpen={this.handleOpen}\n                        rules={currentRules}\n                        moveRule={this.moveRule}\n                        handleEdit={this.handleEdit}\n                        selectRule={this.selectRule}\n                        selectedRule={selectedRule}\n                        removeRule={this.removeRule}\n                        instance={this.props.instance}\n                        settings={this.state.settings}\n                        socket={this.props.socket}\n                        saveSettings={this.saveSettings}\n                        theme={this.props.theme}\n                        unsavedRules={this.state.unsavedRules}\n                        isMobile={this.isMobile}\n                    />\n                    {this.state.settings && selectedRule ?\n                        <RightBar\n                            selectedRule={selectedRule}\n                            socket={this.props.socket}\n                            updateCurrentRules={this.updateCurrentRules}\n                            updateConfig={this.updateConfig}\n                            revertChangesFromConfig={this.revertChangesFromConfig}\n                            pendingSelectedRuleId={this.state.pendingSelectedRuleId}\n                            unsavedRules={this.state.unsavedRules}\n                            selectRule={this.selectRule}\n                            clearStateOnConfirmModalUnmount={this.clearStateOnConfirmModalUnmount}\n                            lang={this.state.settings.language}\n                            setUnsavedRule={this.setUnsavedRule}\n                            removeUnsavedRule={this.removeUnsavedRule}\n                            toggleLeftBar={this.toggleLeftBar}\n                            isLeftBarOpen={this.state.isLeftBarOpen}\n                            isMobile={this.isMobile}\n                        />\n                        :\n                        <div className={classes.noRulesText}>{I18n.t('Create a new rule with a \"+\" on the left')}</div>}\n                </SplitterLayout>\n                {this.renderModalDialog()}\n            </React.Fragment>;\n        }\n    }\n}\n\nLayout.propTypes = {\n    socket: PropTypes.object.isRequired,\n    theme: PropTypes.object.isRequired,\n    instance: PropTypes.number.isRequired,\n    readConfig: PropTypes.func.isRequired,\n    saveConfig: PropTypes.func.isRequired,\n};\n\nexport default withStyles(styles)(withWidth()(Layout));\n","import React from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport { MuiThemeProvider } from '@material-ui/core/styles';\n\nimport Loader from '@iobroker/adapter-react/Components/Loader';\nimport I18n from '@iobroker/adapter-react/i18n';\nimport GenericApp from '@iobroker/adapter-react/GenericApp';\nimport Layout from './components/Layout';\nimport isEqual from 'lodash.isequal';\n\n// Icons\n\nconst styles = theme => ({\n    root: {},\n    logo: {\n        width: 32,\n        height: 32,\n        padding: theme.spacing(1),\n        display: 'inline-block',\n    },\n});\n\nclass App extends GenericApp {\n    constructor(props) {\n        const extendedProps = {...props};\n        extendedProps.translations = {\n            'en': require('./i18n/en'),\n            'de': require('./i18n/de'),\n            'ru': require('./i18n/ru'),\n            'pt': require('./i18n/pt'),\n            'nl': require('./i18n/nl'),\n            'fr': require('./i18n/fr'),\n            'it': require('./i18n/it'),\n            'es': require('./i18n/es'),\n            'pl': require('./i18n/pl'),\n            'zh-cn': require('./i18n/zh-cn'),\n        };\n\n        super(props, extendedProps);\n    }\n\n    onConnectionReady() {\n        const newState = {};\n\n        this.socket\n            .getSystemConfig()\n            .then(systemConfig => {\n                newState.systemConfig = systemConfig;\n                return this.readConfig();\n            })\n            .then(config => {\n                console.log(config);\n                this.setState({ config, ready: true });\n                if (config.language !== I18n.getLanguage() && config.language) {\n                    I18n.setLanguage(config.language);\n                }\n            })\n            .catch(e => this.showError(e));\n    }\n\n    readConfig() {\n        return this.socket\n            .getObject('system.adapter.' + this.adapterName + '.' + this.instance)\n            .then(config => {\n                const native = config.native || {};\n                native.rules = native.rules || [];\n                native.sayitInstance = native.sayitInstance || '';\n                native.language = native.language || '';\n                native.processorId = native.processorId || '';\n                native.processorTimeout = native.processorTimeout || 1000;\n                return native;\n            });\n    }\n\n    saveConfig(config) {\n        return this.socket\n            .getObject('system.adapter.' + this.adapterName + '.' + this.instance)\n            .then(obj => {\n                if (!isEqual(obj.native, config)) {\n                    obj.native = config;\n                    return this.socket.setObject(\n                        'system.adapter.' + this.adapterName + '.' + this.instance,\n                        obj\n                    );\n                }\n            });\n    }\n\n    render() {\n        if (!this.state.config || !this.state.ready) {\n            return <MuiThemeProvider theme={this.state.theme}>\n                    <Loader theme={this.state.themeType} />\n                </MuiThemeProvider>;\n        }\n\n        return (\n            <MuiThemeProvider theme={this.state.theme}>\n                <div className=\"App\">\n                    <Layout\n                        theme={this.state.theme}\n                        socket={this.socket}\n                        instance={this.instance}\n                        readConfig={this.readConfig.bind(this)}\n                        saveConfig={this.saveConfig.bind(this)}\n                    />\n                    {this.renderError()}\n                </div>\n            </MuiThemeProvider>\n        );\n    }\n}\n\nexport default withStyles(styles)(App);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Sentry from '@sentry/browser';\nimport * as SentryIntegrations from '@sentry/integrations';\nimport { MuiThemeProvider } from '@material-ui/core/styles';\nimport * as serviceWorker from './serviceWorker';\n\nimport './index.css';\nimport App from './App';\nimport { version } from '../package.json';\nimport theme from '@iobroker/adapter-react/Theme';\nimport Utils from '@iobroker/adapter-react/Components/Utils';\n\nwindow.adapterName = 'text2command';\nlet themeName = Utils.getThemeName();\n\nconsole.log('iobroker.' + window.adapterName + '@' + version + ' using theme \"' + themeName + '\"');\n\nfunction build() {\n    return ReactDOM.render(\n        <MuiThemeProvider theme={theme(themeName)}>\n            <App\n                onThemeChange={_theme => {\n                    themeName = _theme;\n                    build();\n                }}\n            />\n        </MuiThemeProvider>,\n        document.getElementById('root')\n    );\n}\n\n\n// if not local development\nif (window.location.host !== 'localhost:3000') {\n    Sentry.init({\n        dsn: 'https://9806f910556240219f831ecfe2ee3ad1@sentry.iobroker.net/87',\n        release: 'iobroker.' + window.adapterName + '@' + version,\n        integrations: [new SentryIntegrations.Dedupe()],\n    });\n}\n\nbuild();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}